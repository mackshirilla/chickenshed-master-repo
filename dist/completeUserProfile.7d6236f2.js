!function(e,t,r,i,s){var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o="function"==typeof n[i]&&n[i],l=o.cache||{},a="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function d(t,r){if(!l[t]){if(!e[t]){var s="function"==typeof n[i]&&n[i];if(!r&&s)return s(t,!0);if(o)return o(t,!0);if(a&&"string"==typeof t)return a(t);var p=Error("Cannot find module '"+t+"'");throw p.code="MODULE_NOT_FOUND",p}c.resolve=function(r){var i=e[t][1][r];return null!=i?i:r},c.cache={};var u=l[t]=new d.Module(t);e[t][0].call(u.exports,c,u,u.exports,this)}return l[t].exports;function c(e){var t=c.resolve(e);return!1===t?{}:d(t)}}d.isParcelRequire=!0,d.Module=function(e){this.id=e,this.bundle=d,this.exports={}},d.modules=e,d.cache=l,d.parent=o,d.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(d,"root",{get:function(){return n[i]}}),n[i]=d;for(var p=0;p<t.length;p++)d(t[p])}({"3R1AK":[function(e,t,r){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"completeUserProfile",()=>f);var s=e("@xatom/core"),n=e("@xatom/image"),o=e("@xatom/slider"),l=e("../../../../auth/authConfig"),a=e("../../../../utils/formUtils"),d=e("../../../../utils/validationUtils"),p=e("../../../../utils/recaptchaUtils"),u=e("../../../../api/apiConfig"),c=e("./sidebarIndicator");let f=async()=>{new s.WFComponent("#firstNameText").setText((0,l.userAuth).getUser().profile.first_name);let e=new s.WFComponent("#requestingAnimation");(0,c.initializeSidebarIndicators)();let t=new s.WFFormComponent("#formStepOne"),r=new s.WFFormComponent("#formStepTwo"),i=new s.WFFormComponent("#formStepThree"),f=new o.WFSlider(".multi-step_form_slider"),m=new s.WFComponent("#submitStepThree"),g=[{input:new s.WFComponent("#referralInput"),error:new s.WFComponent("#referralInputError"),validationFn:d.validateSelectField,message:"This field is required."}];g.forEach(({input:e,error:t,validationFn:r,message:i})=>{(0,a.setupValidation)(e,t,(0,a.createValidationFunction)(e,r,i),new s.WFComponent("#submitStepOneError"))});let h=new s.WFComponent("#isYMemberInput"),b=new s.WFComponent("#hiddenyMemberWrapper");h.on("change",()=>{b.setStyle({display:h.getElement().checked?"block":"none"})}),t.onFormSubmit(async(e,t)=>{t.preventDefault();let r=!0;if(g.forEach(({input:e,error:t,validationFn:i,message:s})=>{let n=(0,a.createValidationFunction)(e,i,s)();n?((0,a.toggleError)(t,n,!0),r=!1):(0,a.toggleError)(t,"",!1)}),!r){(0,a.toggleError)(new s.WFComponent("#submitStepOneError"),"Please correct all errors above.",!0);return}f.goNext()});let C=[{input:new s.WFComponent("#phoneNumberInput"),error:new s.WFComponent("#phoneNumberInputError"),validationFn:d.validatePhoneNumber,message:"This field is required."}];(0,a.setupFileUpload)(new s.WFComponent("#profilePictureInput"),new s.WFComponent("#profilePictureInputError"),new s.WFComponent("#profilePictureInputSuccess"),"/profiles/image-upload");let v=new s.WFComponent("#phoneNumberInput");v.on("input",()=>{let e=v.getElement(),t=e.selectionStart;e.value=function(e){let t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`}(e.value);let r=e.value.length,i=e.value.replace(/\D/g,"").length;e.setSelectionRange(t+(r-i),t+(r-i))}),C.forEach(({input:e,error:t,validationFn:r,message:i})=>{(0,a.setupValidation)(e,t,(0,a.createValidationFunction)(e,r,i),new s.WFComponent("#submitStepTwoError"))}),r.onFormSubmit(async(e,t)=>{t.preventDefault();let r=!0;if(C.forEach(({input:e,error:t,validationFn:i,message:s})=>{let n=(0,a.createValidationFunction)(e,i,s)();n?((0,a.toggleError)(t,n,!0),r=!1):(0,a.toggleError)(t,"",!1)}),!r){(0,a.toggleError)(new s.WFComponent("#submitStepTwoError"),"Please correct all errors above.",!0);return}f.goNext()});let S=new n.WFImage("#userProfilePic");f.onSlideChange(e=>{if(2===e){let e=(0,l.userAuth).getUser().profile,t=e.profile_pic&&e.profile_pic.url?e.profile_pic.url:"https://cdn.prod.website-files.com/667f080f36260b9afbdc46b2/667f080f36260b9afbdc46be_placeholder.svg";S.setImage(t),new(0,s.WFComponent)("#userFullName").setText(`${e.first_name} ${e.last_name}`),new(0,s.WFComponent)("#userEmail").setText((0,l.userAuth).getUser().email),new(0,s.WFComponent)("#userPhone").setText(r.getFormData().phone),new(0,s.WFComponent)("#userAddress").setText(r.getFormData().address_line_1),new(0,s.WFComponent)("#userAddressLine2").setText(r.getFormData().address_line_2),new(0,s.WFComponent)("#userCity").setText(r.getFormData().city),new(0,s.WFComponent)("#userState").setText(r.getFormData().state),new(0,s.WFComponent)("#userZip").setText(r.getFormData().zip)}}),i.onFormSubmit(async(i,o)=>{if(o.preventDefault(),m.setAttribute("disabled","true"),e.setStyle({display:"block"}),console.log("requesting animation displayed"),!await (0,p.handleRecaptcha)("complete_profile")){e.setStyle({display:"none"}),m.removeAttribute("disabled"),(0,a.toggleError)(new s.WFComponent("#submitStepThreeError"),"reCAPTCHA verification failed. Please try again.",!0);return}let l={...t.getFormData(),...r.getFormData()};try{let t=await (0,u.apiClient).post("profiles/complete-profile",{data:l}).fetch();if("success"===t.status&&t.profile){let r=t.profile;new(0,s.WFComponent)("#profileLinkTemplate").updateTextViaAttrVar({name:`${r.first_name} ${r.last_name}`,email:r.email,phone:r.phone});let i=r.profile_pic&&r.profile_pic.url?r.profile_pic.url:"https://cdn.prod.website-files.com/667f080f36260b9afbdc46b2/667f080f36260b9afbdc46be_placeholder.svg";new(0,n.WFImage)("#profileCardImg").setImage(i),e.setStyle({display:"none"}),m.removeAttribute("disabled"),f.goNext()}else throw Error(t.message||"Failed to complete profile.")}catch(t){console.error("Error completing profile:",t),(0,a.toggleError)(new s.WFComponent("#submitStepThreeError"),t.response?.data?.message||t.message||"An error occurred. Please try again.",!0),e.setStyle({display:"none"}),m.removeAttribute("disabled")}}),new s.WFComponent("#backStepTwo").on("click",()=>{f.goPrevious()}),new s.WFComponent("#backStepThree").on("click",()=>{e.setStyle({display:"none"}),f.goPrevious()}),new s.WFComponent("#submitStepFour").on("click",()=>{(0,c.markStepAsCompleted)(4),console.log("Step 4 is marked as complete"),f.goNext()}),new s.WFComponent("#backStepFour").on("click",()=>{(0,c.unmarkStepAsCompleted)(4),console.log("Step 4 is unmarked as complete"),f.goPrevious()}),f.onSlideChange((e,t)=>{if(e<4&&(0,c.setActiveStep)(e+1),-1!==t&&t<e)for(let r=t+1;r<=e;r++)r<=4&&(0,c.markStepAsCompleted)(r);if(-1!==t&&t>e)for(let r=t;r>e;r--)r<=4&&(0,c.unmarkStepAsCompleted)(r)}),(0,c.setActiveStep)(f.getActiveSlideIndex()+1)}},{"@xatom/core":"65YBq","@xatom/image":"bavwf","@xatom/slider":"ejxGx","../../../../auth/authConfig":"dHwPR","../../../../utils/formUtils":"gepHz","../../../../utils/validationUtils":"gu2z7","../../../../utils/recaptchaUtils":"Jsdel","../../../../api/apiConfig":"dUmIV","./sidebarIndicator":"jqy6Q","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],bavwf:[function(e,t,r){var i,s=e("d023971cccd819e3"),n={};Object.defineProperty(n,"WFImage",{get:()=>o,set:void 0,enumerable:!0,configurable:!0});class o extends s.WFComponent{constructor(e){super(e)}getImageConfig(){return this._config}getSrc(){return this.getAttribute("src")}getSizes(){return this.getAttribute("sizes")}getSrcSet(){return this.getAttribute("srcset")}getLoading(){return this.getAttribute("loading")}onLoad(e){return this.on("load",e),()=>{this.off("load",e)}}onLoadError(e){return this.on("error",e),()=>{this.off("error",e)}}setImage(e){if("string"==typeof e)this.setAttribute("src",e),this.removeAttribute("srcset"),this.removeAttribute("sizes");else{if(this.setAttribute("src",e.src),"object"==typeof e&&e.srcSet&&e.srcSet.length&&e.sizes&&e.sizes.length){let t=e.srcSet.map(e=>`${e.url} ${e.size}`).join(", ");this.setAttribute("srcset",t)}else this.removeAttribute("srcset"),this.removeAttribute("sizes");e.loading&&this.setAttribute("loading",e.loading)}}}i=t.exports,Object.keys(n).forEach(function(e){"default"===e||"__esModule"===e||i.hasOwnProperty(e)||Object.defineProperty(i,e,{enumerable:!0,get:function(){return n[e]}})})},{d023971cccd819e3:"65YBq"}],ejxGx:[function(e,t,r){var i,s=e("1a87f3bc23b90fa3"),n=e("37b5fd8189a9f4c7"),o={};Object.defineProperty(o,"WFSlider",{get:()=>a,set:void 0,enumerable:!0,configurable:!0});let l=window.jQuery;class a extends s.WFComponent{_sliderConfig={};_slides=[];_defaultSwipeDisabled=!1;_index=0;_listeners=new Map;constructor(e){super(e),this.init()}init(){this._defaultSwipeDisabled="true"===this.getAttribute("data-disable-swipe"),this._sliderConfig=l(this.getElement()).data()[".wSlider"],this._slides=Array.from(this._sliderConfig.slides).map(e=>new s.WFComponent(e)),this._mask=new s.WFComponent(this._sliderConfig.mask[0]),this._nav=new s.WFComponent(this._sliderConfig.nav[0]),this._left=new s.WFComponent(this._sliderConfig.left[0]),this._right=new s.WFComponent(this._sliderConfig.right[0]),function(e,t){let r,i;if(document.styleSheets&&0!=document.getElementsByTagName("head").length){if(document.styleSheets.length>0){for(var s=0,n=document.styleSheets.length;s<n;s++)if(!document.styleSheets[s].disabled){var o=document.styleSheets[s].media;if("string"==(i=typeof o)?""!==o&&-1===o.indexOf("screen")||(r=document.styleSheets[s]):"object"==i&&(""!==o.mediaText&&-1===o.mediaText.indexOf("screen")||(r=document.styleSheets[s])),void 0!==r)break}}if(void 0===r){var l=document.createElement("style");for(l.type="text/css",document.getElementsByTagName("head")[0].appendChild(l),s=0;s<document.styleSheets.length;s++)document.styleSheets[s].disabled||(r=document.styleSheets[s]);i=typeof r.media}if("string"===i){for(s=0,n=r.rules.length;s<n;s++)if(r.rules[s].selectorText&&r.rules[s].selectorText.toLowerCase()==e.toLowerCase())return void(r.rules[s].style.cssText=t);r.addRule(e,t)}else if("object"===i){var a=r.cssRules?r.cssRules.length:0;for(s=0;s<a;s++)if(r.cssRules[s].selectorText&&r.cssRules[s].selectorText.toLowerCase()==e.toLowerCase())return void(r.cssRules[s].style.cssText=t);r.insertRule(e+"{"+t+"}",a)}}}(".xa-slider-disable","display:none !important;");let e=this;Object.defineProperty(e._sliderConfig,"index",{set:function(t){e._index=t,e._triggerOnChange()},get:function(){return e._index}}),this.refereshSlides()}reloadWFSlider(){window.Webflow.require("slider").destroy(),window.Webflow.require("slider").redraw(),window.Webflow.require("slider").ready()}refereshSlides(){this._mask.getChildAsComponents(".w-slide").forEach(e=>e.remove()),this._slides.reverse().forEach(e=>{this._mask.getElement().prepend(e.getElement())}),this._slides.reverse(),this.reloadWFSlider()}getActiveSlide(){return this._slides[this._index]}getAllSlides(){return[...this._slides]}getSlideByIndex(e){return this._slides[e]}getActiveSlideIndex(){return this._index}getPreviousSlideIndex(){return this._sliderConfig.previous}goNext(){this._sliderConfig.right.click()}goPrevious(){this._sliderConfig.left.click()}goToIndex(e){e>=0&&e<this._slides.length&&(console.log(e),l(this._sliderConfig.nav.children()[e]).click())}addSlide(e,t={}){let r=t.index,i=t.cssClass,n=(0,s.createComponent)("div");n.addCssClass("w-slide"),i&&n.addCssClass(i),n.appendChild(e);let o="number"!=typeof r?-1:r,l=this._slides;o>=0&&o<=l.length?l.splice(r,0,n):l.push(n),this._slides=[...l],this.refereshSlides()}removeSlide(e){let t=[...this._slides];e>=0&&e<t.length&&t.splice(e,1),this._slides=[...t],console.log(this._slides),this.refereshSlides()}getSlideNav(){return this._nav}setSlideNavigationState(e){e?(this._left.removeCssClass("xa-slider-disable"),this._right.removeCssClass("xa-slider-disable"),this._nav.removeCssClass("xa-slider-disable"),this.setAttribute("data-disable-swipe",this._defaultSwipeDisabled?"true":"false")):(this._left.addCssClass("xa-slider-disable"),this._right.addCssClass("xa-slider-disable"),this._nav.addCssClass("xa-slider-disable"),this.setAttribute("data-disable-swipe","true")),this.reloadWFSlider()}onSlideChange(e){let t=(0,n.v4)();return this._listeners.set(t,e),()=>{this._listeners.delete(t)}}_triggerOnChange(){Array.from(this._listeners.values()).forEach(e=>{e(this._index,this._sliderConfig.previous)})}getConfig(){return this._sliderConfig}}i=t.exports,Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||i.hasOwnProperty(e)||Object.defineProperty(i,e,{enumerable:!0,get:function(){return o[e]}})})},{"1a87f3bc23b90fa3":"65YBq","37b5fd8189a9f4c7":"faiuA"}],gepHz:[function(e,t,r){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"toggleError",()=>a),i.export(r,"setupValidation",()=>d),i.export(r,"createValidationFunction",()=>p),i.export(r,"createCheckboxValidationFunction",()=>u),i.export(r,"setupCheckboxValidation",()=>c),i.export(r,"validateSelectedSessions",()=>f),i.export(r,"setProfilePicUrl",()=>m),i.export(r,"setupFileUpload",()=>g),i.export(r,"formatPhoneNumber",()=>h);var s=e("@xatom/core"),n=e("@xatom/image"),o=e("../api/apiConfig"),l=e("../auth/authConfig");function a(e,t,r){e.updateTextViaAttrVar({text:r?t:""}),e.setStyle({display:r?"flex":"none"})}function d(e,t,r,i){let s=()=>{let e=r();a(t,e,!!e),i&&""===e&&a(i,"",!1)};e.on("input",s),e.on("blur",s),e.on("change",s)}function p(e,t,r){return()=>t(e.getElement().value)?"":r}function u(e,t){return()=>e.getElement().checked?"":t}function c(e,t,r){let i=u(e,r);d(e,t,i)}function f(e,t,r){let i=e.length>0&&e.some(e=>e.studentIds.length>0);return i?a(t,"",!1):a(t,r,!0),i}function m(e){let t=(0,l.userAuth).getUser();t&&t.profile&&(t.profile.profile_pic=t.profile.profile_pic||{url:""},t.profile.profile_pic.url=e,(0,l.userAuth).setUser(t),localStorage.setItem("auth_user",JSON.stringify(t)))}function g(e,t,r,i){let l=new n.WFImage("#profilePictureImage"),d=new s.WFComponent("#uploadAnimation"),p=new s.WFComponent(".drop-zone"),u=0;return new Promise(s=>{let n=n=>{if(!["image/jpeg","image/jpg"].includes(n.type)&&!/\.(jpg|jpeg)$/i.test(n.name)){a(t,"Only JPEG images are allowed.",!0),e.getElement().value="";return}if(n.size>2097152){a(t,"File size must be less than 2 MB.",!0),e.getElement().value="";return}d.setStyle({display:"flex"}),t.setStyle({display:"none"}),r.setStyle({display:"none"});let c=new FileReader;c.onload=e=>{let t=e.target?.result;l.setImage(t),p.setStyle({display:"none"})},c.readAsDataURL(n);let f=new FormData;f.append("profile_picture",n);let g=localStorage.getItem("current_student");if(g){let e=JSON.parse(g);f.append("student_profile_id",e.id.toString())}let h=(0,o.apiClient).post(i,{data:f});h.onData(i=>{if("success"===i.status){let e=i.url.profile_pic.url;m(e),l.setImage(e),localStorage.setItem("image_upload",e),r.setStyle({display:"flex"}),d.setStyle({display:"none"}),s(e)}else a(t,"Failed to upload profile picture.",!0),d.setStyle({display:"none"}),p.setStyle({display:"none"}),u=0,e.getElement().value=""}),h.onError(r=>{let i="An error occurred during image upload.";r.response&&r.response.data?i=r.response.data.message||i:r.message&&(i=r.message),a(t,i,!0),d.setStyle({display:"none"}),p.setStyle({display:"none"}),u=0,e.getElement().value=""}),h.fetch()};e.on("change",()=>{let t=e.getElement().files?.[0];t&&n(t)});let c=document.body;c.addEventListener("dragenter",e=>{e.preventDefault(),1==++u&&p.setStyle({display:"flex"})}),c.addEventListener("dragleave",()=>{--u<=0&&(p.setStyle({display:"none"}),u=0)}),c.addEventListener("dragover",e=>{e.preventDefault()}),c.addEventListener("drop",e=>{e.preventDefault();let t=e.dataTransfer?.files;t?.length&&n(t[0]),p.setStyle({display:"none"}),u=0})})}let h=e=>{let t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:t.length<=10?`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`}},{"@xatom/core":"65YBq","@xatom/image":"bavwf","../api/apiConfig":"dUmIV","../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],gu2z7:[function(e,t,r){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");function s(e){return void 0!==e&&""!==e.trim()}function n(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}i.defineInteropFlag(r),i.export(r,"validateNotEmpty",()=>s),i.export(r,"validateEmail",()=>n),i.export(r,"validateEmailOptional",()=>o),i.export(r,"validatePasswordRequirements",()=>l),i.export(r,"validateCheckbox",()=>a),i.export(r,"validatePasswordsMatch",()=>d),i.export(r,"validateSelectField",()=>p),i.export(r,"validatePhoneNumber",()=>u),i.export(r,"validatePhoneNumberOptional",()=>c);let o=e=>""===e.trim()||n(e);function l(e){let t=/[a-z]/.test(e),r=/[A-Z]/.test(e),i=/\d/.test(e),s=/[!@#$%^&*(),.?":{}|<>]/.test(e),n=e.length>=8;return t&&r&&i&&s&&n}function a(e){return e}function d(e,t){return e===t}function p(e){return void 0!==e&&"N/A"!==e}function u(e){return/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)}let c=e=>""===e.trim()||u(e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],Jsdel:[function(e,t,r){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"getRecaptchaToken",()=>n),i.export(r,"validateRecaptchaToken",()=>o),i.export(r,"handleRecaptcha",()=>l);var s=e("../api/apiConfig");async function n(e){return new Promise((t,r)=>{grecaptcha.ready(()=>{grecaptcha.execute("6Lekaa8pAAAAAN6qiq0LSP5Akckql4Blg6K5ToUq",{action:e}).then(e=>{t(e)},r)})})}async function o(e){try{return await (0,s.apiClient).post("/recaptcha/validate",{data:{"g-recaptcha-response":e}}).fetch()}catch(e){throw Error(`ReCAPTCHA validation failed: ${e}`)}}async function l(e){try{let t=await n(e),r=await o(t);return"success"===r.status}catch(e){return console.error("ReCAPTCHA handling failed:",e),e.response&&console.error("Error response:",e.response),!1}}},{"../api/apiConfig":"dUmIV","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],jqy6Q:[function(e,t,r){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"initializeSidebarIndicators",()=>o),i.export(r,"setActiveStep",()=>l),i.export(r,"unsetActiveStep",()=>a),i.export(r,"markStepAsCompleted",()=>d),i.export(r,"unmarkStepAsCompleted",()=>p);var s=e("@xatom/core"),n=e("../../../../auth/authConfig");let o=()=>{let e=new s.WFComponent("#firstNameText"),t=(0,n.userAuth).getUser();t&&t.profile&&t.profile.first_name?e.setText(t.profile.first_name):e.setText("Friend"),[{id:"sidebarStepOne",index:1},{id:"sidebarStepTwo",index:2},{id:"sidebarStepThree",index:3},{id:"sidebarStepFour",index:4}].forEach(e=>{let t=new s.WFComponent(`#${e.id}`),r=!1;t.on("click",()=>{r=!r})})},l=e=>{let t=u(e);new s.WFComponent(`#${t}`).addCssClass("is-active")},a=e=>{let t=u(e);new s.WFComponent(`#${t}`).removeCssClass("is-active")},d=e=>{let t=u(e);new s.WFComponent(`#${t}`).getElement().click()},p=e=>{let t=u(e);new s.WFComponent(`#${t}`).getElement().click()},u=e=>({1:"sidebarStepOne",2:"sidebarStepTwo",3:"sidebarStepThree",4:"sidebarStepFour"})[e]||`sidebarStep${e}`},{"@xatom/core":"65YBq","../../../../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}]},[],0,"parcelRequired346");
//# sourceMappingURL=completeUserProfile.7d6236f2.js.map
