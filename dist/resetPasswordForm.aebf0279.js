!function(e,t,r,n,o){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s="function"==typeof a[n]&&a[n],i=s.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function c(t,r){if(!i[t]){if(!e[t]){var o="function"==typeof a[n]&&a[n];if(!r&&o)return o(t,!0);if(s)return s(t,!0);if(l&&"string"==typeof t)return l(t);var u=Error("Cannot find module '"+t+"'");throw u.code="MODULE_NOT_FOUND",u}d.resolve=function(r){var n=e[t][1][r];return null!=n?n:r},d.cache={};var p=i[t]=new c.Module(t);e[t][0].call(p.exports,d,p,p.exports,this)}return i[t].exports;function d(e){var t=d.resolve(e);return!1===t?{}:c(t)}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=e,c.cache=i,c.parent=s,c.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(c,"root",{get:function(){return a[n]}}),a[n]=c;for(var u=0;u<t.length;u++)c(t[u])}({MOQ8k:[function(e,t,r){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"passwordResetForm",()=>c);var o=e("@xatom/core"),a=e("../../../utils/formUtils"),s=e("../../../utils/validationUtils"),i=e("../../../api/apiConfig"),l=e("../../../utils/recaptchaUtils");let c=()=>{let e=new o.WFFormComponent("#passwordResetForm"),t=[{input:new o.WFComponent("#passwordInput"),error:new o.WFComponent("#passwordInputError"),validationFn:s.validateNotEmpty,message:"Please enter a new password."},{input:new o.WFComponent("#confirmPasswordInput"),error:new o.WFComponent("#confirmPasswordInputError"),validationFn:t=>(0,s.validatePasswordsMatch)(e.getFormData().password,t),message:"Passwords do not match."}],r=new o.WFComponent("#requestError"),n=new o.WFComponent("#requestingAnimation");t.forEach(({input:e,error:t,validationFn:n,message:o})=>{(0,a.setupValidation)(e,t,(0,a.createValidationFunction)(e,n,o),r)});let c=[new o.WFComponent("#lengthCheck"),new o.WFComponent("#lowercaseCheck"),new o.WFComponent("#uppercaseCheck"),new o.WFComponent("#digitCheck"),new o.WFComponent("#charCheck")],u=e=>{let t=[e.length>=8,/[a-z]/.test(e),/[A-Z]/.test(e),/\d/.test(e),/[!@#$%^&*(),.?":{}|<>]/.test(e)];c.forEach((e,r)=>{t[r]?e.addCssClass("passed"):e.removeCssClass("passed")})};t.find(({input:e})=>e===t[0].input)?.input.on("input",()=>{u(t[0].input.getElement().value)}),e.onFormSubmit(async(s,c)=>{c.preventDefault();let u=!0;if(n.setStyle({display:"flex"}),(0,a.toggleError)(r,"",!1),t.forEach(({input:e,error:t,validationFn:r,message:n})=>{let o=(0,a.createValidationFunction)(e,r,n)();o?((0,a.toggleError)(t,o,!0),u=!1):(0,a.toggleError)(t,"",!1)}),!u){console.log("Validation failed:",s),(0,a.toggleError)(r,"Please correct all errors above.",!0),n.setStyle({display:"none"});return}if(!await (0,l.handleRecaptcha)("create_account")){(0,a.toggleError)(r,"reCAPTCHA verification failed.",!0),n.setStyle({display:"none"});return}console.log("Form data:",s=e.getFormData());try{let t=await (0,i.apiClient).post("/auth/reset-password",{data:s}).fetch();if("success"===t.status){e.showSuccessState();let t=new o.WFComponent("#onSuccessTrigger");t.getElement()?.click()}else throw Error(t.message)}catch(e){console.error("Account creation failed:",e),(0,a.toggleError)(r,e.response.data.message||"Failed to create account.",!0),n.setStyle({display:"none"});return}finally{n.setStyle({display:"none"})}})}},{"@xatom/core":"65YBq","../../../utils/formUtils":"gepHz","../../../utils/validationUtils":"gu2z7","../../../api/apiConfig":"dUmIV","../../../utils/recaptchaUtils":"Jsdel","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],gepHz:[function(e,t,r){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"toggleError",()=>l),n.export(r,"setupValidation",()=>c),n.export(r,"createValidationFunction",()=>u),n.export(r,"createCheckboxValidationFunction",()=>p),n.export(r,"setupCheckboxValidation",()=>d),n.export(r,"validateSelectedSessions",()=>f),n.export(r,"setProfilePicUrl",()=>g),n.export(r,"setupFileUpload",()=>m),n.export(r,"formatPhoneNumber",()=>h);var o=e("@xatom/core"),a=e("@xatom/image"),s=e("../api/apiConfig"),i=e("../auth/authConfig");function l(e,t,r){e.updateTextViaAttrVar({text:r?t:""}),e.setStyle({display:r?"flex":"none"})}function c(e,t,r,n){let o=()=>{let e=r();l(t,e,!!e),n&&""===e&&l(n,"",!1)};e.on("input",o),e.on("blur",o),e.on("change",o)}function u(e,t,r){return()=>t(e.getElement().value)?"":r}function p(e,t){return()=>e.getElement().checked?"":t}function d(e,t,r){let n=p(e,r);c(e,t,n)}function f(e,t,r){let n=e.length>0&&e.some(e=>e.studentIds.length>0);return n?l(t,"",!1):l(t,r,!0),n}function g(e){let t=(0,i.userAuth).getUser();t&&t.profile&&(t.profile.profile_pic=t.profile.profile_pic||{url:""},t.profile.profile_pic.url=e,(0,i.userAuth).setUser(t),localStorage.setItem("auth_user",JSON.stringify(t)))}function m(e,t,r,n){let i=new a.WFImage("#profilePictureImage"),c=new o.WFComponent("#uploadAnimation"),u=new o.WFComponent(".drop-zone"),p=0;return new Promise(o=>{let a=a=>{if(!["image/jpeg","image/jpg"].includes(a.type)&&!/\.(jpg|jpeg)$/i.test(a.name)){l(t,"Only JPEG images are allowed.",!0),e.getElement().value="";return}if(a.size>2097152){l(t,"File size must be less than 2 MB.",!0),e.getElement().value="";return}c.setStyle({display:"flex"}),t.setStyle({display:"none"}),r.setStyle({display:"none"});let d=new FileReader;d.onload=e=>{let t=e.target?.result;i.setImage(t),u.setStyle({display:"none"})},d.readAsDataURL(a);let f=new FormData;f.append("profile_picture",a);let m=localStorage.getItem("current_student");if(m){let e=JSON.parse(m);f.append("student_profile_id",e.id.toString())}let h=(0,s.apiClient).post(n,{data:f});h.onData(n=>{if("success"===n.status){let e=n.url.profile_pic.url;g(e),i.setImage(e),localStorage.setItem("image_upload",e),r.setStyle({display:"flex"}),c.setStyle({display:"none"}),o(e)}else l(t,"Failed to upload profile picture.",!0),c.setStyle({display:"none"}),u.setStyle({display:"none"}),p=0,e.getElement().value=""}),h.onError(r=>{let n="An error occurred during image upload.";r.response&&r.response.data?n=r.response.data.message||n:r.message&&(n=r.message),l(t,n,!0),c.setStyle({display:"none"}),u.setStyle({display:"none"}),p=0,e.getElement().value=""}),h.fetch()};e.on("change",()=>{let t=e.getElement().files?.[0];t&&a(t)});let d=document.body;d.addEventListener("dragenter",e=>{e.preventDefault(),1==++p&&u.setStyle({display:"flex"})}),d.addEventListener("dragleave",()=>{--p<=0&&(u.setStyle({display:"none"}),p=0)}),d.addEventListener("dragover",e=>{e.preventDefault()}),d.addEventListener("drop",e=>{e.preventDefault();let t=e.dataTransfer?.files;t?.length&&a(t[0]),u.setStyle({display:"none"}),p=0})})}let h=e=>{let t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:t.length<=10?`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`}},{"@xatom/core":"65YBq","@xatom/image":"bavwf","../api/apiConfig":"dUmIV","../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],bavwf:[function(e,t,r){var n,o=e("d023971cccd819e3"),a={};Object.defineProperty(a,"WFImage",{get:()=>s,set:void 0,enumerable:!0,configurable:!0});class s extends o.WFComponent{constructor(e){super(e)}getImageConfig(){return this._config}getSrc(){return this.getAttribute("src")}getSizes(){return this.getAttribute("sizes")}getSrcSet(){return this.getAttribute("srcset")}getLoading(){return this.getAttribute("loading")}onLoad(e){return this.on("load",e),()=>{this.off("load",e)}}onLoadError(e){return this.on("error",e),()=>{this.off("error",e)}}setImage(e){if("string"==typeof e)this.setAttribute("src",e),this.removeAttribute("srcset"),this.removeAttribute("sizes");else{if(this.setAttribute("src",e.src),"object"==typeof e&&e.srcSet&&e.srcSet.length&&e.sizes&&e.sizes.length){let t=e.srcSet.map(e=>`${e.url} ${e.size}`).join(", ");this.setAttribute("srcset",t)}else this.removeAttribute("srcset"),this.removeAttribute("sizes");e.loading&&this.setAttribute("loading",e.loading)}}}n=t.exports,Object.keys(a).forEach(function(e){"default"===e||"__esModule"===e||n.hasOwnProperty(e)||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{d023971cccd819e3:"65YBq"}],gu2z7:[function(e,t,r){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");function o(e){return void 0!==e&&""!==e.trim()}function a(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}n.defineInteropFlag(r),n.export(r,"validateNotEmpty",()=>o),n.export(r,"validateEmail",()=>a),n.export(r,"validateEmailOptional",()=>s),n.export(r,"validatePasswordRequirements",()=>i),n.export(r,"validateCheckbox",()=>l),n.export(r,"validatePasswordsMatch",()=>c),n.export(r,"validateSelectField",()=>u),n.export(r,"validatePhoneNumber",()=>p);let s=e=>""===e.trim()||a(e);function i(e){let t=/[a-z]/.test(e),r=/[A-Z]/.test(e),n=/\d/.test(e),o=/[!@#$%^&*(),.?":{}|<>]/.test(e),a=e.length>=8;return t&&r&&n&&o&&a}function l(e){return e}function c(e,t){return e===t}function u(e){return void 0!==e&&"N/A"!==e}function p(e){return/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],Jsdel:[function(e,t,r){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"getRecaptchaToken",()=>a),n.export(r,"validateRecaptchaToken",()=>s),n.export(r,"handleRecaptcha",()=>i);var o=e("../api/apiConfig");async function a(e){return new Promise((t,r)=>{grecaptcha.ready(()=>{grecaptcha.execute("6Lekaa8pAAAAAN6qiq0LSP5Akckql4Blg6K5ToUq",{action:e}).then(e=>{t(e)},r)})})}async function s(e){try{return await (0,o.apiClient).post("/recaptcha/validate",{data:{"g-recaptcha-response":e}}).fetch()}catch(e){throw Error(`ReCAPTCHA validation failed: ${e}`)}}async function i(e){try{let t=await a(e),r=await s(t);return"success"===r.status}catch(e){return console.error("ReCAPTCHA handling failed:",e),e.response&&console.error("Error response:",e.response),!1}}},{"../api/apiConfig":"dUmIV","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}]},[],0,"parcelRequired346");
//# sourceMappingURL=resetPasswordForm.aebf0279.js.map
