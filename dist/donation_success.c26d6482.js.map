{"mappings":"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","sources":["src/modules/success_page/donation_success.ts","node_modules/.pnpm/@xatom+image@1.0.0_@xatom+core@1.0.12/node_modules/@xatom/image/dist/index.js"],"sourcesContent":["// src/success_page/donation_success.ts\n\nimport { WFComponent } from \"@xatom/core\";\nimport { WFImage } from \"@xatom/image\";\nimport { apiClient } from \"../../api/apiConfig\";\n\ninterface SupportCampaign {\n  id: number;\n  Name: string;\n  Main_Image: string;\n  Success_Page_Message: string;\n}\n\ninterface DonationSubscription {\n  id: number;\n  created_at: number;\n  status: string;\n  name: string;\n  contact_id: number;\n  user_id: number;\n  amount: number;\n  subscription_type: string; // \"year\" or \"month\"\n  stripe_subscription_id: string;\n}\n\ninterface DonationData {\n  id: number;\n  uuid: string;\n  amount: number;\n  keep_anonymous: boolean;\n  in_name_of: string;\n  created_at: number;\n  campaign_name: string;\n  support_campaign_id: number;\n  support_campaign: SupportCampaign;\n  donation_subscription?: DonationSubscription;\n  customer_first_name?: string;\n}\n\nexport async function handleDonationSuccess() {\n  const params = new URLSearchParams(window.location.search);\n  const donationId = params.get(\"donation\");\n\n  if (!donationId) {\n    alert(\"Missing donation identifier in URL.\");\n    return;\n  }\n\n  try {\n    const req = apiClient.get<{ data: DonationData }>(\n      `/success_page/donation/${donationId}`\n    );\n    const data = await new Promise<DonationData>((resolve, reject) => {\n      req.onData((res) => resolve(res.data));\n      req.onError(reject);\n      req.fetch();\n    });\n\n    const trigger = document.querySelector<HTMLElement>(\".success_trigger\");\n    trigger?.click();\n\n    const card = new WFComponent(\"#donationCard\");\n    const image = new WFImage(\n      card.getChildAsComponent(\"#cardCampaignImage\").getElement()\n    );\n    const campaignName = card.getChildAsComponent(\"#cardCampaignName\");\n    const subtitle = card.getChildAsComponent(\"#cardCampaignSubtitle\");\n    const amount = card.getChildAsComponent(\"#cardDonationAmount\");\n    const subscriptionType = card.getChildAsComponent(\"#cardDonationType\");\n    const message = document.getElementById(\"successMessage\");\n    const anchor = card.getElement() as HTMLAnchorElement;\n\n    image.setImage(data.support_campaign.Main_Image);\n    (image.getElement() as HTMLImageElement).alt = `${data.campaign_name} - Campaign Image`;\n\n    campaignName.setText(data.campaign_name);\n    subtitle.setText(\n      data.keep_anonymous\n        ? \"Anonymous Donation\"\n        : `Thank you${data.customer_first_name ? \", \" + data.customer_first_name : \"\"}!`\n    );\n    amount.setText(`$${data.amount.toFixed(2)}`);\n\n    if (subscriptionType) {\n      const subType = data.donation_subscription?.subscription_type?.toLowerCase();\n      let label = \"One-Time\";\n      if (subType === \"year\") label = \"Annually\";\n      else if (subType === \"month\") label = \"Monthly\";\n      subscriptionType.setText(label);\n    }\n\n    if (message) {\n      message.innerHTML = data.support_campaign.Success_Page_Message;\n      message.style.display = \"block\";\n    }\n\n    // Always set the link (no auth_config check)\n    const url = new URL(anchor.getAttribute(\"href\") || \"#\", window.location.origin);\n    url.searchParams.set(\"donation\", data.uuid);\n    anchor.setAttribute(\"href\", url.toString());\n\n    card.getElement().style.display = \"block\";\n  } catch (err) {\n    console.error(\"Error loading donation success data:\", err);\n    alert(\"We couldnâ€™t load your donation confirmation. Please contact support.\");\n  }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", handleDonationSuccess);\n","var t=require(\"@xatom/core\");var e,r,s,i,o,n,u={};e=u,r=\"WFImage\",s=()=>c,Object.defineProperty(e,r,{get:s,set:i,enumerable:!0,configurable:!0});class c extends t.WFComponent{constructor(t){super(t)}getImageConfig(){return this._config}getSrc(){return this.getAttribute(\"src\")}getSizes(){return this.getAttribute(\"sizes\")}getSrcSet(){return this.getAttribute(\"srcset\")}getLoading(){return this.getAttribute(\"loading\")}onLoad(t){return this.on(\"load\",t),()=>{this.off(\"load\",t)}}onLoadError(t){return this.on(\"error\",t),()=>{this.off(\"error\",t)}}setImage(t){if(\"string\"==typeof t)this.setAttribute(\"src\",t),this.removeAttribute(\"srcset\"),this.removeAttribute(\"sizes\");else{if(this.setAttribute(\"src\",t.src),\"object\"==typeof t&&t.srcSet&&t.srcSet.length&&t.sizes&&t.sizes.length){const e=t.srcSet.map((t=>`${t.url} ${t.size}`)).join(\", \");this.setAttribute(\"srcset\",e)}else this.removeAttribute(\"srcset\"),this.removeAttribute(\"sizes\");t.loading&&this.setAttribute(\"loading\",t.loading)}}}o=module.exports,n=u,Object.keys(n).forEach((function(t){\"default\"===t||\"__esModule\"===t||o.hasOwnProperty(t)||Object.defineProperty(o,t,{enumerable:!0,get:function(){return n[t]}})}));"],"names":[],"version":3,"file":"donation_success.c26d6482.js.map","sourceRoot":"../"}