!function(e,t,n,o,i){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r="function"==typeof a[o]&&a[o],s=r.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function c(t,n){if(!s[t]){if(!e[t]){var i="function"==typeof a[o]&&a[o];if(!n&&i)return i(t,!0);if(r)return r(t,!0);if(l&&"string"==typeof t)return l(t);var p=Error("Cannot find module '"+t+"'");throw p.code="MODULE_NOT_FOUND",p}d.resolve=function(n){var o=e[t][1][n];return null!=o?o:n},d.cache={};var u=s[t]=new c.Module(t);e[t][0].call(u.exports,d,u,u.exports,this)}return s[t].exports;function d(e){var t=d.resolve(e);return!1===t?{}:c(t)}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=e,c.cache=s,c.parent=r,c.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(c,"root",{get:function(){return a[o]}}),a[o]=c;for(var p=0;p<t.length;p++)c(t[p])}({"1elmM":[function(e,t,n){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(n),o.export(n,"initializeDonationDetailsPage",()=>l);var i=e("@xatom/core"),a=e("@xatom/image"),r=e("../../../api/apiConfig"),s=e("./components/CancelDonationSubscriptionDialog");async function l(){"/donation-details"===window.location.pathname&&new i.WFComponent(".breadcrumbs_container").setStyle({display:"none"});let e=new URLSearchParams(window.location.search).get("donation");if(!e){console.error("Missing donation UUID");return}try{let t=(0,r.apiClient).get(`/dashboard/donations/${e}`),{donation:n}=await t.fetch(),o=n.support_campaign,l=new a.WFImage("#campaignImage");o&&o.Main_Image?(l.setImage(o.Main_Image),l.getElement().setAttribute("alt",`${o.Name} - Campaign Image`)):(l.setImage("https://cdn.prod.website-files.com/667f080f36260b9afbdc46b2/667f080f36260b9afbdc46be_placeholder.svg"),l.getElement().setAttribute("alt","Default campaign image")),l.setStyle({display:"block"});let c=new i.WFComponent("#campaignName"),p=new i.WFComponent("#campaignSubheading"),u=new i.WFComponent("#campaignBreadcrumb"),d=new i.WFComponent("#campaignShortDescription"),m=new Date(n.created_at).toLocaleDateString([],{month:"2-digit",day:"2-digit",year:"2-digit"});o?(c.setText(o.Name),p.setText(o.Subheading),d.setText(o.Short_Description),u.setText(`${o.Name} - ${m}`)):(c.setText(n.campaign_name||"Support Campaign"),p.setStyle({display:"none"}),d.setStyle({display:"none"}),u.setText(`${n.campaign_name||"Donation"} - ${m}`));let g=new i.WFComponent("#anonymousTrue"),f=new i.WFComponent("#anonymousFalse");n.keep_anonymous?(g.setStyle({display:"block"}),f.setStyle({display:"none"})):(g.setStyle({display:"none"}),f.setStyle({display:"block"})),new i.WFComponent("#invoiceAmount").setText(`$${n.amount.toFixed(2)}`),new i.WFComponent("#invoiceDate").setText(m);let h=new i.WFComponent("#inNameOfHeader"),y=new i.WFComponent("#inNameOfCell");n.in_name_of?.trim()?(h.setStyle({display:"table-cell"}),y.setStyle({display:"table-cell"}),y.setText(n.in_name_of)):(h.setStyle({display:"none"}),y.setStyle({display:"none"}));let b=new i.WFComponent("#donationType"),S=n.donation_subscription?.subscription_type;b.setText("month"===S?"Monthly":"year"===S?"Annually":"One-Time");let w=new i.WFComponent("#cancelSubscriptionWrap"),C=new i.WFComponent("#subscriptionCancelledText"),v=n.donation_subscription?.status==="Cancelled";!S||"month"!==S&&"year"!==S||v?w.setStyle({display:"none"}):new s.CancelDonationSubscriptionDialog({containerSelector:"#cancelSubscriptionWrap",subscriptionId:String(n.donation_subscription.id),onCancelSuccess:()=>{window.location.reload()}}),C.setStyle({display:v?"block":"none"});let x=document.querySelector(".success_trigger");x instanceof HTMLElement&&x.click()}catch(e){console.error("Failed to initialize donation details page:",e)}}},{"@xatom/core":"65YBq","@xatom/image":"bavwf","../../../api/apiConfig":"dUmIV","./components/CancelDonationSubscriptionDialog":"2LcFn","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],bavwf:[function(e,t,n){var o,i=e("d023971cccd819e3"),a={};Object.defineProperty(a,"WFImage",{get:()=>r,set:void 0,enumerable:!0,configurable:!0});class r extends i.WFComponent{constructor(e){super(e)}getImageConfig(){return this._config}getSrc(){return this.getAttribute("src")}getSizes(){return this.getAttribute("sizes")}getSrcSet(){return this.getAttribute("srcset")}getLoading(){return this.getAttribute("loading")}onLoad(e){return this.on("load",e),()=>{this.off("load",e)}}onLoadError(e){return this.on("error",e),()=>{this.off("error",e)}}setImage(e){if("string"==typeof e)this.setAttribute("src",e),this.removeAttribute("srcset"),this.removeAttribute("sizes");else{if(this.setAttribute("src",e.src),"object"==typeof e&&e.srcSet&&e.srcSet.length&&e.sizes&&e.sizes.length){let t=e.srcSet.map(e=>`${e.url} ${e.size}`).join(", ");this.setAttribute("srcset",t)}else this.removeAttribute("srcset"),this.removeAttribute("sizes");e.loading&&this.setAttribute("loading",e.loading)}}}o=t.exports,Object.keys(a).forEach(function(e){"default"===e||"__esModule"===e||o.hasOwnProperty(e)||Object.defineProperty(o,e,{enumerable:!0,get:function(){return a[e]}})})},{d023971cccd819e3:"65YBq"}],"2LcFn":[function(e,t,n){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(n),o.export(n,"CancelDonationSubscriptionDialog",()=>l);var i=e("@xatom/core"),a=e("../../../../api/apiConfig"),r=e("../../../../utils/formUtils"),s=e("../../../../utils/validationUtils");class l{constructor(e){let{containerSelector:t,subscriptionId:n,onCancelSuccess:o}=e;this.container=new i.WFComponent(t),this.subscriptionId=n,this.cancelForm=new i.WFFormComponent("#cancelSubscriptionForm"),this.dialog=new i.WFComponent("#cancelSubscriptionDialog"),this.pageMain=new i.WFComponent(".page_main"),this.initialize(o)}initialize(e){new i.WFComponent("#openCancelSubscription").on("click",()=>this.openDialog()),new i.WFComponent("#close-cancel-dialog-btn").on("click",()=>this.closeDialog()),this.setupFormSubmission(e),this.setupFormValidation()}openDialog(){let e=this.dialog.getElement();e?.showModal(),this.pageMain.setAttribute("data-brand","6")}closeDialog(){let e=this.dialog.getElement();e?.close(),this.pageMain.setAttribute("data-brand","2")}setupFormSubmission(e){this.cancelForm.onFormSubmit(async(t,n)=>{n.preventDefault();let o=t.removed_because;if(!(0,s.validateNotEmpty)(o)){(0,r.toggleError)(new i.WFComponent("#submitCancelError"),"Reason for cancelling is required.",!0);return}this.setLoadingState(!0);try{let t=await (0,a.apiClient).delete(`/donate/subscription/${this.subscriptionId}`,{data:{reason:o}}).fetch();if(t?.status==="Cancelled")(0,r.toggleError)(new i.WFComponent("#submitCancelError"),"",!1),this.closeDialog(),e();else throw Error(`Unexpected status: ${t?.status}`)}catch(e){console.error("Cancel subscription failed:",e),this.showErrorMessage("Oops! Something went wrong while submitting the form.")}finally{this.setLoadingState(!1)}})}setupFormValidation(){let e=new i.WFComponent("#removedReason"),t=new i.WFComponent("#submitCancelError"),n=(0,r.createValidationFunction)(e,s.validateNotEmpty,"Reason for cancelling is required.");(0,r.setupValidation)(e,t,n)}setLoadingState(e){let t=new i.WFComponent("#submitCancelLoading"),n=new i.WFComponent("#submitCancel");t.setStyle({display:e?"block":"none"}),e?n.setAttribute("disabled","true"):n.removeAttribute("disabled")}showErrorMessage(e){let t=new i.WFComponent("#submitUpdateError");t.setText(e),t.setStyle({display:"flex"})}static hideCancelButtonIfOneTime(e){let t=new i.WFComponent("#cancelSubscriptionWrap");e&&"one-time"!==e?t.setStyle({display:"flex"}):t.setStyle({display:"none"})}}},{"@xatom/core":"65YBq","../../../../api/apiConfig":"dUmIV","../../../../utils/formUtils":"gepHz","../../../../utils/validationUtils":"gu2z7","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],gepHz:[function(e,t,n){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(n),o.export(n,"toggleError",()=>l),o.export(n,"setupValidation",()=>c),o.export(n,"createValidationFunction",()=>p),o.export(n,"createCheckboxValidationFunction",()=>u),o.export(n,"setupCheckboxValidation",()=>d),o.export(n,"validateSelectedSessions",()=>m),o.export(n,"setProfilePicUrl",()=>g),o.export(n,"setupFileUpload",()=>f),o.export(n,"formatPhoneNumber",()=>h);var i=e("@xatom/core"),a=e("@xatom/image"),r=e("../api/apiConfig"),s=e("../auth/authConfig");function l(e,t,n){e.updateTextViaAttrVar({text:n?t:""}),e.setStyle({display:n?"flex":"none"})}function c(e,t,n,o){let i=()=>{let e=n();l(t,e,!!e),o&&""===e&&l(o,"",!1)};e.on("input",i),e.on("blur",i),e.on("change",i)}function p(e,t,n){return()=>t(e.getElement().value)?"":n}function u(e,t){return()=>e.getElement().checked?"":t}function d(e,t,n){let o=u(e,n);c(e,t,o)}function m(e,t,n){let o=e.length>0&&e.some(e=>e.studentIds.length>0);return o?l(t,"",!1):l(t,n,!0),o}function g(e){let t=(0,s.userAuth).getUser();t&&t.profile&&(t.profile.profile_pic=t.profile.profile_pic||{url:""},t.profile.profile_pic.url=e,(0,s.userAuth).setUser(t),localStorage.setItem("auth_user",JSON.stringify(t)))}function f(e,t,n,o){let s=new a.WFImage("#profilePictureImage"),c=new i.WFComponent("#uploadAnimation"),p=new i.WFComponent(".drop-zone"),u=0;return new Promise(i=>{let a=a=>{if(!["image/jpeg","image/jpg"].includes(a.type)&&!/\.(jpg|jpeg)$/i.test(a.name)){l(t,"Only JPEG images are allowed.",!0),e.getElement().value="";return}if(a.size>2097152){l(t,"File size must be less than 2 MB.",!0),e.getElement().value="";return}c.setStyle({display:"flex"}),t.setStyle({display:"none"}),n.setStyle({display:"none"});let d=new FileReader;d.onload=e=>{let t=e.target?.result;s.setImage(t),p.setStyle({display:"none"})},d.readAsDataURL(a);let m=new FormData;m.append("profile_picture",a);let f=localStorage.getItem("current_student");if(f){let e=JSON.parse(f);m.append("student_profile_id",e.id.toString())}let h=(0,r.apiClient).post(o,{data:m});h.onData(o=>{if("success"===o.status){let e=o.url.profile_pic.url;g(e),s.setImage(e),localStorage.setItem("image_upload",e),n.setStyle({display:"flex"}),c.setStyle({display:"none"}),i(e)}else l(t,"Failed to upload profile picture.",!0),c.setStyle({display:"none"}),p.setStyle({display:"none"}),u=0,e.getElement().value=""}),h.onError(n=>{let o="An error occurred during image upload.";n.response&&n.response.data?o=n.response.data.message||o:n.message&&(o=n.message),l(t,o,!0),c.setStyle({display:"none"}),p.setStyle({display:"none"}),u=0,e.getElement().value=""}),h.fetch()};e.on("change",()=>{let t=e.getElement().files?.[0];t&&a(t)});let d=document.body;d.addEventListener("dragenter",e=>{e.preventDefault(),1==++u&&p.setStyle({display:"flex"})}),d.addEventListener("dragleave",()=>{--u<=0&&(p.setStyle({display:"none"}),u=0)}),d.addEventListener("dragover",e=>{e.preventDefault()}),d.addEventListener("drop",e=>{e.preventDefault();let t=e.dataTransfer?.files;t?.length&&a(t[0]),p.setStyle({display:"none"}),u=0})})}let h=e=>{let t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:t.length<=10?`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`}},{"@xatom/core":"65YBq","@xatom/image":"bavwf","../api/apiConfig":"dUmIV","../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],gu2z7:[function(e,t,n){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");function i(e){return void 0!==e&&""!==e.trim()}function a(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}o.defineInteropFlag(n),o.export(n,"validateNotEmpty",()=>i),o.export(n,"validateEmail",()=>a),o.export(n,"validateEmailOptional",()=>r),o.export(n,"validatePasswordRequirements",()=>s),o.export(n,"validateCheckbox",()=>l),o.export(n,"validatePasswordsMatch",()=>c),o.export(n,"validateSelectField",()=>p),o.export(n,"validatePhoneNumber",()=>u),o.export(n,"validatePhoneNumberOptional",()=>d);let r=e=>""===e.trim()||a(e);function s(e){let t=/[a-z]/.test(e),n=/[A-Z]/.test(e),o=/\d/.test(e),i=/[!@#$%^&*(),.?":{}|<>]/.test(e),a=e.length>=8;return t&&n&&o&&i&&a}function l(e){return e}function c(e,t){return e===t}function p(e){return void 0!==e&&"N/A"!==e}function u(e){return/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)}let d=e=>""===e.trim()||u(e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}]},[],0,"parcelRequired346");
//# sourceMappingURL=donationDetails.e5adbd59.js.map
