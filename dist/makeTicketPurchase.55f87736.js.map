{"mappings":"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","sources":["src/modules/tickets/makeTicketPurchase.ts","src/modules/tickets/productionList.ts","src/api/productions.ts","src/modules/tickets/state/ticketPurchaseState.ts","src/modules/tickets/performanceList.ts","src/api/performances.ts","src/modules/tickets/components/performanceFilter.ts","src/modules/tickets/ticketTiers.ts","src/api/ticketTiersAPI.ts","src/modules/tickets/components/ticketTierListRender.ts","src/modules/tickets/components/bundleRenderer.ts","src/modules/tickets/state/bundleStateUpdater.ts","src/modules/tickets/components/ticketTierRenderer.ts","src/utils/formUtils.ts","node_modules/.pnpm/@xatom+image@1.0.0_@xatom+core@1.0.12/node_modules/@xatom/image/dist/index.js","src/modules/tickets/components/selectedPerformanceUI.ts","src/modules/tickets/components/customQuestionUI.ts","src/modules/tickets/components/assistanceInputUI.ts","src/modules/tickets/components/userDetailsUI.ts","node_modules/.pnpm/@xatom+slider@1.0.0_@xatom+core@1.0.12/node_modules/@xatom/slider/dist/index.js","src/modules/tickets/components/sidebarIndicators.ts","src/utils/validationUtils.ts","src/modules/tickets/components/urlParamNavigator.ts"],"sourcesContent":["import { WFComponent, WFFormComponent } from \"@xatom/core\";\nimport { initializeProductionList } from \"./productionList\";\nimport { initializePerformanceList } from \"./performanceList\";\nimport { initializeTicketTiers } from \"./ticketTiers\";\nimport {\n  getSelectedProduction,\n  getSelectedPerformance,\n  loadTicketPurchaseState,\n  getSelectedBundles,\n  getSelectedTickets,\n  clearTicketPurchaseState,\n  clearSelectedPerformance,\n  clearSelectedBundles,\n  clearSelectedTickets,\n} from \"./state/ticketPurchaseState\";\nimport { WFSlider } from \"@xatom/slider\";\nimport {\n  initializeTicketSidebarIndicators,\n  setActiveTicketStep,\n  markTicketStepAsCompleted,\n  unsetActiveTicketStep,\n  unmarkTicketStepAsCompleted,\n} from \"./components/sidebarIndicators\";\nimport { validateNotEmpty, validateEmail } from \"../../utils/validationUtils\";\nimport { toggleError, createValidationFunction } from \"../../utils/formUtils\";\nimport { apiClient } from \"../../api/apiConfig\";\nimport { initializeStateFromUrlParams } from \"./components/urlParamNavigator\";\n\ninterface checkoutResponse {\n  checkout_url: string;\n}\n\n// Initialize the ticket purchase process\nexport const makeTicketPurchase = async () => {\n  const slider = new WFSlider(\".multi-step_form_slider\");\n\n  // Initialize state from URL parameters\n  await initializeStateFromUrlParams(slider);\n\n  // Initialize sidebar indicators\n  initializeTicketSidebarIndicators();\n\n  // Step 1: Initialize production list\n  await initializeProductionList(\"#selectProductionList\");\n\n  // Handle form submission for production selection\n  const formStepOne = new WFFormComponent<{ production_id: string }>(\n    \"#formStepOne\"\n  );\n  const submitButtonStepOne = new WFComponent(\"#submitStepOne\")\n\n  formStepOne.onFormSubmit(async (formData, event) => {\n    event.preventDefault();\n    submitButtonStepOne.setAttribute(\"disabled\", \"true\");\n    const selectedProduction = getSelectedProduction();\n    const stepOneRequestingAnimation = new WFComponent(\n      \"#stepOneRequestingAnimation\"\n    );\n\n    if (!selectedProduction || !selectedProduction.id) {\n      console.error(\"No production selected.\");\n      const submitStepOneError = new WFComponent(\"#submitStepOneError\");\n      submitStepOneError.setText(\"Please select a production.\");\n      submitStepOneError.setStyle({ display: \"block\" });\n      submitButtonStepOne.removeAttribute(\"disabled\");\n      return;\n    }\n\n    console.log(\"Production selected:\", selectedProduction);\n\n    const submitStepOneError = new WFComponent(\"#submitStepOneError\");\n    submitStepOneError.setStyle({ display: \"none\" });\n\n    // Show the loading animation\n    stepOneRequestingAnimation.setStyle({ display: \"block\" });\n\n    try {\n      // Proceed to Step 2: Initialize performance list\n      await initializePerformanceList(\"#selectPerformanceList\");\n\n      // Mark Step 1 as completed and move to Step 2\n      markTicketStepAsCompleted(1);\n      setActiveTicketStep(2);\n\n      // Move to the next step\n      slider.goNext();\n    } catch (error) {\n      console.error(\"Error during step 1 processing:\", error);\n    } finally {\n      // Hide the loading animation\n      stepOneRequestingAnimation.setStyle({ display: \"none\" });\n      submitButtonStepOne.removeAttribute(\"disabled\");\n    }\n  });\n\n  // Step 2: Handle form submission for performance selection\n  const formStepTwo = new WFFormComponent<{ performance_id: string }>(\n    \"#formStepTwo\"\n  );\n  const submitButtonStepTwo = new WFComponent(\"#submitStepTwo\")\n\n\n  formStepTwo.onFormSubmit(async (formData, event) => {\n    event.preventDefault();\n    submitButtonStepTwo.setAttribute(\"disabled\", \"true\");\n    const selectedPerformance = getSelectedPerformance();\n    const stepTwoRequestingAnimation = new WFComponent(\n      \"#stepTwoRequestingAnimation\"\n    );\n\n    if (!selectedPerformance || !selectedPerformance.id) {\n      console.error(\"No performance selected.\");\n      const submitStepTwoError = new WFComponent(\"#submitStepTwoError\");\n      submitStepTwoError.setText(\"Please select a performance.\");\n      submitStepTwoError.setStyle({ display: \"block\" });\n      submitButtonStepTwo.removeAttribute(\"disabled\");\n      return;\n    }\n\n    console.log(\"Performance selected:\", selectedPerformance);\n\n    const submitStepTwoError = new WFComponent(\"#submitStepTwoError\");\n    submitStepTwoError.setStyle({ display: \"none\" });\n\n    // Show the loading animation\n    stepTwoRequestingAnimation.setStyle({ display: \"block\" });\n\n    try {\n      // Mark Step 2 as completed and move to Step 3\n      markTicketStepAsCompleted(2);\n      setActiveTicketStep(3);\n\n      // Initialize ticket tiers (Step 3)\n      await initializeTicketTiers(\"#bundleList\", \"#ticketTierList\");\n\n      // Move to the next step\n      slider.goNext();\n    } catch (error) {\n      console.error(\"Error during step 2 processing:\", error);\n    } finally {\n      // Hide the loading animation\n      stepTwoRequestingAnimation.setStyle({ display: \"none\" });\n      submitButtonStepTwo.removeAttribute(\"disabled\");\n    }\n  });\n\n  // Step 3: Handle form submission for final checkout\n  const formStepThree = new WFFormComponent(\"#formStepThree\");\n  const emailWrap = new WFComponent(\"#emailWrap\");\n  const firstNameInput = new WFComponent(\"#firstNameInput\");\n  const lastNameInput = new WFComponent(\"#lastNameInput\");\n  const emailInput = new WFComponent(\"#emailInput\");\n  const customQuestionInput = new WFComponent(\"#customQuestionInput\");\n  const submitStepThreeError = new WFComponent(\"#submitStepThreeError\");\n  const noTicketsError = new WFComponent(\"#noTicketsError\");\n  const submitButtonStepThree = new WFComponent(\"#submitStepThree\")\n\n  // Function to clear errors on interaction\n  const clearErrorOnInteraction = (\n    inputComponent: WFComponent,\n    errorComponent: WFComponent\n  ) => {\n    const clearError = () => toggleError(errorComponent, \"\", false);\n    inputComponent.on(\"input\", clearError);\n    inputComponent.on(\"focus\", clearError);\n    inputComponent.on(\"change\", clearError);\n  };\n\n  formStepThree.onFormSubmit(async (formData, event) => {\n    event.preventDefault();\n    let formIsValid = true;\n    submitButtonStepThree.setAttribute(\"disabled\", \"true\");\n    // clear any existing submit errors\n    submitStepThreeError.setStyle({ display: \"none\" });\n\n    // Validate email wrap section if displayed\n    if (emailWrap.getElement().style.display !== \"none\") {\n      // Validate First Name\n      const firstNameError = new WFComponent(\"#firstNameInputError\");\n      const firstNameValidation = createValidationFunction(\n        firstNameInput,\n        validateNotEmpty,\n        \"First name is required.\"\n      );\n      const firstNameValidationResult = firstNameValidation();\n      toggleError(\n        firstNameError,\n        firstNameValidationResult,\n        !!firstNameValidationResult\n      );\n      formIsValid = formIsValid && !firstNameValidationResult;\n      clearErrorOnInteraction(firstNameInput, firstNameError);\n\n      // Validate Last Name\n      const lastNameError = new WFComponent(\"#lastNameInputError\");\n      const lastNameValidation = createValidationFunction(\n        lastNameInput,\n        validateNotEmpty,\n        \"Last name is required.\"\n      );\n      const lastNameValidationResult = lastNameValidation();\n      toggleError(\n        lastNameError,\n        lastNameValidationResult,\n        !!lastNameValidationResult\n      );\n      formIsValid = formIsValid && !lastNameValidationResult;\n      clearErrorOnInteraction(lastNameInput, lastNameError);\n\n      // Validate Email\n      const emailError = new WFComponent(\"#emailInputError\");\n      const emailValidation = createValidationFunction(\n        emailInput,\n        validateEmail,\n        \"A valid email is required.\"\n      );\n      const emailValidationResult = emailValidation();\n      toggleError(emailError, emailValidationResult, !!emailValidationResult);\n      formIsValid = formIsValid && !emailValidationResult;\n      clearErrorOnInteraction(emailInput, emailError);\n    }\n\n    // Validate Custom Question\n    // Only validate the custom question if that entire section is shown\nconst customQuestionWrap = document.getElementById(\"customQuestionWrap\")!;\nif (customQuestionWrap.style.display !== \"none\") {\n  const customQuestionError = new WFComponent(\"#customQuestionInputError\");\n  const customQuestionValidation = createValidationFunction(\n    customQuestionInput,\n    validateNotEmpty,\n    \"This field is required.\"\n  );\n  const customQuestionValidationResult = customQuestionValidation();\n  toggleError(\n    customQuestionError,\n    customQuestionValidationResult,\n    !!customQuestionValidationResult\n  );\n  formIsValid = formIsValid && !customQuestionValidationResult;\n  clearErrorOnInteraction(customQuestionInput, customQuestionError);\n}\n\n\n    // Validate that at least one bundle or ticket is selected\n    const selectedBundles = getSelectedBundles();\n    const selectedTickets = getSelectedTickets();\n\n    if (selectedBundles.length === 0 && selectedTickets.length === 0) {\n      toggleError(\n        noTicketsError,\n        \"Please select at least one bundle or ticket.\",\n        true\n      );\n      formIsValid = false;\n    } else {\n      toggleError(noTicketsError, \"\", false);\n    }\n\n    if (!formIsValid) {\n      console.error(\"Form validation failed.\");\n      submitStepThreeError.setText(\"Please correct the highlighted errors.\");\n      submitStepThreeError.setStyle({ display: \"block\" });\n      submitButtonStepThree.removeAttribute(\"disabled\");\n      return;\n    }\n\n    console.log(\"Final form is valid, proceeding with submission...\");\n\n    const stepThreeRequestingAnimation = new WFComponent(\n      \"#stepThreeRequestingAnimation\"\n    );\n    stepThreeRequestingAnimation.setStyle({ display: \"block\" });\n\n    try {\n      // Load the current state\n      const ticketPurchaseState = loadTicketPurchaseState();\n\n      // Extract only the required values from the state\n      const {\n        selectedBundles,\n        selectedTickets,\n        email,\n        firstName,\n        lastName,\n        customQuestion,\n        assistanceNeeded,\n        assistanceMessage,\n        selectedProductionId,\n        selectedPerformanceId,\n      } = ticketPurchaseState;\n\n      // Construct the cancel_url\n      const cancelUrl = `${window.location.origin}/purchase-tickets?production=${selectedProductionId}&performance=${selectedPerformanceId}`;\n\n      // Create the payload with only the required values and the cancel_url\n      const payload = {\n        selectedBundles,\n        selectedTickets,\n        email,\n        firstName,\n        lastName,\n        customQuestion,\n        assistanceNeeded,\n        assistanceMessage,\n        selectedProductionId,\n        selectedPerformanceId,\n        cancel_url: cancelUrl,\n      };\n\n      // Submit the extracted state to the /tickets/begin_checkout endpoint\n      const response = await apiClient\n        .post<checkoutResponse>(\"/tickets/begin_checkout\", {\n          data: payload,\n        })\n        .fetch();\n\n      // Handle the response (e.g., redirect to the payment page or show success message)\n      console.log(\"Checkout response:\", response);\n\n      // Mark Step 3 as completed\n      markTicketStepAsCompleted(3);\n\n      // Redirect or show success (this depends on your application flow)\n      window.location.href = response.checkout_url || \"/payment\";\n    } catch (error) {\n      console.error(\"Error during final step processing:\", error);\n      submitStepThreeError.setText(\n        \"An error occurred during checkout. Please try again.\"\n      );\n      submitStepThreeError.setStyle({ display: \"block\" });\n    } finally {\n      stepThreeRequestingAnimation.setStyle({ display: \"none\" });\n      submitButtonStepThree.removeAttribute(\"disabled\");\n    }\n  });\n\n  // Handle \"Go Back\" button for Step 3\n  const backStepThree = new WFComponent(\"#backStepThree\");\n  backStepThree.on(\"click\", () => {\n    clearSelectedBundles();\n    clearSelectedTickets();\n    slider.goPrevious();\n    unsetActiveTicketStep(3);\n    unmarkTicketStepAsCompleted(2);\n    setActiveTicketStep(2);\n  });\n\n  // Handle \"Go Back\" button for Step 2\n  const backStepTwo = new WFComponent(\"#backStepTwo\");\n  backStepTwo.on(\"click\", () => {\n    clearSelectedPerformance();\n    slider.goPrevious();\n    unsetActiveTicketStep(2);\n    unmarkTicketStepAsCompleted(1);\n    setActiveTicketStep(1);\n  });\n\n  // Initialize sidebar indicators and set the first step as active\n  setActiveTicketStep(1);\n};\n","import { WFDynamicList, WFComponent } from \"@xatom/core\";\nimport { fetchProductions, Production } from \"../../api/productions\";\nimport { saveSelectedProduction } from \"./state/ticketPurchaseState\";\n\nlet selectedProductionId: string | null = null;\nlet initialTemplateState: HTMLElement | null = null;\n\ntype SafeProductionRow = {\n  id: number | string | null;\n  Name?: string | null;\n  Short_Description?: string | null;\n  Age_Description?: string | null;\n  Main_Image?: string | null;\n};\n\nexport const initializeProductionList = async (\n  containerSelector: string\n): Promise<Production[]> => {\n  const container = document.querySelector(containerSelector);\n  if (!container) {\n    console.error(\"Production list container not found.\");\n    return [];\n  }\n\n  // Cache pristine template state\n  if (!initialTemplateState) {\n    initialTemplateState = container.cloneNode(true) as HTMLElement;\n  }\n\n  // Reset container to clean template\n  container.innerHTML = \"\";\n  container.appendChild(initialTemplateState.cloneNode(true));\n\n  const list = new WFDynamicList<Production>(containerSelector, {\n    rowSelector: \"#cardSelectProduction\",\n    loaderSelector: \"#productionListLoading\",\n    emptySelector: \"#productionListEmpty\",\n  });\n\n  list.loaderRenderer((loaderElement) => {\n    loaderElement.setStyle({ display: \"flex\" });\n    return loaderElement;\n  });\n\n  list.emptyRenderer((emptyElement) => {\n    emptyElement.setStyle({ display: \"flex\" });\n    return emptyElement;\n  });\n\n  list.rowRenderer(({ rowData: rawData, rowElement, index }) => {\n    // -------------------------------------------------\n    // 1) Normalize API data (NO undefined/null into setters)\n    // -------------------------------------------------\n    const rowData = rawData as unknown as SafeProductionRow;\n\n    const safeName = rowData.Name ?? \"\";\n    const safeDesc = rowData.Short_Description ?? \"\";\n    const safeAges = rowData.Age_Description ?? \"\";\n    const safeImg = rowData.Main_Image ?? \"\";\n\n    // ID must exist (or row should not be selectable)\n    const idNum = Number(rowData.id);\n    const hasValidId = Number.isFinite(idNum) && idNum > 0;\n\n    // -------------------------------------------------\n    // 2) Grab DOM components\n    // -------------------------------------------------\n    const productionCard = new WFComponent(rowElement);\n\n    const productionTitle =\n      productionCard.getChildAsComponent(\"#cardProductionTitle\");\n    const productionDescription =\n      productionCard.getChildAsComponent(\"#cardProductionDescription\");\n    const productionAges =\n      productionCard.getChildAsComponent(\"#cardProductionAges\");\n    const productionImage =\n      productionCard.getChildAsComponent(\"#cardProductionImage\");\n    const productionInput =\n      productionCard.getChildAsComponent(\".input_card_input\");\n    const productionLabel =\n      productionCard.getChildAsComponent(\"label\");\n\n    // -------------------------------------------------\n    // 3) Required structure only\n    // -------------------------------------------------\n    if (!productionTitle || !productionInput || !productionLabel) {\n      console.error(\"Required production elements not found.\");\n      return;\n    }\n\n    // If id is invalid/null, hide the row (prevents crashes + bad selections)\n    if (!hasValidId) {\n      console.warn(\"[ProductionList] Skipping row with invalid id:\", rowData);\n      rowElement.setStyle({ display: \"none\" });\n      return;\n    }\n\n    // -------------------------------------------------\n    // 4) Input wiring (no .toString() on nullable values)\n    // -------------------------------------------------\n    const inputId = `productionInput-${index}`;\n    productionInput.setAttribute(\"id\", inputId);\n    productionInput.setAttribute(\"value\", String(idNum));\n    productionLabel.setAttribute(\"for\", inputId);\n\n    // -------------------------------------------------\n    // 5) Text fields (safe defaults)\n    // -------------------------------------------------\n    productionTitle.setText(safeName);\n    productionDescription?.setText(safeDesc);\n    productionAges?.setText(safeAges);\n\n    // -------------------------------------------------\n    // 6) Image (optional)\n    // -------------------------------------------------\n    if (productionImage) {\n      if (safeImg) {\n        productionImage.setAttribute(\"src\", safeImg);\n        productionImage.setAttribute(\"alt\", safeName || \"Production Image\");\n        productionImage.setStyle({ display: \"\" });\n      } else {\n        productionImage.setAttribute(\"src\", \"\");\n        productionImage.setStyle({ display: \"none\" });\n      }\n    }\n\n    // -------------------------------------------------\n    // 7) Selection handling\n    // -------------------------------------------------\n    productionInput.on(\"change\", () => {\n      selectedProductionId = (\n        productionInput.getElement() as HTMLInputElement\n      ).value;\n\n      saveSelectedProduction({\n        id: idNum,\n        name: safeName,\n        description: safeDesc,\n        imageUrl: safeImg,\n      });\n\n      console.log(\"Selected Production ID:\", selectedProductionId);\n    });\n\n    rowElement.setStyle({ display: \"flex\" });\n    return rowElement;\n  });\n\n  // -------------------------------------------------\n  // 8) Data load\n  // -------------------------------------------------\n  try {\n    list.changeLoadingStatus(true);\n\n    const productions = await fetchProductions();\n    console.log(\"Fetched productions:\", productions);\n\n    // Helpful debug: quickly spot null ids\n    // console.table((productions as any[]).map(p => ({ id: p?.id, Name: p?.Name })));\n\n    list.setData(productions);\n    list.changeLoadingStatus(false);\n\n    return productions;\n  } catch (error) {\n    console.error(\"Error loading productions:\", error);\n    list.setData([]);\n    list.changeLoadingStatus(false);\n    return [];\n  }\n};\n","// src/api/productions.ts\n\nimport { apiClient } from \"./apiConfig\";\n\nexport interface Production {\n  /** now a number */\n  id: number;\n  Name: string;\n  Short_Description: string;\n  Main_Image: string;\n  Age_Description: string;\n}\n\ninterface ProductionApiResponse {\n  productions: Production[];\n}\n\n// Fetch productions from the server\nexport const fetchProductions = async (): Promise<Production[]> => {\n  try {\n    const response = await apiClient\n      .get<ProductionApiResponse>(\"/tickets/productions\")\n      .fetch();\n    return response.productions;\n  } catch (error) {\n    console.error(\"Error fetching productions:\", error);\n    throw error;\n  }\n};\n","export interface TicketItem {\n  ticket_tier_id: string;\n  quantity: number;\n  bundle_required: boolean;\n}\n\nexport interface BundleItem {\n  bundle_id: string;\n  quantity: number;\n}\n\nexport interface TicketPurchaseState {\n  selectedProductionId?: number;\n  selectedProductionName?: string;\n  selectedProductionDescription?: string;\n  selectedProductionImageUrl?: string;\n  selectedPerformanceId?: string;\n  selectedPerformanceName?: string;\n  selectedPerformanceDateTime?: string;\n  selectedPerformanceDescription?: string;\n  selectedPerformanceImageUrl?: string;\n  selectedPerformanceLocation?: string;\n  selectedBundles?: BundleItem[];\n  selectedTickets?: TicketItem[];\n  customQuestion?: string;\n  assistanceNeeded?: boolean;\n  assistanceMessage?: string;\n  firstName?: string;\n  lastName?: string;\n  email?: string;\n}\n\nconst TICKET_PURCHASE_STATE_KEY = \"ticketPurchaseState\";\n\n// Utility to convert unknown to number\nconst safeNumber = (value: unknown): number =>\n  typeof value === \"number\" ? value : 0;\n\nexport const loadTicketPurchaseState = (): TicketPurchaseState => {\n  const saved = localStorage.getItem(TICKET_PURCHASE_STATE_KEY);\n  return saved ? JSON.parse(saved) : {};\n};\n\nexport const saveTicketPurchaseState = (\n  state: Partial<TicketPurchaseState>\n) => {\n  const current = loadTicketPurchaseState();\n  const merged = { ...current, ...state };\n  localStorage.setItem(\n    TICKET_PURCHASE_STATE_KEY,\n    JSON.stringify(merged)\n  );\n};\n\nexport const clearTicketPurchaseState = () => {\n  localStorage.removeItem(TICKET_PURCHASE_STATE_KEY);\n};\n\n// Production-related\nexport const getSelectedProduction = () => {\n  const s = loadTicketPurchaseState();\n  return {\n    id: s.selectedProductionId ?? null,\n    name: s.selectedProductionName ?? null,\n    description: s.selectedProductionDescription ?? null,\n    imageUrl: s.selectedProductionImageUrl ?? null,\n  };\n};\n\nexport const saveSelectedProduction = (production: {\n  id: number;\n  name: string;\n  description: string;\n  imageUrl: string;\n}) => {\n  saveTicketPurchaseState({\n    selectedProductionId: production.id,\n    selectedProductionName: production.name,\n    selectedProductionDescription: production.description,\n    selectedProductionImageUrl: production.imageUrl,\n  });\n};\n\n// Performance-related\nexport const getSelectedPerformance = () => {\n  const s = loadTicketPurchaseState();\n  return {\n    id: s.selectedPerformanceId ?? null,\n    name: s.selectedPerformanceName ?? null,\n    dateTime: s.selectedPerformanceDateTime ?? null,\n    description: s.selectedPerformanceDescription ?? null,\n    imageUrl: s.selectedPerformanceImageUrl ?? null,\n    location: s.selectedPerformanceLocation ?? null,\n  };\n};\n\nexport const saveSelectedPerformance = (perf: {\n  id: string;\n  name: string;\n  dateTime: string;\n  description: string;\n  imageUrl: string;\n  location: string;\n}) => {\n  saveTicketPurchaseState({\n    selectedPerformanceId: perf.id,\n    selectedPerformanceName: perf.name,\n    selectedPerformanceDateTime: perf.dateTime,\n    selectedPerformanceDescription: perf.description,\n    selectedPerformanceImageUrl: perf.imageUrl,\n    selectedPerformanceLocation: perf.location,\n  });\n};\n\n// Bundle functions\nexport const getSelectedBundles = (): BundleItem[] => {\n  return loadTicketPurchaseState().selectedBundles || [];\n};\n\nexport const saveSelectedBundle = (bundleId: string, quantity: number) => {\n  const bundles = getSelectedBundles();\n  const idx = bundles.findIndex((b) => b.bundle_id === bundleId);\n  if (idx > -1) {\n    if (quantity > 0) bundles[idx].quantity = quantity;\n    else bundles.splice(idx, 1);\n  } else if (quantity > 0) {\n    bundles.push({ bundle_id: bundleId, quantity });\n  }\n  saveTicketPurchaseState({ selectedBundles: bundles });\n};\n\nexport const removeSelectedBundle = (bundleId: string) => {\n  const remaining = getSelectedBundles().filter((b) => b.bundle_id !== bundleId);\n  saveTicketPurchaseState({ selectedBundles: remaining });\n  // Remove bundle_required tickets if none selected\n  const total = remaining.reduce((sum, b) => sum + safeNumber(b.quantity), 0);\n  if (total === 0) {\n    const tickets = getSelectedTickets().filter((t) => !t.bundle_required);\n    saveTicketPurchaseState({ selectedTickets: tickets });\n  }\n};\n\n// Ticket functions\nexport const getSelectedTickets = (): TicketItem[] => {\n  return loadTicketPurchaseState().selectedTickets || [];\n};\n\nexport const saveSelectedTicket = (\n  tierId: string,\n  quantity: number,\n  bundle_required: boolean\n) => {\n  const tickets = getSelectedTickets();\n  const idx = tickets.findIndex((t) => t.ticket_tier_id === tierId);\n  if (idx > -1) {\n    if (quantity > 0) tickets[idx].quantity = quantity;\n    else tickets.splice(idx, 1);\n  } else if (quantity > 0) {\n    tickets.push({ ticket_tier_id: tierId, quantity, bundle_required });\n  }\n  saveTicketPurchaseState({ selectedTickets: tickets });\n};\n\nexport const removeSelectedTicket = (tierId: string) => {\n  const remaining = getSelectedTickets().filter((t) => t.ticket_tier_id !== tierId);\n  saveTicketPurchaseState({ selectedTickets: remaining });\n};\n\n// Assistance\nexport const getCustomQuestion = () => loadTicketPurchaseState().customQuestion ?? null;\nexport const saveCustomQuestion = (q: string) => saveTicketPurchaseState({ customQuestion: q });\nexport const getAssistanceNeeded = () => loadTicketPurchaseState().assistanceNeeded ?? false;\nexport const saveAssistanceNeeded = (v: boolean) => saveTicketPurchaseState({ assistanceNeeded: v });\nexport const getAssistanceMessage = () => loadTicketPurchaseState().assistanceMessage ?? '';\nexport const saveAssistanceMessage = (m: string) => saveTicketPurchaseState({ assistanceMessage: m });\n\n// User details\nexport const saveUserDetails = (d: { firstName?: string; lastName?: string; email?: string }) =>\n  saveTicketPurchaseState(d);\n\n// Clearers\nexport const clearSelectedPerformance = () => saveTicketPurchaseState({\n  selectedPerformanceId: undefined,\n  selectedPerformanceName: undefined,\n  selectedPerformanceDateTime: undefined,\n  selectedPerformanceDescription: undefined,\n  selectedPerformanceImageUrl: undefined,\n  selectedPerformanceLocation: undefined,\n});\nexport const clearSelectedBundles = () => saveTicketPurchaseState({ selectedBundles: [] });\nexport const clearSelectedTickets = () => saveTicketPurchaseState({ selectedTickets: [] });\n","// src/modules/tickets/performanceList.ts\n\nimport { WFDynamicList, WFComponent } from \"@xatom/core\";\nimport { fetchPerformances, Performance } from \"../../api/performances\";\nimport {\n  saveSelectedPerformance,\n  getSelectedProduction,\n} from \"./state/ticketPurchaseState\";\nimport { initializePerformanceFilter } from \"./components/performanceFilter\";\n\nlet initialTemplateState: HTMLElement | null = null;\n\ntype SafePerformanceRow = {\n  id: number | string | null;\n  Name?: string | null;\n  Displayed_Name?: string | null;\n  Short_Description?: string | null;\n  Main_Image?: string | null;\n  Date_Time?: number | string | null;\n  Sold_Out?: boolean | null;\n  location_details?: { Name?: string | null } | null;\n};\n\nexport const initializePerformanceList = async (\n  containerSelector: string\n): Promise<Performance[]> => {\n  const container = document.querySelector(containerSelector);\n  if (!container) {\n    console.error(\"Performance list container not found.\");\n    return [];\n  }\n\n  // Cache pristine template state\n  if (!initialTemplateState) {\n    initialTemplateState = container.cloneNode(true) as HTMLElement;\n  }\n\n  // Reset container to clean template\n  container.innerHTML = \"\";\n  container.appendChild(initialTemplateState.cloneNode(true));\n\n  const list = new WFDynamicList<Performance>(containerSelector, {\n    rowSelector: \"#cardSelectPerformance\",\n    loaderSelector: \"#performanceListLoading\",\n    emptySelector: \"#performanceListEmpty\",\n  });\n\n  list.loaderRenderer((loader) => {\n    loader.setStyle({ display: \"flex\" });\n    return loader;\n  });\n\n  list.emptyRenderer((empty) => {\n    empty.setStyle({ display: \"flex\" });\n    return empty;\n  });\n\n  list.rowRenderer(({ rowData, rowElement, index }) => {\n    // -------------------------------------------------\n    // 1) Normalize API data (no .toString() on nullable)\n    // -------------------------------------------------\n    const perf = rowData as unknown as SafePerformanceRow;\n\n    const safeName = perf.Name ?? \"\";\n    const safeDisplayed = perf.Displayed_Name ?? \"\";\n    const safeTitle = safeDisplayed || safeName || \"\";\n    const safeDesc = perf.Short_Description ?? \"\";\n    const safeImg = perf.Main_Image ?? \"\";\n    const safeVenue = perf.location_details?.Name ?? \"\";\n    const soldOut = Boolean(perf.Sold_Out);\n\n    const idNum = Number(perf.id);\n    const hasValidId = Number.isFinite(idNum) && idNum > 0;\n\n    // -------------------------------------------------\n    // 2) Grab DOM components\n    // -------------------------------------------------\n    const card = new WFComponent(rowElement);\n\n    const dateWrapper = card.getChildAsComponent(\".production_date_wrapper\");\n    const dayEl = dateWrapper?.getChildAsComponent(\".u-text-h4\");\n    const monthEl = dateWrapper?.getChildAsComponent(\".production_date_month\");\n    const timeEl = dateWrapper?.getChildAsComponent(\".input_card_description\");\n    const weekdayEl = card.getChildAsComponent(\"#cardPerformanceWeekday\");\n\n    const titleEl = card.getChildAsComponent(\"#cardPerformanceTitle\");\n    const prodTitleEl = card.getChildAsComponent(\n      \"#cardPerformanceProductionTitle\"\n    );\n    const descEl = card.getChildAsComponent(\"#cardPerformanceDescription\");\n    const imageEl = card.getChildAsComponent(\"#cardImage\");\n    const inputEl = card.getChildAsComponent(\".input_card_input\");\n    const labelEl = card.getChildAsComponent(\"label\");\n    const locEl = card.getChildAsComponent(\"#cardPerformanceLocation\");\n    const soldOutEl = card.getChildAsComponent(\"#performanceSoldOut\");\n\n    // -------------------------------------------------\n    // 3) Required structure only\n    // -------------------------------------------------\n    if (!inputEl || !labelEl || !titleEl) {\n      console.error(\"Required performance elements not found.\");\n      return;\n    }\n\n    // If id is invalid/null, hide the row (prevents crashes)\n    if (!hasValidId) {\n      console.warn(\"[PerformanceList] Skipping row with invalid id:\", perf);\n      rowElement.setStyle({ display: \"none\" });\n      return;\n    }\n\n    // -------------------------------------------------\n    // 4) Wire up the radio button (safe)\n    // -------------------------------------------------\n    const inputId = `performanceInput-${index}`;\n    inputEl.setAttribute(\"id\", inputId);\n    inputEl.setAttribute(\"value\", String(idNum));\n    labelEl.setAttribute(\"for\", inputId);\n\n    // -------------------------------------------------\n    // 5) Sold-out handling (safe ordering)\n    // -------------------------------------------------\n    if (soldOut) {\n      soldOutEl?.setStyle({ display: \"flex\" });\n\n      rowElement.setStyle({\n        pointerEvents: \"none\",\n        opacity: \"0.6\",\n      });\n\n      inputEl.setAttribute(\"disabled\", \"true\");\n    } else {\n      soldOutEl?.setStyle({ display: \"none\" });\n\n      // Attempt to ensure enabled when not sold out\n      // WFComponent doesn't expose removeAttribute, so do it safely via DOM:\n      try {\n        (inputEl.getElement() as HTMLInputElement).disabled = false;\n        (inputEl.getElement() as HTMLInputElement).removeAttribute(\"disabled\");\n      } catch {\n        // no-op\n      }\n    }\n\n    // -------------------------------------------------\n    // 6) Timezone-aware formatting in New York (guarded)\n    // -------------------------------------------------\n    const ts = Number(perf.Date_Time);\n    const date = Number.isFinite(ts) ? new Date(ts) : null;\n\n    dayEl?.setText(\n      date\n        ? date.toLocaleString(\"en-US\", {\n            day: \"numeric\",\n            timeZone: \"America/New_York\",\n          })\n        : \"\"\n    );\n\n    monthEl?.setText(\n      date\n        ? date.toLocaleString(\"en-US\", {\n            month: \"short\",\n            timeZone: \"America/New_York\",\n          })\n        : \"\"\n    );\n\n    weekdayEl?.setText(\n      date\n        ? date.toLocaleString(\"en-US\", {\n            weekday: \"long\",\n            timeZone: \"America/New_York\",\n          })\n        : \"\"\n    );\n\n    timeEl?.setText(\n      date\n        ? date.toLocaleTimeString(\"en-US\", {\n            hour: \"numeric\",\n            minute: \"2-digit\",\n            hour12: true,\n            timeZone: \"America/New_York\",\n          })\n        : \"\"\n    );\n\n    // -------------------------------------------------\n    // 7) Fill in the rest (safe defaults)\n    // -------------------------------------------------\n    titleEl.setText(safeTitle);\n\n    const selectedProd = getSelectedProduction();\n    prodTitleEl?.setText(selectedProd?.name || \"Unknown Production\");\n\n    descEl?.setText(safeDesc);\n\n    if (imageEl) {\n      if (safeImg) {\n        imageEl.setAttribute(\"src\", safeImg);\n        imageEl.setAttribute(\"alt\", safeTitle || \"Performance Image\");\n        imageEl.setStyle({ display: \"\" });\n      } else {\n        imageEl.setAttribute(\"src\", \"\");\n        imageEl.setStyle({ display: \"none\" });\n      }\n    }\n\n    locEl?.setText(safeVenue || \"Unknown venue\");\n\n    // -------------------------------------------------\n    // 8) Selection handler (safe strings)\n    // -------------------------------------------------\n    inputEl.on(\"change\", () => {\n      saveSelectedPerformance({\n        id: String(idNum),\n        name: safeTitle,\n        dateTime: String(perf.Date_Time ?? \"\"),\n        description: safeDesc,\n        imageUrl: safeImg,\n        location: safeVenue || \"\",\n      });\n    });\n\n    rowElement.setStyle({ display: \"flex\" });\n    return rowElement;\n  });\n\n  // -------------------------------------------------\n  // 9) Data load\n  // -------------------------------------------------\n  try {\n    list.changeLoadingStatus(true);\n\n    const prod = getSelectedProduction();\n    if (!prod?.id) throw new Error(\"No production selected\");\n\n    const performances = await fetchPerformances(prod.id.toString());\n\n    // Guard sort if Date_Time isn't strictly numeric\n    performances.sort((a: any, b: any) => {\n      const aTs = Number(a?.Date_Time);\n      const bTs = Number(b?.Date_Time);\n      if (!Number.isFinite(aTs) && !Number.isFinite(bTs)) return 0;\n      if (!Number.isFinite(aTs)) return 1;\n      if (!Number.isFinite(bTs)) return -1;\n      return aTs - bTs;\n    });\n\n    list.setData(performances);\n    if (performances.length) initializePerformanceFilter();\n\n    list.changeLoadingStatus(false);\n    return performances;\n  } catch (err) {\n    console.error(\"Error loading performances:\", err);\n    list.setData([]);\n    list.changeLoadingStatus(false);\n    return [];\n  }\n};\n","// src/api/performances.ts\nimport { apiClient } from \"./apiConfig\";\n\n/**\n * Details about the venue/location\n */\nexport interface LocationDetails {\n  id: number;\n  Name: string;\n  Slug: string;\n  Collection_ID: string;\n  Locale_ID: string;\n  Item_ID: string;\n  Created_On: string | null;\n  Updated_On: string | null;\n  Published_On: string | null;\n  Address_line_1: string;\n  City_state_zip: string;\n  Map_embed: string;\n  Location_Description: string;\n}\n\n/**\n * A single performance as returned by `/tickets/performances`.\n */\nexport interface Performance {\n  id: number;\n  Name: string;\n  Slug: string;\n  Collection_ID: string;\n  Locale_ID: string;\n  Item_ID: string;\n  Archived: boolean;\n  Draft: boolean;\n  Created_On: string;\n  Updated_On: string;\n  Published_On: string;\n  Displayed_Name: string;\n  Main_Image: string;\n  Short_Description: string;\n  Sold_Out: boolean;\n  /**\n   * Unixmillisecond timestamp\n   */\n  Date_Time: number;\n  Custom_Question: string;\n  Parent_Production: number;\n  ticket_tiers_offered: number[];\n  ticket_bundles_offered: number[];\n  Location: number;\n  location_details: LocationDetails;\n}\n\ninterface PerformanceApiResponse {\n  performances: Performance[];\n}\n\n/**\n * Fetch all performances for a given production.\n */\nexport const fetchPerformances = async (\n  productionId: string\n): Promise<Performance[]> => {\n  try {\n    const { performances } = await apiClient\n      .post<PerformanceApiResponse>(\"/tickets/performances\", {\n        data: { production_id: productionId },\n      })\n      .fetch();\n    return performances;\n  } catch (error) {\n    console.error(\"Error fetching performances:\", error);\n    throw error;\n  }\n};\n","export const initializePerformanceFilter = () => {\n  const locationSelectElement = document.getElementById(\"locationFilter\");\n  const monthSelectElement = document.getElementById(\"monthFilter\");\n\n  if (locationSelectElement) {\n    locationSelectElement.addEventListener(\"change\", () => {\n      applyFilters();\n    });\n  }\n\n  if (monthSelectElement) {\n    monthSelectElement.addEventListener(\"change\", () => {\n      applyFilters();\n    });\n  }\n};\n\nconst applyFilters = () => {\n  const locationSelectElement = document.getElementById(\n    \"locationFilter\"\n  ) as HTMLSelectElement;\n  const monthSelectElement = document.getElementById(\n    \"monthFilter\"\n  ) as HTMLSelectElement;\n\n  const selectedLocation = locationSelectElement?.value || \"N/A\";\n  const selectedMonth = monthSelectElement?.value || \"N/A\";\n\n  filterPerformances(selectedLocation, selectedMonth);\n};\n\nconst filterPerformances = (location: string, month: string) => {\n  const performanceCards = document.querySelectorAll(\".input_card_wrap\");\n  let hasVisibleItems = false;\n\n  performanceCards.forEach((performanceCard) => {\n    const performanceLocationElement = performanceCard.querySelector(\n      \"#cardPerformanceLocation\"\n    ) as HTMLElement;\n    const performanceLocation = performanceLocationElement?.textContent || \"\";\n\n    const performanceMonthElement = performanceCard.querySelector(\n      \".production_date_month\"\n    ) as HTMLElement;\n    const performanceMonth = performanceMonthElement?.textContent || \"\";\n\n    const matchesLocation =\n      location === \"N/A\" || performanceLocation === location;\n    const matchesMonth =\n      month === \"N/A\" || performanceMonth.toUpperCase() === month;\n\n    if (matchesLocation && matchesMonth) {\n      (performanceCard as HTMLElement).style.display = \"flex\";\n      hasVisibleItems = true;\n    } else {\n      (performanceCard as HTMLElement).style.display = \"none\";\n    }\n  });\n\n  // Handle empty state display\n  const emptyStateElement = document.getElementById(\"filterListEmpty\");\n  if (emptyStateElement) {\n    emptyStateElement.style.display = hasVisibleItems ? \"none\" : \"flex\";\n  }\n};\n","// src/modules/tickets/ticketTiers.ts\n\nimport { fetchTicketTiers } from \"../../api/ticketTiersAPI\";\nimport {\n  renderBundles,\n  renderTicketTiers,\n} from \"./components/ticketTierListRender\";\nimport { getSelectedPerformance } from \"./state/ticketPurchaseState\";\nimport { WFComponent } from \"@xatom/core\";\nimport { updateSelectedPerformanceUI } from \"./components/selectedPerformanceUI\";\nimport { updateCustomQuestion } from \"./components/customQuestionUI\";\nimport { initializeAssistanceInput } from \"./components/assistanceInputUI\";\nimport { initializeUserDetails } from \"./components/userDetailsUI\";\n\n/**\n * Initialize the bundles and ticket tiers UI for the selected performance.\n */\nexport const initializeTicketTiers = async (\n  bundleContainerSelector: string,\n  tierContainerSelector: string\n) => {\n  const selectedPerformance = getSelectedPerformance();\n\n  if (!selectedPerformance?.id) {\n    console.error(\"No performance selected.\");\n    return;\n  }\n\n  try {\n    // Fetch all ticket tier data for this performance\n    const ticketTierData = await fetchTicketTiers(selectedPerformance.id);\n\n    // Safely destructure API response shape (defaults prevent crashes)\n    const {\n      tickets_available = null,\n      performance_details = null,\n      bundles_available = null,\n    } = (ticketTierData ?? {}) as any;\n\n    // Guard: avoid `.flat()` on undefined/null\n    const rawBundlesOffered =\n      performance_details?.ticket_bundles_offered ?? [];\n    const rawTiersOffered = performance_details?.ticket_tiers_offered ?? [];\n\n    // Flatten safely (supports nested arrays, non-nested arrays, or missing)\n    const bundles = Array.isArray(rawBundlesOffered)\n      ? rawBundlesOffered.flat?.() ?? rawBundlesOffered\n      : [];\n\n    const tickets = Array.isArray(rawTiersOffered)\n      ? rawTiersOffered.flat?.() ?? rawTiersOffered\n      : [];\n\n    // Update selected performance UI\n    updateSelectedPerformanceUI();\n\n    // Initialize user details section\n    initializeUserDetails();\n\n    // Reset container visibility\n    const bundleContainer = new WFComponent(bundleContainerSelector);\n    bundleContainer.setStyle({ display: \"block\" });\n\n    const tierContainer = new WFComponent(tierContainerSelector);\n    tierContainer.setStyle({ display: \"block\" });\n\n    let hasBundlesOrTickets = false;\n\n    // Render bundle cards (pass bundles_available)\n    if (bundles.length > 0) {\n      renderBundles(bundles, bundleContainerSelector, bundles_available);\n      hasBundlesOrTickets = true;\n    } else {\n      bundleContainer.setStyle({ display: \"none\" });\n    }\n\n    // Render ticket tier cards with availability\n    if (tickets.length > 0) {\n      renderTicketTiers(tickets, tickets_available, tierContainerSelector);\n      hasBundlesOrTickets = true;\n    } else {\n      tierContainer.setStyle({ display: \"none\" });\n    }\n\n    // Toggle \"no tickets available\" message\n    const noTicketsElem = new WFComponent(\"#noTicketsAvailable\");\n    noTicketsElem.setStyle({ display: hasBundlesOrTickets ? \"none\" : \"flex\" });\n\n    // Show custom question (blank string fallback)\n    const customQuestion = performance_details?.Custom_Question ?? \"\";\n    updateCustomQuestion(customQuestion);\n\n    // Initialize assistance input UI\n    initializeAssistanceInput();\n  } catch (error) {\n    console.error(\"Error fetching ticket tiers:\", error);\n\n    // Optional: fail-safe empty-state UI so user isn't stuck\n    try {\n      const bundleContainer = new WFComponent(bundleContainerSelector);\n      bundleContainer.setStyle({ display: \"none\" });\n\n      const tierContainer = new WFComponent(tierContainerSelector);\n      tierContainer.setStyle({ display: \"none\" });\n\n      const noTicketsElem = new WFComponent(\"#noTicketsAvailable\");\n      noTicketsElem.setStyle({ display: \"flex\" });\n\n      updateCustomQuestion(\"\");\n    } catch {\n      // no-op (avoid masking original error)\n    }\n  }\n};\n","import { apiClient } from \"./apiConfig\";\nimport { Performance } from \"./performances\";\n\n/**\n * Availability record for each ticket tier\n */\nexport interface TicketTierAvailability {\n  id: number;\n  Parent_Performance: number;\n  Ticket_Tier: number;\n  Quantity_Available: number;\n  Reserved_Quantity: number;\n  Sold_Quantity: number;\n}\n\n/**\n * Bundle structure as returned in nested arrays\n */\nexport interface BundleOfferedFlat {\n  id: number;\n  Name: string;\n  Slug: string;\n  Collection_ID: string;\n  Locale_ID: string;\n  Item_ID: string;\n  Archived: boolean;\n  Draft: boolean;\n  Created_On: string;\n  Updated_On: string;\n  Published_On: string;\n  Displayed_Name: string;\n  Short_Description: string;\n  Product: number;\n\n  /** full product details for pricing display */\n  product_details: {\n    id: number;\n    Product_name: string;\n    category?: string;\n    Product_id?: string;\n    Single_sale_price_id: string;\n    Displayed_single_sale_price: string;\n    Single_sale_price_amount: number;\n  };\n}\n\n/**\n * Ticket tier structure as returned in nested arrays\n */\nexport interface TicketOfferedFlat {\n  id: number;\n  Name: string;\n  Slug: string;\n  Collection_ID: string;\n  Locale_ID: string;\n  Item_ID: string;\n  Archived: boolean;\n  Draft: boolean;\n  Created_On: string;\n  Updated_On: string;\n  Published_On: string;\n  Displayed_Name: string;\n  Short_Description: string;\n  Requires_Bundle_Purchase: boolean;\n  Product: number;\n\n  /** full product details for pricing display */\n  product_details: {\n    id: number;\n    Product_name: string;\n    category?: string;\n    Product_id?: string;\n    Single_sale_price_id: string;\n    Displayed_single_sale_price: string;\n    Single_sale_price_amount: number;\n  };\n}\n\n/**\n * Venue/location details\n */\nexport interface LocationDetails {\n  id: number;\n  Name: string;\n  Slug: string;\n  Collection_ID: string;\n  Locale_ID: string;\n  Item_ID: string;\n  Created_On: string | null;\n  Updated_On: string | null;\n  Published_On: string | null;\n  Address_line_1: string;\n  City_state_zip: string;\n  Map_embed: string;\n  Location_Description: string;\n}\n\n/**\n * Bundle availability calculated by Xano\n */\nexport interface BundleAvailability {\n  bundle_id: number;\n  bundle_name: string;\n  max_available: number;\n}\n\n/**\n * Full API response for ticket tiers step\n */\nexport interface TicketTiersApiResponse {\n  tickets_available: TicketTierAvailability[];\n  performance_details: Performance & {\n    ticket_tiers_offered: TicketOfferedFlat[][];\n    ticket_bundles_offered: BundleOfferedFlat[][];\n    Custom_Question: string;\n    Location: number;\n  };\n  location_details: LocationDetails;\n  bundles_available: BundleAvailability[];  // <-- added this\n}\n\n/**\n * Fetch ticket tiers (and availability, bundles, bundles & location) for a performance\n */\nexport const fetchTicketTiers = async (\n  selectedPerformanceId: string\n): Promise<TicketTiersApiResponse> => {\n  try {\n    const response = await apiClient\n      .post<TicketTiersApiResponse>(\"/tickets/ticket_tiers\", {\n        data: { selectedPerformanceId },\n      })\n      .fetch();\n    return response;\n  } catch (error) {\n    console.error(\"Error fetching ticket tiers:\", error);\n    throw error;\n  }\n};\n","import { renderBundles } from \"./bundleRenderer\";\nimport { renderTicketTiers } from \"./ticketTierRenderer\";\n\nexport { renderBundles, renderTicketTiers };\n","// src/modules/tickets/components/bundleRenderer.ts\n\nimport { WFDynamicList, WFComponent } from \"@xatom/core\";\nimport { BundleOfferedFlat } from \"../../../api/ticketTiersAPI\";\nimport {\n  saveSelectedBundle,\n  removeSelectedBundle,\n} from \"../state/ticketPurchaseState\";\nimport {\n  resetTicketQuantitiesIfNeeded,\n  updateTicketTierButtons,\n} from \"../state/bundleStateUpdater\";\nimport { revalidateTicketTierQuantities } from \"./ticketTierRenderer\";\nimport { toggleError } from \"../../../utils/formUtils\";\n\n// Availability info passed in from API\nexport interface BundleAvailability {\n  bundle_id: number;\n  bundle_name: string;\n  max_available: number;\n}\n\nlet initialBundleTemplate: HTMLElement | null = null;\n\n/**\n * Renders bundle selection cards and enforces max purchase limits.\n */\nexport const renderBundles = (\n  bundles: BundleOfferedFlat[],\n  containerSelector: string,\n  bundlesAvailable: BundleAvailability[] = []\n) => {\n  const container = document.querySelector(containerSelector);\n  if (!container) {\n    console.error(\"Bundle list container not found.\");\n    return;\n  }\n\n  // Keep a pristine copy of the template\n  if (!initialBundleTemplate) {\n    initialBundleTemplate = container.cloneNode(true) as HTMLElement;\n  }\n  container.innerHTML = \"\";\n  container.appendChild(initialBundleTemplate.cloneNode(true));\n\n  const clearNoTicketsError = () => {\n    const noTicketsError = new WFComponent(\"#noTicketsError\");\n    toggleError(noTicketsError, \"\", false);\n  };\n\n  const list = new WFDynamicList<BundleOfferedFlat>(containerSelector, {\n    rowSelector: \"#bundleCard\",\n    loaderSelector: \"#bundleListLoading\",\n    emptySelector: \"#bundleListEmpty\",\n  });\n\n  list.loaderRenderer(loader => {\n    loader.getElement().style.display = \"flex\";\n    return loader;\n  });\n\n  list.emptyRenderer(empty => {\n    empty.getElement().style.display = \"flex\";\n    return empty;\n  });\n\n  list.rowRenderer(({ rowData, rowElement }) => {\n    const bundleCard = new WFComponent(rowElement);\n    const bundlePrice = bundleCard.getChildAsComponent(\"#bundlePrice\");\n    const bundleName = bundleCard.getChildAsComponent(\"#bundleName\");\n    const bundleDescription = bundleCard.getChildAsComponent(\"#bundleDescription\");\n    const bundleQuantityInput = bundleCard.getChildAsComponent(\"#bundleQuantityInput\");\n    const bundleIncrementButton = bundleCard.getChildAsComponent(\"#bundleQuantityIncrease\");\n    const bundleDecrementButton = bundleCard.getChildAsComponent(\"#bundleQuantityDecrease\");\n    const bundleMaxAlert = bundleCard.getChildAsComponent(\".maximum_alert\");\n    const bundleSoldOut = bundleCard.getChildAsComponent(\"#bundleSoldOut\");\n    const numberInputWrapper = bundleCard.getChildAsComponent(\".number_input_wrapper\");\n\n    if (\n      !bundlePrice ||\n      !bundleName ||\n      !bundleDescription ||\n      !bundleQuantityInput ||\n      !bundleIncrementButton ||\n      !bundleDecrementButton ||\n      !bundleMaxAlert ||\n      !bundleSoldOut ||\n      !numberInputWrapper\n    ) {\n      console.error(\"Bundle elements not found.\");\n      return;\n    }\n\n    // Display price\n    bundlePrice.setText(rowData.product_details.Displayed_single_sale_price);\n    // Populate text\n    bundleName.setText(rowData.Displayed_Name);\n    bundleDescription.setText(rowData.Short_Description);\n    bundleQuantityInput.setAttribute(\"value\", \"0\");\n\n    // Lookup this bundle's max availability\nconst availability = bundlesAvailable.find(b => b.bundle_id === rowData.id);\nconst maxQty = availability ? availability.max_available : Infinity;\n\n// If none available, show Sold out and disable input\nif (maxQty <= 0) {\n  bundleSoldOut.setText(\"Sold out\");\n  bundleSoldOut.getElement().style.display = \"block\";\n  numberInputWrapper.addCssClass(\"is-disabled\");\n} else {\n  bundleSoldOut.getElement().style.display = \"none\";\n  numberInputWrapper.removeCssClass(\"is-disabled\");\n}\n\n// Seed the input's max for native clamping\nbundleQuantityInput.setAttribute(\"max\", maxQty.toString());\n\n    const hideAlert = () => bundleMaxAlert.getElement().style.display = \"none\";\n    const showAlert = (msg: string) => {\n      bundleMaxAlert.setText(msg);\n      bundleMaxAlert.getElement().style.display = \"block\";\n    };\n\n    // Increment logic with max guard\n    bundleIncrementButton.on(\"click\", () => {\n      const inputEl = bundleQuantityInput.getElement() as HTMLInputElement;\n      let current = Number(inputEl.value);\n      if (current < maxQty) {\n        current += 1;\n        inputEl.value = String(current);\n        saveSelectedBundle(rowData.id.toString(), current);\n        updateTicketTierButtons();\n        clearNoTicketsError();\n        hideAlert();\n        resetTicketQuantitiesIfNeeded();\n        revalidateTicketTierQuantities();\n      } else {\n        showAlert(`Only up to ${maxQty} bundles available.`);\n      }\n    });\n\n    // Decrement logic\n    bundleDecrementButton.on(\"click\", () => {\n      const inputEl = bundleQuantityInput.getElement() as HTMLInputElement;\n      let current = Number(inputEl.value);\n      if (current > 0) {\n        current -= 1;\n        inputEl.value = String(current);\n        if (current > 0) {\n          saveSelectedBundle(rowData.id.toString(), current);\n        } else {\n          removeSelectedBundle(rowData.id.toString());\n        }\n        updateTicketTierButtons();\n        clearNoTicketsError();\n        hideAlert();\n        resetTicketQuantitiesIfNeeded();\n        revalidateTicketTierQuantities();\n      }\n    });\n\n    // Manual input guard\n    bundleQuantityInput.on(\"input\", () => {\n      clearNoTicketsError();\n      const inputEl = bundleQuantityInput.getElement() as HTMLInputElement;\n      let val = Number(inputEl.value);\n      if (val > maxQty) {\n        inputEl.value = String(maxQty);\n        showAlert(`Only up to ${maxQty} bundles available.`);\n      } else {\n        hideAlert();\n      }\n      resetTicketQuantitiesIfNeeded();\n      revalidateTicketTierQuantities();\n    });\n\n    // Show the card\n    rowElement.setStyle({ display: \"flex\" });\n    return rowElement;\n  });\n\n  // Render all\n  list.setData(bundles);\n};","import {\n  getSelectedBundles,\n  getSelectedTickets,\n  removeSelectedTicket,\n} from \"../state/ticketPurchaseState\";\n\n// Utility function to safely convert unknown types to number\nconst safeNumber = (value: unknown): number =>\n  typeof value === \"number\" ? value : 0;\n\nexport const resetTicketQuantitiesIfNeeded = () => {\n  const selectedBundles = getSelectedBundles();\n  const totalBundlesSelected = selectedBundles.reduce(\n    (sum, bundle) => sum + safeNumber(bundle.quantity),\n    0\n  );\n\n  const selectedTickets = getSelectedTickets();\n  selectedTickets.forEach((ticket) => {\n    const ticketElement = document.querySelector(\n      `#ticketTierCard[data-id=\"${ticket.ticket_tier_id}\"] #ticketTierQuantityInput`\n    ) as HTMLInputElement;\n\n    if (!ticketElement) return;\n\n    if (ticket.bundle_required && totalBundlesSelected <= 0) {\n      ticketElement.value = \"0\";\n      removeSelectedTicket(ticket.ticket_tier_id);\n    }\n  });\n\n  console.log(\"Updated selectedTickets:\", getSelectedTickets());\n};\n\nexport const updateTicketTierButtons = () => {\n  const selectedBundles = getSelectedBundles();\n  const totalBundlesSelected = selectedBundles.reduce(\n    (sum, bundle) => sum + safeNumber(bundle.quantity),\n    0\n  );\n\n  const ticketTierInputs = document.querySelectorAll<HTMLInputElement>(\n    \"#ticketTierQuantityInput\"\n  );\n  const ticketTierIncrementButtons =\n    document.querySelectorAll<HTMLButtonElement>(\"#ticketTierQuantityIncrease\");\n\n  ticketTierInputs.forEach((input) => {\n    const ticketCard = input.closest(\"#ticketTierCard\");\n    const requiresBundle =\n      ticketCard?.getAttribute(\"data-requires-bundle\") === \"true\";\n\n    if (requiresBundle && totalBundlesSelected <= 0) {\n      input.setAttribute(\"disabled\", \"true\");\n      input.value = \"0\";\n    } else {\n      input.removeAttribute(\"disabled\");\n    }\n  });\n\n  ticketTierIncrementButtons.forEach((button) => {\n    const ticketCard = button.closest(\"#ticketTierCard\");\n    const requiresBundle =\n      ticketCard?.getAttribute(\"data-requires-bundle\") === \"true\";\n\n    if (requiresBundle && totalBundlesSelected <= 0) {\n      button.setAttribute(\"disabled\", \"true\");\n    } else {\n      button.removeAttribute(\"disabled\");\n    }\n  });\n\n  resetTicketQuantitiesIfNeeded();\n};\n","import { WFComponent, WFDynamicList } from \"@xatom/core\";\nimport {\n  TicketOfferedFlat,\n  TicketTierAvailability,\n} from \"../../../api/ticketTiersAPI\";\nimport {\n  saveSelectedTicket,\n  removeSelectedTicket,\n  getSelectedBundles,\n} from \"../state/ticketPurchaseState\";\nimport { toggleError } from \"../../../utils/formUtils\";\n\nconst safeNumber = (value: unknown): number =>\n  typeof value === \"number\" ? value : 0;\n\nconst clearNoTicketsError = () => {\n  const noTicketsError = new WFComponent(\"#noTicketsError\");\n  toggleError(noTicketsError, \"\", false);\n};\n\nlet initialTicketTierTemplate: HTMLElement | null = null;\n\nexport const revalidateTicketTierQuantities = () => {\n  const cards = document.querySelectorAll(\n    \"[data-requires-bundle='true']\"\n  );\n  cards.forEach((card) => {\n    const maxAlert = new WFComponent(card.querySelector(\".maximum_alert\"));\n    const qtyInput = new WFComponent(\n      card.querySelector(\"#ticketTierQuantityInput\")\n    );\n    const selectedBundles = getSelectedBundles();\n    const totalBundles = selectedBundles.reduce(\n      (sum, b) => sum + safeNumber(b.quantity),\n      0\n    );\n    if (totalBundles <= 0) {\n      (qtyInput.getElement() as HTMLInputElement).value = \"0\";\n      maxAlert.setText(\n        \"This item requires a ticket bundle purchase. Please add a ticket bundle from the options above.\"\n      );\n      (maxAlert.getElement() as HTMLElement).style.display = \"block\";\n    } else {\n      (maxAlert.getElement() as HTMLElement).style.display = \"none\";\n    }\n  });\n};\n\nexport const renderTicketTiers = (\n  tickets: TicketOfferedFlat[],\n  availabilities: TicketTierAvailability[],\n  containerSelector: string\n) => {\n  // Build availability lookup\n  const availabilityMap = new Map<number, number>();\n  availabilities.forEach((rec) => {\n    availabilityMap.set(rec.Ticket_Tier, rec.Quantity_Available);\n  });\n\n  const container = document.querySelector(containerSelector);\n  if (!container) {\n    console.error(\"Ticket tier list container not found.\");\n    return;\n  }\n\n  if (!initialTicketTierTemplate) {\n    initialTicketTierTemplate = container.cloneNode(true) as HTMLElement;\n  }\n  container.innerHTML = \"\";\n  container.appendChild(initialTicketTierTemplate.cloneNode(true));\n\n  const list = new WFDynamicList<TicketOfferedFlat>(containerSelector, {\n    rowSelector: \"#ticketTierCard\",\n    loaderSelector: \"#ticketTierListLoading\",\n    emptySelector: \"#ticketTierListEmpty\",\n  });\n\n  list.loaderRenderer((loader) => {\n    (loader.getElement() as HTMLElement).style.display = \"flex\";\n    return loader;\n  });\n  list.emptyRenderer((empty) => {\n    (empty.getElement() as HTMLElement).style.display = \"flex\";\n    return empty;\n  });\n\n  list.rowRenderer(({ rowData, rowElement }) => {\n    const card = new WFComponent(rowElement);\n    const requiresBundle = rowData.Requires_Bundle_Purchase;\n    rowElement.setAttribute(\n      \"data-requires-bundle\",\n      requiresBundle ? \"true\" : \"false\"\n    );\n\n    const nameEl = card.getChildAsComponent(\"#ticketTierName\");\n    const priceEl = card.getChildAsComponent(\"#ticketTierPrice\");\n    const soldOutEl = card.getChildAsComponent(\"#ticketTierSoldOut\");\n    const descEl = card.getChildAsComponent(\"#ticketTierDescription\");\n    const qtyInput = card.getChildAsComponent(\"#ticketTierQuantityInput\");\n    const incBtn = card.getChildAsComponent(\"#ticketTierQuantityIncrease\");\n    const decBtn = card.getChildAsComponent(\"#ticketTierQuantityDecrease\");\n    const maxAlert = card.getChildAsComponent(\".maximum_alert\");\n    const wrapper = card.getChildAsComponent(\".number_input_wrapper\");\n\n    if (\n      !nameEl ||\n      !priceEl ||\n      !soldOutEl ||\n      !descEl ||\n      !qtyInput ||\n      !incBtn ||\n      !decBtn ||\n      !maxAlert ||\n      !wrapper\n    ) {\n      console.error(\"Ticket tier elements not found.\");\n      return;\n    }\n\n    // Availability for this tier\n    const available = availabilityMap.get(rowData.id) ?? 0;\n\n    // Populate UI\n    nameEl.setText(rowData.Displayed_Name);\n    // show the formatted price from product_details\n    priceEl.setText(rowData.product_details.Displayed_single_sale_price);\n    descEl.setText(rowData.Short_Description);\n\n    // enforce stock limit in the quantity input\n    qtyInput.setAttribute(\"max\", String(available));\n    qtyInput.setAttribute(\"value\", \"0\");\n\n    if (available <= 0) {\n      soldOutEl.setText(\"Sold out\");\n      (soldOutEl.getElement() as HTMLElement).style.display = \"block\";\n      wrapper.addCssClass(\"is-disabled\");\n    } else {\n      (soldOutEl.getElement() as HTMLElement).style.display = \"none\";\n      wrapper.removeCssClass(\"is-disabled\");\n    }\n\n    const updateAlertVisibility = (message: string) => {\n      maxAlert.setText(message);\n      (maxAlert.getElement() as HTMLElement).style.display = \"block\";\n    };\n\n    // Increment handler\n    incBtn.on(\"click\", () => {\n      const inputEl = qtyInput.getElement() as HTMLInputElement;\n      let current = Number(inputEl.value);\n\n      // bundle-required guard\n      if (requiresBundle) {\n        const totalBundles = getSelectedBundles().reduce(\n          (sum, b) => sum + safeNumber(b.quantity),\n          0\n        );\n        if (totalBundles <= 0) {\n          updateAlertVisibility(\n            \"This item requires a ticket bundle purchase. Please add a ticket bundle from the options above.\"\n          );\n          return;\n        }\n      }\n\n      if (current < available) {\n        current++;\n        inputEl.value = String(current);\n        saveSelectedTicket(rowData.id.toString(), current, requiresBundle);\n        clearNoTicketsError();\n        revalidateTicketTierQuantities();\n      } else {\n        updateAlertVisibility(\n          \"You have reached the maximum available quantity.\"\n        );\n      }\n    });\n\n    // Decrement handler\n    decBtn.on(\"click\", () => {\n      const inputEl = qtyInput.getElement() as HTMLInputElement;\n      let current = Number(inputEl.value);\n      if (current > 0) {\n        current--;\n        inputEl.value = String(current);\n        if (current > 0) {\n          saveSelectedTicket(rowData.id.toString(), current, requiresBundle);\n        } else {\n          removeSelectedTicket(rowData.id.toString());\n        }\n        clearNoTicketsError();\n        revalidateTicketTierQuantities();\n      }\n    });\n\n    // Manual input handler\n    qtyInput.on(\"input\", () => {\n      clearNoTicketsError();\n      const inputEl = qtyInput.getElement() as HTMLInputElement;\n      let val = Number(inputEl.value);\n      if (val > available) {\n        inputEl.value = String(available);\n        updateAlertVisibility(\n          \"You have reached the maximum available quantity.\"\n        );\n      }\n      revalidateTicketTierQuantities();\n    });\n\n    rowElement.setStyle({ display: \"flex\" });\n    return rowElement;\n  });\n\n  list.setData(tickets);\n};\n","import { WFComponent } from \"@xatom/core\";\nimport { WFImage } from \"@xatom/image\";\nimport { apiClient } from \"../api/apiConfig\";\nimport { userAuth } from \"../auth/authConfig\";\n\nexport function toggleError(\n  errorMessageComponent: WFComponent<any>,\n  message: string,\n  show: boolean\n): void {\n  errorMessageComponent.updateTextViaAttrVar({ text: show ? message : \"\" });\n  errorMessageComponent.setStyle({ display: show ? \"flex\" : \"none\" });\n}\n\nexport function setupValidation(\n  inputComponent: WFComponent,\n  errorComponent: WFComponent,\n  validate: () => string,\n  requestErrorComponent?: WFComponent // Optional component to clear on input change\n) {\n  const validateAndUpdate = () => {\n    const errorMessage = validate();\n    toggleError(errorComponent, errorMessage, !!errorMessage);\n    if (requestErrorComponent && errorMessage === \"\") {\n      // Clear request error message when the user is correcting the input\n      toggleError(requestErrorComponent, \"\", false);\n    }\n  };\n\n  // Attach event listeners for real-time validation\n  inputComponent.on(\"input\", validateAndUpdate);\n  inputComponent.on(\"blur\", validateAndUpdate);\n  inputComponent.on(\"change\", validateAndUpdate);\n}\n\nexport function createValidationFunction(\n  inputComponent: WFComponent,\n  validationFn: (input: string) => boolean,\n  errorMessage: string\n): () => string {\n  return () => {\n    const inputElement = inputComponent.getElement() as HTMLInputElement;\n    const isValid = validationFn(inputElement.value);\n    return isValid ? \"\" : errorMessage;\n  };\n}\n\nexport function createCheckboxValidationFunction(\n  checkboxComponent: WFComponent,\n  errorMessage: string\n): () => string {\n  return () => {\n    const checkbox = checkboxComponent.getElement() as HTMLInputElement;\n    return checkbox.checked ? \"\" : errorMessage;\n  };\n}\n\nexport function setupCheckboxValidation(\n  checkboxComponent: WFComponent,\n  checkboxErrorComponent: WFComponent,\n  errorMessage: string\n) {\n  const validate = createCheckboxValidationFunction(\n    checkboxComponent,\n    errorMessage\n  );\n  setupValidation(checkboxComponent, checkboxErrorComponent, validate);\n}\n\nexport function validateSelectedSessions(\n  selectedSessions: { sessionId: string; studentIds: string[] }[],\n  errorMessageComponent: WFComponent<any>,\n  errorMessage: string\n): boolean {\n  const isValid =\n    selectedSessions.length > 0 &&\n    selectedSessions.some((session) => session.studentIds.length > 0);\n\n  if (!isValid) {\n    toggleError(errorMessageComponent, errorMessage, true);\n  } else {\n    toggleError(errorMessageComponent, \"\", false);\n  }\n\n  return isValid;\n}\n\ntype fileUploadResponse = {\n  status: string;\n  url: {\n    profile_pic: {\n      url: string;\n    };\n  };\n};\n\n/**\n * Updates the user's profile picture URL in the authentication system.\n * @param {string} imageUrl - The URL of the uploaded image.\n */\nexport function setProfilePicUrl(imageUrl: string): void {\n  const user = userAuth.getUser();\n  if (user && user.profile) {\n    // Ensure the profile_picture object exists\n    user.profile.profile_pic = user.profile.profile_pic || { url: \"\" };\n\n    // Set the profile picture URL\n    user.profile.profile_pic.url = imageUrl;\n    userAuth.setUser(user);\n    localStorage.setItem(\"auth_user\", JSON.stringify(user));\n  }\n}\n\n/**\n * Handles file upload and displays the uploaded image.\n * @param {WFComponent} fileInput - The WFComponent instance for the file input field.\n * @param {WFComponent} fileInputError - The WFComponent instance for displaying error messages.\n * @param {WFComponent} fileInputSuccess - The WFComponent instance for displaying success messages.\n * @param {string} uploadEndpoint - The endpoint to which the file is sent.\n * @returns {Promise<string>} A promise that resolves with the URL of the uploaded image.\n */\n/**\n * Handles file upload and displays the uploaded image.\n * Only JPEG files less than 2 MB can be uploaded.\n * @param {WFComponent} fileInput - The WFComponent instance for the file input field.\n * @param {WFComponent} fileInputError - The WFComponent instance for displaying error messages.\n * @param {WFComponent} fileInputSuccess - The WFComponent instance for displaying success messages.\n * @param {string} uploadEndpoint - The endpoint to which the file is sent.\n * @returns {Promise<string>} A promise that resolves with the URL of the uploaded image.\n */\nexport function setupFileUpload(\n  fileInput: WFComponent,\n  fileInputError: WFComponent,\n  fileInputSuccess: WFComponent,\n  uploadEndpoint: string\n): Promise<string> {\n  const profilePictureImage = new WFImage(\"#profilePictureImage\");\n  const uploadAnimation = new WFComponent(\"#uploadAnimation\");\n\n  const overlay = new WFComponent(\".drop-zone\");\n  let dragCounter = 0;\n\n  return new Promise<string>((resolve) => {\n    const handleFile = (file: File) => {\n      // Validate file type and size\n      const validTypes = [\"image/jpeg\", \"image/jpg\"];\n      const maxSizeInBytes = 2 * 1024 * 1024; // 2 MB\n\n      if (\n        !validTypes.includes(file.type) &&\n        !/\\.(jpg|jpeg)$/i.test(file.name)\n      ) {\n        const errorMessage = \"Only JPEG images are allowed.\";\n        toggleError(fileInputError, errorMessage, true);\n        // Reset file input value\n        (fileInput.getElement() as HTMLInputElement).value = \"\";\n        return;\n      }\n\n      if (file.size > maxSizeInBytes) {\n        const errorMessage = \"File size must be less than 2 MB.\";\n        toggleError(fileInputError, errorMessage, true);\n        // Reset file input value\n        (fileInput.getElement() as HTMLInputElement).value = \"\";\n        return;\n      }\n\n      // Show upload animation immediately\n      uploadAnimation.setStyle({ display: \"flex\" });\n\n      // Hide error and success messages\n      fileInputError.setStyle({ display: \"none\" });\n      fileInputSuccess.setStyle({ display: \"none\" });\n\n      const reader = new FileReader();\n\n      // Display preview image as soon as the file is loaded into memory\n      reader.onload = (event) => {\n        // Set the preview image for the profile picture\n        const result = event.target?.result as string;\n        profilePictureImage.setImage(result);\n\n        // Hide overlay once the image is set\n        overlay.setStyle({ display: \"none\" });\n      };\n\n      reader.readAsDataURL(file);\n\n      const formData = new FormData();\n      formData.append(\"profile_picture\", file);\n\n      const existingStudent = localStorage.getItem(\"current_student\");\n      if (existingStudent) {\n        const student = JSON.parse(existingStudent);\n        formData.append(\"student_profile_id\", student.id.toString());\n      }\n\n      // Send the file to the server\n      const postRequest = apiClient.post<fileUploadResponse>(uploadEndpoint, {\n        data: formData,\n      });\n\n      postRequest.onData((response) => {\n        if (response.status === \"success\") {\n          const imageUrl = response.url.profile_pic.url;\n\n          // Update the profile picture URL in the user session and local storage\n          setProfilePicUrl(imageUrl);\n\n          // Update the image for other parts of the UI as well\n          profilePictureImage.setImage(imageUrl);\n\n          // Store the URL in local storage\n          localStorage.setItem(\"image_upload\", imageUrl);\n\n          // Show success message and hide upload animation\n          fileInputSuccess.setStyle({ display: \"flex\" });\n          uploadAnimation.setStyle({ display: \"none\" });\n\n          // Resolve with the uploaded image URL\n          resolve(imageUrl);\n        } else {\n          const errorMessage = \"Failed to upload profile picture.\";\n          toggleError(fileInputError, errorMessage, true);\n          uploadAnimation.setStyle({ display: \"none\" });\n          overlay.setStyle({ display: \"none\" });\n          dragCounter = 0;\n          // Reset file input value\n          (fileInput.getElement() as HTMLInputElement).value = \"\";\n        }\n      });\n\n      postRequest.onError((error) => {\n        let errorMessage = \"An error occurred during image upload.\";\n        if (error.response && error.response.data) {\n          errorMessage = error.response.data.message || errorMessage;\n        } else if (error.message) {\n          errorMessage = error.message;\n        }\n\n        // Show error message and hide upload animation\n        toggleError(fileInputError, errorMessage, true);\n        uploadAnimation.setStyle({ display: \"none\" });\n        overlay.setStyle({ display: \"none\" });\n        dragCounter = 0;\n        // Reset file input value\n        (fileInput.getElement() as HTMLInputElement).value = \"\";\n      });\n\n      // Make the API call\n      postRequest.fetch();\n    };\n\n    // Event listener for file input changes\n    fileInput.on(\"change\", () => {\n      const file = (fileInput.getElement() as HTMLInputElement).files?.[0];\n      if (file) {\n        handleFile(file);\n      }\n    });\n\n    // Event listeners for drag-and-drop\n    const dragZoneElement = document.body;\n    dragZoneElement.addEventListener(\"dragenter\", (event) => {\n      event.preventDefault();\n      dragCounter++;\n      if (dragCounter === 1) {\n        overlay.setStyle({ display: \"flex\" });\n      }\n    });\n\n    dragZoneElement.addEventListener(\"dragleave\", () => {\n      dragCounter--;\n      if (dragCounter <= 0) {\n        overlay.setStyle({ display: \"none\" });\n        dragCounter = 0;\n      }\n    });\n\n    dragZoneElement.addEventListener(\"dragover\", (event) => {\n      event.preventDefault();\n    });\n\n    dragZoneElement.addEventListener(\"drop\", (event) => {\n      event.preventDefault();\n\n      const files = event.dataTransfer?.files;\n      if (files?.length) {\n        handleFile(files[0]);\n      }\n\n      overlay.setStyle({ display: \"none\" });\n      dragCounter = 0;\n    });\n  });\n}\n\n// src/utils/formUtils.ts\n\n/**\n * Formats a phone number string to the format (xxx) xxx-xxxx.\n * If the input contains more than 10 digits, it truncates the extra digits.\n * If it contains fewer, it formats as much as possible.\n *\n * @param value - The raw phone number string.\n * @returns The formatted phone number string.\n */\nexport const formatPhoneNumber = (value: string): string => {\n  const cleaned = value.replace(/\\D/g, \"\"); // Remove all non-digit characters\n\n  if (cleaned.length <= 3) {\n    return cleaned;\n  } else if (cleaned.length <= 6) {\n    return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3)}`;\n  } else if (cleaned.length <= 10) {\n    return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3, 6)}-${cleaned.slice(\n      6\n    )}`;\n  } else {\n    // If more than 10 digits, truncate the extra digits\n    return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3, 6)}-${cleaned.slice(\n      6,\n      10\n    )}`;\n  }\n};\n","var t=require(\"@xatom/core\");var e,r,s,i,o,n,u={};e=u,r=\"WFImage\",s=()=>c,Object.defineProperty(e,r,{get:s,set:i,enumerable:!0,configurable:!0});class c extends t.WFComponent{constructor(t){super(t)}getImageConfig(){return this._config}getSrc(){return this.getAttribute(\"src\")}getSizes(){return this.getAttribute(\"sizes\")}getSrcSet(){return this.getAttribute(\"srcset\")}getLoading(){return this.getAttribute(\"loading\")}onLoad(t){return this.on(\"load\",t),()=>{this.off(\"load\",t)}}onLoadError(t){return this.on(\"error\",t),()=>{this.off(\"error\",t)}}setImage(t){if(\"string\"==typeof t)this.setAttribute(\"src\",t),this.removeAttribute(\"srcset\"),this.removeAttribute(\"sizes\");else{if(this.setAttribute(\"src\",t.src),\"object\"==typeof t&&t.srcSet&&t.srcSet.length&&t.sizes&&t.sizes.length){const e=t.srcSet.map((t=>`${t.url} ${t.size}`)).join(\", \");this.setAttribute(\"srcset\",e)}else this.removeAttribute(\"srcset\"),this.removeAttribute(\"sizes\");t.loading&&this.setAttribute(\"loading\",t.loading)}}}o=module.exports,n=u,Object.keys(n).forEach((function(t){\"default\"===t||\"__esModule\"===t||o.hasOwnProperty(t)||Object.defineProperty(o,t,{enumerable:!0,get:function(){return n[t]}})}));","import { WFComponent } from \"@xatom/core\";\nimport {\n  getSelectedPerformance,\n  getSelectedProduction,\n} from \"../state/ticketPurchaseState\";\n\nexport const updateSelectedPerformanceUI = () => {\n  const selectedPerformance = getSelectedPerformance();\n  const selectedProduction = getSelectedProduction();\n\n  if (!selectedPerformance || !selectedPerformance.id) {\n    console.error(\"No performance selected.\");\n    return;\n  }\n\n  // pick up your DOM nodes\n  const selectedPerformanceDate = new WFComponent(\"#selectedPerformanceDate\");\n  const selectedPerformanceMonth = new WFComponent(\"#selectedPerformanceMonth\");\n  const selectedWeekday = new WFComponent(\"#selectedWeekday\");\n  const selectedTime = new WFComponent(\"#selectedTime\");\n  const selectedPerformanceTitle = new WFComponent(\"#selectedPerformanceTitle\");\n  const selectedPerformanceProductionTitle = new WFComponent(\n    \"#selectedPerformanceProductionTitle\"\n  );\n  const selectedPerformanceDescription = new WFComponent(\n    \"#selectedPerformanceDescription\"\n  );\n  const selectedImage = new WFComponent(\"#selectedImage\");\n  const selectedPerformanceLocation = new WFComponent(\n    \"#selectedPerformanceLocation\"\n  );\n\n  // dateTime might be an ISO string or a millisecondtimestamp string\n  const raw = selectedPerformance.dateTime;\n  let date: Date;\n  if (/^\\d+$/.test(raw)) {\n    date = new Date(Number(raw));\n  } else {\n    date = new Date(raw);\n  }\n\n  // formatting options for New York\n  const optionsCommon = { timeZone: \"America/New_York\" } as const;\n\n  // render date parts in Eastern Time\n  selectedPerformanceDate.setText(\n    date.toLocaleString(\"en-US\", { ...optionsCommon, day: \"numeric\" })\n  );\n  selectedPerformanceMonth.setText(\n    date.toLocaleString(\"en-US\", { ...optionsCommon, month: \"short\" })\n  );\n  selectedWeekday.setText(\n    date.toLocaleString(\"en-US\", { ...optionsCommon, weekday: \"long\" })\n  );\n  selectedTime.setText(\n    date.toLocaleTimeString(\"en-US\", {\n      ...optionsCommon,\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      hour12: true,\n    })\n  );\n\n  selectedPerformanceTitle.setText(selectedPerformance.name);\n  selectedPerformanceProductionTitle.setText(selectedProduction.name);\n  selectedPerformanceDescription.setText(selectedProduction.description);\n\n  if (selectedPerformance.imageUrl) {\n    selectedImage.setAttribute(\"src\", selectedPerformance.imageUrl);\n    selectedImage.setAttribute(\"alt\", selectedPerformance.name);\n  }\n\n  // now display the human-readable venue name saved in state\n  if (selectedPerformance.location) {\n    selectedPerformanceLocation.setText(selectedPerformance.location);\n  } else {\n    selectedPerformanceLocation.setText(\"Location not specified\");\n  }\n};\n","import { WFComponent } from \"@xatom/core\";\nimport { saveCustomQuestion } from \"../state/ticketPurchaseState\";\n\nexport const updateCustomQuestion = (questionText: string) => {\n  const wrapper = new WFComponent(\"#customQuestionWrap\");\n  const divider = new WFComponent(\"#customQuestionDivider\");\n  const label = new WFComponent(\"label[for='customQuestionInput']\");\n  const input = new WFComponent(\"#customQuestionInput\");\n\n  if (!questionText) {\n    wrapper.setStyle({ display: \"none\" });\n    divider.setStyle({ display: \"none\" });\n    return;\n  }\n\n  wrapper.setStyle({ display: \"\" });\n  divider.setStyle({ display: \"\" });\n\n  // Set the label text inside the wrapper\n  label.setText(questionText);\n\n  // Wire up input save\n  input.on(\"input\", () => {\n    const answer = (input.getElement() as HTMLInputElement).value;\n    saveCustomQuestion(answer);\n  });\n};\n","import { WFComponent } from \"@xatom/core\";\nimport {\n  saveAssistanceNeeded,\n  saveAssistanceMessage,\n} from \"../state/ticketPurchaseState\";\n\nexport const initializeAssistanceInput = () => {\n  const assistanceInput = new WFComponent(\"#assistanceInput\");\n  const hiddenAssistanceWrapper = new WFComponent(\"#hiddenAssistanceWrapper\");\n  const assistanceMessageInput = new WFComponent(\"#assistanceMessageInput\");\n\n  if (!assistanceInput || !hiddenAssistanceWrapper || !assistanceMessageInput) {\n    console.error(\"Assistance input or hidden wrapper elements not found.\");\n    return;\n  }\n\n  // Initialize state based on current input values\n  const isChecked = (assistanceInput.getElement() as HTMLInputElement).checked;\n  saveAssistanceNeeded(isChecked);\n\n  if (isChecked) {\n    hiddenAssistanceWrapper.removeCssClass(\"g-hide\");\n    const assistanceMessage = (\n      assistanceMessageInput.getElement() as HTMLTextAreaElement\n    ).value;\n    saveAssistanceMessage(assistanceMessage);\n  } else {\n    hiddenAssistanceWrapper.addCssClass(\"g-hide\");\n    saveAssistanceMessage(\"\"); // Clear the message in the state if hidden\n  }\n\n  assistanceInput.on(\"change\", () => {\n    const isChecked = (assistanceInput.getElement() as HTMLInputElement)\n      .checked;\n\n    if (isChecked) {\n      hiddenAssistanceWrapper.removeCssClass(\"g-hide\");\n    } else {\n      hiddenAssistanceWrapper.addCssClass(\"g-hide\");\n      (assistanceMessageInput.getElement() as HTMLTextAreaElement).value = \"\"; // Clear the input when hidden\n      saveAssistanceMessage(\"\"); // Clear the message in the state if hidden\n    }\n\n    saveAssistanceNeeded(isChecked); // Save the checkbox state\n  });\n\n  assistanceMessageInput.on(\"input\", () => {\n    const message = (assistanceMessageInput.getElement() as HTMLTextAreaElement)\n      .value;\n    saveAssistanceMessage(message); // Save the message to the state\n  });\n};\n","// src/modules/tickets/components/userDetailsUI.ts\nimport { WFComponent } from \"@xatom/core\";\nimport { authManager } from \"../../../auth/authConfig\";\nimport { saveUserDetails } from \"../state/ticketPurchaseState\"; // Import the save function from state\n\nexport const initializeUserDetails = () => {\n  const emailWrap = new WFComponent(\"#emailWrap\");\n  const firstNameInput = new WFComponent(\"#firstNameInput\");\n  const lastNameInput = new WFComponent(\"#lastNameInput\");\n  const emailInput = new WFComponent(\"#emailInput\");\n\n  // Check if the user is logged in\n  const user = authManager.getUserAuth().getUser();\n\n  if (user && user.email) {\n    // User is logged in, hide the emailWrap and populate the state\n    emailWrap.setStyle({ display: \"none\" });\n\n    // Save the user details to the state\n    saveUserDetails({\n      firstName: user.profile?.first_name || \"\",\n      lastName: user.profile?.last_name || \"\",\n      email: user.email,\n    });\n  } else {\n    // User is not logged in, show the emailWrap\n    emailWrap.setStyle({ display: \"grid\" });\n\n    // Set up event listeners to save user input to the state\n    firstNameInput.on(\"input\", () => {\n      const firstName = (firstNameInput.getElement() as HTMLInputElement).value;\n      saveUserDetails({ firstName });\n    });\n\n    lastNameInput.on(\"input\", () => {\n      const lastName = (lastNameInput.getElement() as HTMLInputElement).value;\n      saveUserDetails({ lastName });\n    });\n\n    emailInput.on(\"input\", () => {\n      const email = (emailInput.getElement() as HTMLInputElement).value;\n      saveUserDetails({ email });\n    });\n  }\n};\n","var e=require(\"@xatom/core\"),s=require(\"uuid\");var t,i,r,l,d={};t=d,i=\"WFSlider\",r=()=>o,Object.defineProperty(t,i,{get:r,set:l,enumerable:!0,configurable:!0});const n=window.jQuery;class o extends e.WFComponent{_sliderConfig={};_slides=[];_defaultSwipeDisabled=!1;_index=0;_listeners=new Map;constructor(e){super(e),this.init()}init(){this._defaultSwipeDisabled=\"true\"===this.getAttribute(\"data-disable-swipe\"),this._sliderConfig=n(this.getElement()).data()[\".wSlider\"],this._slides=Array.from(this._sliderConfig.slides).map((s=>new(0,e.WFComponent)(s))),this._mask=new(0,e.WFComponent)(this._sliderConfig.mask[0]),this._nav=new(0,e.WFComponent)(this._sliderConfig.nav[0]),this._left=new(0,e.WFComponent)(this._sliderConfig.left[0]),this._right=new(0,e.WFComponent)(this._sliderConfig.right[0]),function(e,s){if(!document.styleSheets)return;if(0==document.getElementsByTagName(\"head\").length)return;let t,i;if(document.styleSheets.length>0)for(var r=0,l=document.styleSheets.length;r<l;r++)if(!document.styleSheets[r].disabled){var d=document.styleSheets[r].media;if(i=typeof d,\"string\"===i?\"\"!==d&&-1===d.indexOf(\"screen\")||(t=document.styleSheets[r]):\"object\"==i&&(\"\"!==d.mediaText&&-1===d.mediaText.indexOf(\"screen\")||(t=document.styleSheets[r])),void 0!==t)break}if(void 0===t){var n=document.createElement(\"style\");for(n.type=\"text/css\",document.getElementsByTagName(\"head\")[0].appendChild(n),r=0;r<document.styleSheets.length;r++)document.styleSheets[r].disabled||(t=document.styleSheets[r]);i=typeof t.media}if(\"string\"===i){for(r=0,l=t.rules.length;r<l;r++)if(t.rules[r].selectorText&&t.rules[r].selectorText.toLowerCase()==e.toLowerCase())return void(t.rules[r].style.cssText=s);t.addRule(e,s)}else if(\"object\"===i){var o=t.cssRules?t.cssRules.length:0;for(r=0;r<o;r++)if(t.cssRules[r].selectorText&&t.cssRules[r].selectorText.toLowerCase()==e.toLowerCase())return void(t.cssRules[r].style.cssText=s);t.insertRule(e+\"{\"+s+\"}\",o)}}(\".xa-slider-disable\",\"display:none !important;\");const s=this;Object.defineProperty(s._sliderConfig,\"index\",{set:function(e){s._index=e,s._triggerOnChange()},get:function(){return s._index}}),this.refereshSlides()}reloadWFSlider(){window.Webflow.require(\"slider\").destroy(),window.Webflow.require(\"slider\").redraw(),window.Webflow.require(\"slider\").ready()}refereshSlides(){this._mask.getChildAsComponents(\".w-slide\").forEach((e=>e.remove())),this._slides.reverse().forEach((e=>{this._mask.getElement().prepend(e.getElement())})),this._slides.reverse(),this.reloadWFSlider()}getActiveSlide(){return this._slides[this._index]}getAllSlides(){return[...this._slides]}getSlideByIndex(e){return this._slides[e]}getActiveSlideIndex(){return this._index}getPreviousSlideIndex(){return this._sliderConfig.previous}goNext(){this._sliderConfig.right.click()}goPrevious(){this._sliderConfig.left.click()}goToIndex(e){e>=0&&e<this._slides.length&&(console.log(e),n(this._sliderConfig.nav.children()[e]).click())}addSlide(s,t={}){const i=t.index,r=t.cssClass,l=(0,e.createComponent)(\"div\");l.addCssClass(\"w-slide\"),r&&l.addCssClass(r),l.appendChild(s);const d=\"number\"!=typeof i?-1:i,n=this._slides;d>=0&&d<=n.length?n.splice(i,0,l):n.push(l),this._slides=[...n],this.refereshSlides()}removeSlide(e){const s=[...this._slides];e>=0&&e<s.length&&s.splice(e,1),this._slides=[...s],console.log(this._slides),this.refereshSlides()}getSlideNav(){return this._nav}setSlideNavigationState(e){e?(this._left.removeCssClass(\"xa-slider-disable\"),this._right.removeCssClass(\"xa-slider-disable\"),this._nav.removeCssClass(\"xa-slider-disable\"),this.setAttribute(\"data-disable-swipe\",this._defaultSwipeDisabled?\"true\":\"false\")):(this._left.addCssClass(\"xa-slider-disable\"),this._right.addCssClass(\"xa-slider-disable\"),this._nav.addCssClass(\"xa-slider-disable\"),this.setAttribute(\"data-disable-swipe\",\"true\")),this.reloadWFSlider()}onSlideChange(e){const t=(0,s.v4)();return this._listeners.set(t,e),()=>{this._listeners.delete(t)}}_triggerOnChange(){Array.from(this._listeners.values()).forEach((e=>{e(this._index,this._sliderConfig.previous)}))}getConfig(){return this._sliderConfig}}var a,h;a=module.exports,h=d,Object.keys(h).forEach((function(e){\"default\"===e||\"__esModule\"===e||a.hasOwnProperty(e)||Object.defineProperty(a,e,{enumerable:!0,get:function(){return h[e]}})}));","import { WFComponent } from \"@xatom/core\";\nimport { userAuth } from \"../../../auth/authConfig\";\n\n// Initialize the sidebar indicators for the ticket form\nexport const initializeTicketSidebarIndicators = () => {\n  const steps = [\n    { id: \"sidebarStepOne\", index: 1 },\n    { id: \"sidebarStepTwo\", index: 2 },\n    { id: \"sidebarStepThree\", index: 3 },\n    { id: \"sidebarStepFour\", index: 4 },\n  ];\n\n  // Set sidebar first name from userAuth\n  const firstNameText = new WFComponent(\"#firstNameText\");\n  const user = userAuth.getUser();\n\n  if (user && user.profile && user.profile.first_name) {\n    firstNameText.setText(user.profile.first_name);\n  } else {\n    firstNameText.setText(\"Friend\");\n  }\n\n  steps.forEach((step) => {\n    const stepComponent = new WFComponent(`#${step.id}`);\n    let isCompleted = false; // Track the completed state\n\n    stepComponent.on(\"click\", () => {\n      if (isCompleted) {\n        isCompleted = false;\n        // Trigger reverse animation here if needed\n      } else {\n        isCompleted = true;\n        // Trigger completed animation here\n      }\n    });\n  });\n};\n\n// Set the active step for the ticket form\nexport const setActiveTicketStep = (stepNumber: number) => {\n  const stepId = getTicketStepId(stepNumber);\n  const stepComponent = new WFComponent(`#${stepId}`);\n  stepComponent.addCssClass(\"is-active\");\n};\n\n// Unset the active step for the ticket form\nexport const unsetActiveTicketStep = (stepNumber: number) => {\n  const stepId = getTicketStepId(stepNumber);\n  const stepComponent = new WFComponent(`#${stepId}`);\n  stepComponent.removeCssClass(\"is-active\");\n};\n\n// Mark step as completed for the ticket form\nexport const markTicketStepAsCompleted = (stepNumber: number) => {\n  const stepId = getTicketStepId(stepNumber);\n  const step = new WFComponent(`#${stepId}`);\n  step.getElement().click(); // Programmatically trigger the click event to mark as complete\n};\n\n// Unmark step as completed (reverse the completed animation) for the ticket form\nexport const unmarkTicketStepAsCompleted = (stepNumber: number) => {\n  const stepId = getTicketStepId(stepNumber);\n  const step = new WFComponent(`#${stepId}`);\n  step.getElement().click(); // Programmatically trigger the click event to unmark as complete\n};\n\n// Helper function to get the ID string for a step in the ticket form\nconst getTicketStepId = (stepNumber: number): string => {\n  const stepMap: Record<number, string> = {\n    1: \"sidebarStepOne\",\n    2: \"sidebarStepTwo\",\n    3: \"sidebarStepThree\",\n    4: \"sidebarStepFour\",\n  };\n  return stepMap[stepNumber] || `ticketSidebarStep${stepNumber}`;\n};\n","import { WFComponent } from \"@xatom/core\";\nimport { toggleError } from \"./formUtils\";\n\nexport function validateNotEmpty(input: string | undefined): boolean {\n  return input !== undefined && input.trim() !== \"\";\n}\n\nexport function validateEmail(input: string): boolean {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(input);\n}\n\n/**\n * Validates that the email is either empty or correctly formatted.\n * @param value The email input value.\n * @returns True if valid, false otherwise.\n */\nexport const validateEmailOptional = (value: string): boolean => {\n  if (value.trim() === \"\") {\n    // Email is optional, so empty string is valid\n    return true;\n  }\n  // Validate the email format if not empty\n  return validateEmail(value);\n};\n\nexport function validatePasswordRequirements(password: string): boolean {\n  const hasLowercase = /[a-z]/.test(password);\n  const hasUppercase = /[A-Z]/.test(password);\n  const hasDigit = /\\d/.test(password);\n  const hasSpecialChar = /[!@#$%^&*(),.?\":{}|<>]/.test(password);\n  const hasValidLength = password.length >= 8;\n  return (\n    hasLowercase && hasUppercase && hasDigit && hasSpecialChar && hasValidLength\n  );\n}\n\nexport function validateCheckbox(checked: boolean): boolean {\n  return checked;\n}\n\nexport function validatePasswordsMatch(\n  originalPassword: string,\n  confirmPassword: string\n): boolean {\n  return originalPassword === confirmPassword;\n}\n\nexport function validateSelectField(input: string | undefined): boolean {\n  return input !== undefined && input !== \"N/A\";\n}\n\nexport function validatePhoneNumber(input: string): boolean {\n  const phoneRegex = /^\\(\\d{3}\\)\\s\\d{3}-\\d{4}$/;\n  return phoneRegex.test(input);\n}\n\nexport const validatePhoneNumberOptional = (value: string): boolean => {\n  if (value.trim() === \"\") {\n    // Phone number is optional, so empty string is valid\n    return true;\n  }\n  // Validate the phone number format if not empty\n  return validatePhoneNumber(value);\n};\n","// src/modules/tickets/components/urlParamNavigator.ts\n\nimport {\n  saveSelectedProduction,\n  saveSelectedPerformance,\n  clearTicketPurchaseState,\n} from \"../state/ticketPurchaseState\";\nimport { initializeProductionList } from \"../productionList\";\nimport { initializePerformanceList } from \"../performanceList\";\nimport { initializeTicketTiers } from \"../ticketTiers\";\nimport { WFSlider } from \"@xatom/slider\";\nimport {\n  initializeTicketSidebarIndicators,\n  setActiveTicketStep,\n  markTicketStepAsCompleted,\n} from \"../components/sidebarIndicators\";\nimport { WFComponent } from \"@xatom/core\";\nimport { updateSelectedPerformanceUI } from \"../components/selectedPerformanceUI\";\nimport { apiClient } from \"../../../api/apiConfig\";\n\n// parse URL params\nconst getUrlParams = () => {\n  const params = new URLSearchParams(window.location.search);\n  return {\n    productionId: params.get(\"production\"),   // string | null\n    performanceId: params.get(\"performance\"), // string | null\n    cancelId: params.get(\"cancel\"),           // string | null\n  };\n};\n\nexport const initializeStateFromUrlParams = async (slider: WFSlider) => {\n  const { productionId, performanceId, cancelId } = getUrlParams();\n  initializeTicketSidebarIndicators();\n\n  const loadingWall = new WFComponent(\".loading_wall\");\n  const animationDuration = 500;\n\n  if (productionId || performanceId || cancelId) {\n    loadingWall.setStyle({ display: \"flex\" });\n\n    try {\n      // handle cancellation\n      if (cancelId) {\n        const req = apiClient.delete(`/tickets/cancel_order/${cancelId}`);\n        await new Promise<void>((resolve, reject) => {\n          req.onData(() => {\n            // remove cancel from URL\n            const ps = new URLSearchParams(window.location.search);\n            ps.delete(\"cancel\");\n            const base = window.location.pathname;\n            const qs = ps.toString();\n            window.history.replaceState({}, document.title, base + (qs ? `?${qs}` : \"\"));\n            resolve();\n          });\n          req.onError((err) => reject(err));\n          req.fetch();\n        });\n      }\n\n      // if we have a productionId, pick step-1  step-2\n      if (productionId) {\n        clearTicketPurchaseState();\n\n        // load & render productions\n        const productions = await initializeProductionList(\"#selectProductionList\");\n\n        // find by numeric id\n        const prod = productions.find((p) => p.id === Number(productionId));\n        if (prod) {\n          saveSelectedProduction({\n            id: prod.id,\n            name: prod.Name,\n            description: prod.Short_Description,\n            imageUrl: prod.Main_Image,\n          });\n\n          markTicketStepAsCompleted(1);\n          setActiveTicketStep(2);\n\n          // check the radio in the UI\n          const inp = document.querySelector<HTMLInputElement>(\n            `input[value=\"${productionId}\"]`\n          );\n          if (inp) {\n            inp.checked = true;\n            inp.dispatchEvent(new Event(\"change\"));\n          }\n\n          // now load performances for that production\n          const performances = await initializePerformanceList(\"#selectPerformanceList\");\n\n          // if URL has performanceId, pick step-2  step-3\n          if (performanceId) {\n            const perf = performances.find((x) => x.id.toString() === performanceId);\n            if (perf) {\n              saveSelectedPerformance({\n                id: perf.id.toString(),\n                name: perf.Displayed_Name,\n                dateTime: perf.Date_Time.toString(),\n                description: perf.Short_Description,\n                imageUrl: perf.Main_Image,\n                location: perf.location_details.Name,\n              });\n\n              markTicketStepAsCompleted(2);\n              setActiveTicketStep(3);\n\n              updateSelectedPerformanceUI();\n              await initializeTicketTiers(\"#bundleList\", \"#ticketTierList\");\n              slider.goToIndex(2);\n            } else {\n              console.error(`Performance ${performanceId} not found`);\n              slider.goToIndex(1);\n            }\n          } else {\n            slider.goToIndex(1);\n          }\n        } else {\n          console.error(`Production ${productionId} not found`);\n          slider.goToIndex(0);\n        }\n      } else {\n        // no production param: stay on step-1\n        slider.goToIndex(0);\n      }\n    } catch (err) {\n      console.error(\"Error initializing from URL:\", err);\n      slider.goToIndex(0);\n    } finally {\n      loadingWall.addCssClass(\"hidden\");\n      setTimeout(() => loadingWall.setStyle({ display: \"none\" }), animationDuration);\n    }\n  }\n};\n"],"names":[],"version":3,"file":"makeTicketPurchase.55f87736.js.map","sourceRoot":"../"}