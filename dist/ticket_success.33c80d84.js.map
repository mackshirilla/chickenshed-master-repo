{"mappings":"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","sources":["src/modules/success_page/ticket_success.ts","node_modules/.pnpm/@xatom+image@1.0.0_@xatom+core@1.0.12/node_modules/@xatom/image/dist/index.js"],"sourcesContent":["import { WFComponent } from \"@xatom/core\";\nimport { WFImage } from \"@xatom/image\";\nimport { apiClient } from \"../../api/apiConfig\";\n\n// ———————————————————————————————————————\n// COMPONENT INSTANCES\n// ———————————————————————————————————————\nconst successTriggerComp = new WFComponent(\n  document.querySelector<HTMLElement>(\".success_trigger\")!\n);\n\nconst ticketCardComp = new WFComponent(\n  document.getElementById(\"ticketOrderCard\")!\n);\n\nconst cardImageComp = new WFImage(\n  ticketCardComp\n    .getChildAsComponent(\"#cardPerformanceImage\")\n    .getElement() as HTMLImageElement\n);\n\nconst productionNameComp = ticketCardComp.getChildAsComponent(\n  \"#cardProductionName\"\n)!;\n\nconst performanceNameComp = ticketCardComp.getChildAsComponent(\n  \"#cardPerformanceName\"\n)!;\n\nconst performanceDateComp = ticketCardComp.getChildAsComponent(\n  \"#cardPerformanceDate\"\n)!;\n\nconst quantityComp = ticketCardComp.getChildAsComponent(\"#quantity\")!;\n\nconst successMessageComp = new WFComponent(\n  document.getElementById(\"successMessage\")!\n);\n\n// ———————————————————————————————————————\n// TICKET DATA INTERFACES\n// ———————————————————————————————————————\ninterface PerformanceDetails {\n  id: number;\n  Displayed_Name: string;\n  Date_Time: number;\n  Main_Image: string;\n  Success_Page_Message: string;\n}\n\ninterface ProductionDetails {\n  id: number;\n  Name: string;\n}\n\ninterface TicketData {\n  id: number;\n  order_uuid: string;\n  status: string;\n  production_id: number;\n  performance_id: number;\n  quantity: number;\n  performance_details: PerformanceDetails;\n  production_details: ProductionDetails;\n}\n\n// ———————————————————————————————————————\n// POPULATOR FUNCTION\n// ———————————————————————————————————————\nexport async function populateTicketSuccess() {\n  // 0) grab orderUuid from URL\n  const params = new URLSearchParams(window.location.search);\n  const orderUuid = params.get(\"order\");\n  if (!orderUuid) {\n    console.error(\"Missing 'order' parameter in URL.\");\n    alert(\"Missing order identifier in URL.\");\n    return;\n  }\n\n  // 1) Fetch the ticket data\n  const req = apiClient.get<{ data: TicketData }>(\n    `/success_page/tickets/${orderUuid}`\n  );\n\n  try {\n    const { performance_details, production_details, quantity, order_uuid } =\n      await new Promise<TicketData>((resolve, reject) => {\n        req.onData((res) => resolve(res.data));\n        req.onError((err) => reject(err));\n        req.fetch();\n      });\n\n    // 2) Trigger your Webflow success animation\n    successTriggerComp.getElement().click();\n\n    // 3) Populate all WFComponents\n    // Image\n    cardImageComp.setImage(performance_details.Main_Image);\n    (cardImageComp.getElement() as HTMLImageElement).alt =\n      `${production_details.Name} — ${performance_details.Displayed_Name}`;\n\n    // Text fields\n    productionNameComp.setText(production_details.Name);\n    performanceNameComp.setText(performance_details.Displayed_Name);\n\n    // Always format the date+time in New York\n    performanceDateComp.setText(\n      new Date(performance_details.Date_Time).toLocaleString(\"en-US\", {\n        timeZone: \"America/New_York\",\n        month:   \"numeric\",\n        day:     \"numeric\",\n        year:    \"numeric\",\n        hour:    \"numeric\",\n        minute:  \"2-digit\",\n        hour12:  true\n      })\n    );\n\n    quantityComp.setText(String(quantity));\n    successMessageComp.setText(\n      performance_details.Success_Page_Message\n    );\n\n    // 4) Update the ticket-order link with performance & order params\n    const anchor = ticketCardComp.getElement() as HTMLAnchorElement;\n    try {\n      const url = new URL(anchor.getAttribute(\"href\")!, window.location.origin);\n      url.searchParams.set(\"performance\", String(performance_details.id));\n      url.searchParams.set(\"order\", order_uuid);\n      anchor.setAttribute(\"href\", url.toString());\n    } catch {\n      anchor.setAttribute(\n        \"href\",\n        `/ticket-order?uuid=${encodeURIComponent(order_uuid)}`\n      );\n    }\n\n    // 5) Show the card\n    (ticketCardComp.getElement() as HTMLElement).style.display = \"block\";\n  } catch (err) {\n    console.error(\"Ticket success load error:\", err);\n    alert(\n      \"We ran into a problem loading your ticket confirmation. Please reach out to support.\"\n    );\n  }\n}\n","var t=require(\"@xatom/core\");var e,r,s,i,o,n,u={};e=u,r=\"WFImage\",s=()=>c,Object.defineProperty(e,r,{get:s,set:i,enumerable:!0,configurable:!0});class c extends t.WFComponent{constructor(t){super(t)}getImageConfig(){return this._config}getSrc(){return this.getAttribute(\"src\")}getSizes(){return this.getAttribute(\"sizes\")}getSrcSet(){return this.getAttribute(\"srcset\")}getLoading(){return this.getAttribute(\"loading\")}onLoad(t){return this.on(\"load\",t),()=>{this.off(\"load\",t)}}onLoadError(t){return this.on(\"error\",t),()=>{this.off(\"error\",t)}}setImage(t){if(\"string\"==typeof t)this.setAttribute(\"src\",t),this.removeAttribute(\"srcset\"),this.removeAttribute(\"sizes\");else{if(this.setAttribute(\"src\",t.src),\"object\"==typeof t&&t.srcSet&&t.srcSet.length&&t.sizes&&t.sizes.length){const e=t.srcSet.map((t=>`${t.url} ${t.size}`)).join(\", \");this.setAttribute(\"srcset\",e)}else this.removeAttribute(\"srcset\"),this.removeAttribute(\"sizes\");t.loading&&this.setAttribute(\"loading\",t.loading)}}}o=module.exports,n=u,Object.keys(n).forEach((function(t){\"default\"===t||\"__esModule\"===t||o.hasOwnProperty(t)||Object.defineProperty(o,t,{enumerable:!0,get:function(){return n[t]}})}));"],"names":[],"version":3,"file":"ticket_success.33c80d84.js.map","sourceRoot":"../"}