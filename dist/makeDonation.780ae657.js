!function(e,t,n,a,i){var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r="function"==typeof s[a]&&s[a],o=r.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function d(t,n){if(!o[t]){if(!e[t]){var i="function"==typeof s[a]&&s[a];if(!n&&i)return i(t,!0);if(r)return r(t,!0);if(l&&"string"==typeof t)return l(t);var c=Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}u.resolve=function(n){var a=e[t][1][n];return null!=a?a:n},u.cache={};var p=o[t]=new d.Module(t);e[t][0].call(p.exports,u,p,p.exports,this)}return o[t].exports;function u(e){var t=u.resolve(e);return!1===t?{}:d(t)}}d.isParcelRequire=!0,d.Module=function(e){this.id=e,this.bundle=d,this.exports={}},d.modules=e,d.cache=o,d.parent=r,d.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(d,"root",{get:function(){return s[a]}}),s[a]=d;for(var c=0;c<t.length;c++)d(t[c])}({"2XpAL":[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"makeDonation",()=>h);var i=e("@xatom/core"),s=e("./campaignList"),r=e("./campaignProductList"),o=e("./state/donationState"),l=e("./components/selectedCampaignDisplay"),d=e("@xatom/slider"),c=e("./components/userContactDetails"),p=e("../../utils/validationUtils"),u=e("../../api/apiConfig"),m=e("./components/sidebarIndicators"),g=e("./components/urlParamNavigator"),f=e("../../auth/authConfig");let h=async()=>{(0,o.clearDonationState)(),(0,m.initializeSidebarIndicators)(),(0,m.setActiveStep)(1);let e=new d.WFSlider(".multi-step_form_slider");(0,g.initializeStateFromUrlParams)(e),await (0,s.initializeCampaignList)("#selectCampaignList"),(0,c.initializeUserContactDetails)(),new i.WFFormComponent("#formStepOne").onFormSubmit(async(t,n)=>{n.preventDefault();let a=(0,o.getSelectedCampaign)();if(!a||!a.id){console.error("No campaign selected.");let e=new i.WFComponent("#submitStepOneError");e.setText("Please select a campaign."),e.setStyle({display:"block"});return}console.log("Campaign selected:",a);let s=new i.WFComponent("#stepOneRequestingAnimation");s.setStyle({display:"block"});try{await (0,r.initializeDynamicProductList)("#selectProductList",a.id),(0,l.updateSelectedCampaignDisplay)(),s.setStyle({display:"none"}),(0,m.markStepAsCompleted)(1),(0,m.setActiveStep)(2),e.goNext()}catch(t){console.error("Error loading products:",t),s.setStyle({display:"none"});let e=new i.WFComponent("#submitStepOneError");e.setText("Error loading products. Please try again."),e.setStyle({display:"block"})}}),new i.WFFormComponent("#formStepTwo").onFormSubmit(async(e,t)=>{t.preventDefault();let n=(0,o.getSelectedProduct)();if(!n||!n.id){console.error("No product selected.");let e=new i.WFComponent("#submitStepTwoError");e.setText("Please select a product."),e.setStyle({display:"block"});return}let a=(0,f.userAuth).getUser(),s=a&&a.email?a.email:null,r=document.getElementById("emailWrap"),l=!1,d=s;if(r&&"none"!==r.style.display){let e=document.getElementById("firstNameInput"),t=document.getElementById("lastNameInput"),n=document.getElementById("emailInput"),a=!(0,p.validateNotEmpty)(e.value),r=!(0,p.validateNotEmpty)(t.value),c=!(0,p.validateEmail)(n.value);if(a||r||c){if(l=!0,console.error("Invalid input in contact details."),a){let e=new i.WFComponent("#firstNameInputError");e.setText("First name is required."),e.setStyle({display:"block"})}if(r){let e=new i.WFComponent("#lastNameInputError");e.setText("Last name is required."),e.setStyle({display:"block"})}if(c){let e=new i.WFComponent("#emailInputError");e.setText("A valid email address is required."),e.setStyle({display:"block"})}let e=new i.WFComponent("#submitStepTwoError");e.setText("Please correct the errors above."),e.setStyle({display:"block"});return}s||(d=n.value);let u=document.getElementById("anonymousInput").checked;(0,o.saveDonorDetails)({firstName:e.value,lastName:t.value,email:d,isAnonymous:u})}else{let e=document.getElementById("anonymousInput").checked;(0,o.saveDonorDetails)({firstName:a?a.profile.first_name:"",lastName:a?a.profile.last_name:"",email:s||"",isAnonymous:e})}if(!l){console.log("Product selected:",n);let e=new i.WFComponent("#stepTwoRequestingAnimation");e.setStyle({display:"block"});try{let t=(0,o.loadDonationState)(),n=await (0,u.apiClient).post("/donate/begin_checkout",{data:t}).fetch();e.setStyle({display:"none"}),window.location.href=n.checkout_url}catch(n){console.error("Error during checkout:",n),e.setStyle({display:"none"});let t=new i.WFComponent("#submitStepTwoError");t.setText("An error occurred during checkout. Please try again."),t.setStyle({display:"block"})}}}),new i.WFComponent("#backStepTwo").on("click",()=>{console.log("Navigating to the previous step."),(0,m.unmarkStepAsCompleted)(1),(0,m.setActiveStep)(1),(0,m.unsetActiveStep)(2),e.goPrevious()}),new i.WFComponent("#submitStepTwo").on("click",()=>{console.log("Submitting the second step.")});let t=()=>{let e=new i.WFComponent("#submitStepTwoError");e.setText(""),e.setStyle({display:"none"})},n=document.getElementById("firstNameInput"),a=document.getElementById("lastNameInput"),h=document.getElementById("emailInput");n&&a&&h&&(n.addEventListener("focus",t),a.addEventListener("focus",t),h.addEventListener("focus",t))}},{"@xatom/core":"65YBq","./campaignList":"cyN3Q","./campaignProductList":"dw1Mn","./state/donationState":"apIbX","./components/selectedCampaignDisplay":"iv1HY","@xatom/slider":"ejxGx","./components/userContactDetails":"kfWdK","../../utils/validationUtils":"gu2z7","../../api/apiConfig":"dUmIV","./components/sidebarIndicators":"aB2QU","./components/urlParamNavigator":"4SgF0","../../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],cyN3Q:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"initializeCampaignList",()=>c);var i=e("@xatom/core"),s=e("../../api/campaigns"),r=e("./state/donationState");let o=null,l=()=>{let e=JSON.parse(localStorage.getItem("donationState")||"{}");e.selectedCampaignId=o,console.log("Logging state to localStorage:",e),localStorage.setItem("donationState",JSON.stringify(e))},d=null,c=async e=>{let t=document.querySelector(e);if(!t)return console.error("Campaign list container not found."),[];d||(d=t.cloneNode(!0)),t.innerHTML="",t.appendChild(d.cloneNode(!0));let n=new i.WFDynamicList(e,{rowSelector:"#cardSelectProduction",loaderSelector:"#productionListLoading",emptySelector:"#productionListEmpty"});n.loaderRenderer(e=>(e.setStyle({display:"flex"}),e)),n.emptyRenderer(e=>(e.setStyle({display:"flex"}),e));let a=[];n.rowRenderer(({rowData:e,rowElement:t,index:n})=>{let s=new i.WFComponent(t),d=s.getChildAsComponent("#cardCampaignTitle"),c=s.getChildAsComponent("#cardCampaignSubheading"),p=s.getChildAsComponent("#cardCampaignDescription"),u=s.getChildAsComponent("#cardCampaignImage"),m=s.getChildAsComponent(".input_card_input"),g=s.getChildAsComponent("label");if(!d||!c||!p||!m||!u||!g){console.error("Campaign elements not found.");return}if(e&&e.fieldData){let i=`campaignInput-${n}`;m.setAttribute("id",i),m.setAttribute("value",e.id),g.setAttribute("for",i),d.setText(e.fieldData.name),c.setText(e.fieldData.subheading),p.setText(e.fieldData["short-description"]),e.fieldData["main-image"]?.url?u.setAttribute("src",e.fieldData["main-image"].url):console.warn(`Campaign ID ${e.id} does not have a main image.`),m.on("change",()=>{o=m.getElement().value,(0,r.saveSelectedCampaign)({id:e.id,name:e.fieldData.name,imageUrl:e.fieldData["main-image"].url,description:e.fieldData["short-description"],subheading:e.fieldData.subheading}),l(),console.log("Selected Campaign ID:",o)}),t.setStyle({display:"flex"}),a.push(e)}else console.error("Incomplete campaign data:",e);return t});try{n.changeLoadingStatus(!0),a=await (0,s.fetchCampaigns)(),console.log("Fetched campaigns:",a),a.length>0?n.setData(a):n.setData([]),n.changeLoadingStatus(!1)}catch(e){console.error("Error loading campaigns:",e),n.setData([]),n.changeLoadingStatus(!1)}return a}},{"@xatom/core":"65YBq","../../api/campaigns":"8hXW0","./state/donationState":"apIbX","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],"8hXW0":[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"fetchCampaigns",()=>s);var i=e("./apiConfig");let s=async()=>{try{return(await (0,i.apiClient).get("/donate/campaigns").fetch()).campaigns}catch(e){throw console.error("Error fetching campaigns:",e),e}}},{"./apiConfig":"dUmIV","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],apIbX:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"loadDonationState",()=>s),a.export(n,"saveDonationState",()=>r),a.export(n,"clearDonationState",()=>o),a.export(n,"getSelectedCampaign",()=>l),a.export(n,"saveSelectedCampaign",()=>d),a.export(n,"getSelectedProduct",()=>c),a.export(n,"saveSelectedProduct",()=>p),a.export(n,"getDonorDetails",()=>u),a.export(n,"saveDonorDetails",()=>m);let i="donationState",s=()=>{let e=localStorage.getItem(i);return e?JSON.parse(e):{}},r=e=>{let t={...s(),...e};localStorage.setItem(i,JSON.stringify(t))},o=()=>{localStorage.removeItem(i)},l=()=>{let e=s();return{id:e.selectedCampaignId||null,name:e.selectedCampaignName||null,imageUrl:e.selectedCampaignImageUrl||null,description:e.selectedCampaignDescription||null,subheading:e.selectedCampaignSubheading||null}},d=e=>{r({selectedCampaignId:e.id,selectedCampaignName:e.name,selectedCampaignImageUrl:e.imageUrl,selectedCampaignDescription:e.description,selectedCampaignSubheading:e.subheading})},c=()=>{let e=s();return{id:e.selectedProductId||null,name:e.selectedProductName||null,amount:e.selectedProductAmount||null}},p=e=>{r({selectedProductId:e.id,selectedProductName:e.name,selectedProductAmount:e.amount})},u=()=>{let e=s();return{email:e.email||null,firstName:e.firstName||null,lastName:e.lastName||null,isAnonymous:e.isAnonymous||!1}},m=e=>{r({email:e.email,firstName:e.firstName,lastName:e.lastName,isAnonymous:e.isAnonymous})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],dw1Mn:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"initializeDynamicProductList",()=>d);var i=e("@xatom/core"),s=e("../../api/campaignProducts"),r=e("./state/donationState");let o=null,l=null,d=async(e,t)=>{let n=document.querySelector(e);if(!n){console.error("Product list container not found.");return}l||(l=n.cloneNode(!0)),n.innerHTML="",n.appendChild(l.cloneNode(!0));let a=new i.WFDynamicList(e,{rowSelector:"#cardSelectProduct"});a.loaderRenderer(e=>(e.setStyle({display:"flex"}),e)),a.emptyRenderer(e=>(e.setStyle({display:"flex"}),e)),a.rowRenderer(({rowData:e,rowElement:t,index:n})=>{let a=new i.WFComponent(t),s=a.getChildAsComponent("#cardProductTitle"),l=a.getChildAsComponent(".input_card_input");if(!s||!l){console.error("One or more elements not found in the product card");return}let d=`productInput-${n}`;l.setAttribute("id",d),l.setAttribute("value",e.id);let c=a.getChildAsComponent("label");return c&&c.setAttribute("for",d),s.setText(e.fieldData["product-name"]),l.on("change",()=>{o=l.getElement().value,(0,r.saveSelectedProduct)({id:e.id,name:e.fieldData["product-name"],amount:e.fieldData.price}),console.log("Selected Product ID:",o)}),t.setStyle({display:"flex"}),t});try{a.changeLoadingStatus(!0);let e=await (0,s.fetchProducts)(t);console.log("Fetched products:",e),e.length>0?a.setData(e):a.setData([]),a.changeLoadingStatus(!1)}catch(e){console.error("Error loading products:",e),a.setData([]),a.changeLoadingStatus(!1)}}},{"@xatom/core":"65YBq","../../api/campaignProducts":"abEqP","./state/donationState":"apIbX","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],abEqP:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"fetchProducts",()=>s);var i=e("./apiConfig");let s=async e=>{try{return(await (0,i.apiClient).post("/donate/campaign/products",{data:{campaign_id:e}}).fetch()).products}catch(e){throw console.error("Error fetching products:",e),e}}},{"./apiConfig":"dUmIV","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],iv1HY:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"updateSelectedCampaignDisplay",()=>r);var i=e("@xatom/core"),s=e("../state/donationState");let r=()=>{let e=(0,s.getSelectedCampaign)();if(!e){console.error("No selected campaign found in the state.");return}let{name:t,subheading:n,description:a,imageUrl:r}=e,o=new i.WFComponent("#selectedCampaignTitle"),l=new i.WFComponent("#selectedCampaignSubtitle"),d=new i.WFComponent("#selectedCampaignDescription"),c=new i.WFComponent("#selectedImage");o.setText(t||"N/A"),l.setText(n||"No subheading available."),d.setText(a||"No description available."),r?c.setAttribute("src",r):c.setAttribute("src","https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg")}},{"@xatom/core":"65YBq","../state/donationState":"apIbX","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],ejxGx:[function(e,t,n){var a,i=e("1a87f3bc23b90fa3"),s=e("37b5fd8189a9f4c7"),r={};Object.defineProperty(r,"WFSlider",{get:()=>l,set:void 0,enumerable:!0,configurable:!0});let o=window.jQuery;class l extends i.WFComponent{_sliderConfig={};_slides=[];_defaultSwipeDisabled=!1;_index=0;_listeners=new Map;constructor(e){super(e),this.init()}init(){this._defaultSwipeDisabled="true"===this.getAttribute("data-disable-swipe"),this._sliderConfig=o(this.getElement()).data()[".wSlider"],this._slides=Array.from(this._sliderConfig.slides).map(e=>new i.WFComponent(e)),this._mask=new i.WFComponent(this._sliderConfig.mask[0]),this._nav=new i.WFComponent(this._sliderConfig.nav[0]),this._left=new i.WFComponent(this._sliderConfig.left[0]),this._right=new i.WFComponent(this._sliderConfig.right[0]),function(e,t){let n,a;if(document.styleSheets&&0!=document.getElementsByTagName("head").length){if(document.styleSheets.length>0){for(var i=0,s=document.styleSheets.length;i<s;i++)if(!document.styleSheets[i].disabled){var r=document.styleSheets[i].media;if("string"==(a=typeof r)?""!==r&&-1===r.indexOf("screen")||(n=document.styleSheets[i]):"object"==a&&(""!==r.mediaText&&-1===r.mediaText.indexOf("screen")||(n=document.styleSheets[i])),void 0!==n)break}}if(void 0===n){var o=document.createElement("style");for(o.type="text/css",document.getElementsByTagName("head")[0].appendChild(o),i=0;i<document.styleSheets.length;i++)document.styleSheets[i].disabled||(n=document.styleSheets[i]);a=typeof n.media}if("string"===a){for(i=0,s=n.rules.length;i<s;i++)if(n.rules[i].selectorText&&n.rules[i].selectorText.toLowerCase()==e.toLowerCase())return void(n.rules[i].style.cssText=t);n.addRule(e,t)}else if("object"===a){var l=n.cssRules?n.cssRules.length:0;for(i=0;i<l;i++)if(n.cssRules[i].selectorText&&n.cssRules[i].selectorText.toLowerCase()==e.toLowerCase())return void(n.cssRules[i].style.cssText=t);n.insertRule(e+"{"+t+"}",l)}}}(".xa-slider-disable","display:none !important;");let e=this;Object.defineProperty(e._sliderConfig,"index",{set:function(t){e._index=t,e._triggerOnChange()},get:function(){return e._index}}),this.refereshSlides()}reloadWFSlider(){window.Webflow.require("slider").destroy(),window.Webflow.require("slider").redraw(),window.Webflow.require("slider").ready()}refereshSlides(){this._mask.getChildAsComponents(".w-slide").forEach(e=>e.remove()),this._slides.reverse().forEach(e=>{this._mask.getElement().prepend(e.getElement())}),this._slides.reverse(),this.reloadWFSlider()}getActiveSlide(){return this._slides[this._index]}getAllSlides(){return[...this._slides]}getSlideByIndex(e){return this._slides[e]}getActiveSlideIndex(){return this._index}getPreviousSlideIndex(){return this._sliderConfig.previous}goNext(){this._sliderConfig.right.click()}goPrevious(){this._sliderConfig.left.click()}goToIndex(e){e>=0&&e<this._slides.length&&(console.log(e),o(this._sliderConfig.nav.children()[e]).click())}addSlide(e,t={}){let n=t.index,a=t.cssClass,s=(0,i.createComponent)("div");s.addCssClass("w-slide"),a&&s.addCssClass(a),s.appendChild(e);let r="number"!=typeof n?-1:n,o=this._slides;r>=0&&r<=o.length?o.splice(n,0,s):o.push(s),this._slides=[...o],this.refereshSlides()}removeSlide(e){let t=[...this._slides];e>=0&&e<t.length&&t.splice(e,1),this._slides=[...t],console.log(this._slides),this.refereshSlides()}getSlideNav(){return this._nav}setSlideNavigationState(e){e?(this._left.removeCssClass("xa-slider-disable"),this._right.removeCssClass("xa-slider-disable"),this._nav.removeCssClass("xa-slider-disable"),this.setAttribute("data-disable-swipe",this._defaultSwipeDisabled?"true":"false")):(this._left.addCssClass("xa-slider-disable"),this._right.addCssClass("xa-slider-disable"),this._nav.addCssClass("xa-slider-disable"),this.setAttribute("data-disable-swipe","true")),this.reloadWFSlider()}onSlideChange(e){let t=(0,s.v4)();return this._listeners.set(t,e),()=>{this._listeners.delete(t)}}_triggerOnChange(){Array.from(this._listeners.values()).forEach(e=>{e(this._index,this._sliderConfig.previous)})}getConfig(){return this._sliderConfig}}a=t.exports,Object.keys(r).forEach(function(e){"default"===e||"__esModule"===e||a.hasOwnProperty(e)||Object.defineProperty(a,e,{enumerable:!0,get:function(){return r[e]}})})},{"1a87f3bc23b90fa3":"65YBq","37b5fd8189a9f4c7":"faiuA"}],kfWdK:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"initializeUserContactDetails",()=>d);var i=e("@xatom/core"),s=e("../../../utils/validationUtils"),r=e("../../../utils/formUtils"),o=e("../state/donationState"),l=e("../../../auth/authConfig");let d=()=>{let e=new i.WFComponent("#firstNameInput"),t=new i.WFComponent("#lastNameInput"),n=new i.WFComponent("#emailInput"),a=new i.WFComponent("#firstNameInputError"),d=new i.WFComponent("#lastNameInputError"),p=new i.WFComponent("#emailInputError"),u=new i.WFComponent("#emailWrap"),m=(0,l.userAuth).getUser();m&&m.email?(u.setStyle({display:"none"}),(0,o.saveDonationState)({email:m.email})):(u.setStyle({display:"grid"}),(0,r.setupValidation)(n,p,c(n,s.validateEmail,"Invalid email address."))),(0,r.setupValidation)(e,a,c(e,s.validateNotEmpty,"First name is required.")),(0,r.setupValidation)(t,d,c(t,s.validateNotEmpty,"Last name is required.")),e.on("input",()=>{let t=e.getElement().value;(0,o.saveDonationState)({firstName:t})}),t.on("input",()=>{let e=t.getElement().value;(0,o.saveDonationState)({lastName:e})}),n.on("input",()=>{let e=n.getElement().value;(0,o.saveDonationState)({email:e})})};function c(e,t,n){return()=>t(e.getElement().value)?"":n}},{"@xatom/core":"65YBq","../../../utils/validationUtils":"gu2z7","../../../utils/formUtils":"gepHz","../state/donationState":"apIbX","../../../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],gu2z7:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");function i(e){return void 0!==e&&""!==e.trim()}function s(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}a.defineInteropFlag(n),a.export(n,"validateNotEmpty",()=>i),a.export(n,"validateEmail",()=>s),a.export(n,"validateEmailOptional",()=>r),a.export(n,"validatePasswordRequirements",()=>o),a.export(n,"validateCheckbox",()=>l),a.export(n,"validatePasswordsMatch",()=>d),a.export(n,"validateSelectField",()=>c),a.export(n,"validatePhoneNumber",()=>p);let r=e=>""===e.trim()||s(e);function o(e){let t=/[a-z]/.test(e),n=/[A-Z]/.test(e),a=/\d/.test(e),i=/[!@#$%^&*(),.?":{}|<>]/.test(e),s=e.length>=8;return t&&n&&a&&i&&s}function l(e){return e}function d(e,t){return e===t}function c(e){return void 0!==e&&"N/A"!==e}function p(e){return/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],gepHz:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"toggleError",()=>l),a.export(n,"setupValidation",()=>d),a.export(n,"createValidationFunction",()=>c),a.export(n,"createCheckboxValidationFunction",()=>p),a.export(n,"setupCheckboxValidation",()=>u),a.export(n,"validateSelectedSessions",()=>m),a.export(n,"setProfilePicUrl",()=>g),a.export(n,"setupFileUpload",()=>f),a.export(n,"formatPhoneNumber",()=>h);var i=e("@xatom/core"),s=e("@xatom/image"),r=e("../api/apiConfig"),o=e("../auth/authConfig");function l(e,t,n){e.updateTextViaAttrVar({text:n?t:""}),e.setStyle({display:n?"flex":"none"})}function d(e,t,n,a){let i=()=>{let e=n();l(t,e,!!e),a&&""===e&&l(a,"",!1)};e.on("input",i),e.on("blur",i),e.on("change",i)}function c(e,t,n){return()=>t(e.getElement().value)?"":n}function p(e,t){return()=>e.getElement().checked?"":t}function u(e,t,n){let a=p(e,n);d(e,t,a)}function m(e,t,n){let a=e.length>0&&e.some(e=>e.studentIds.length>0);return a?l(t,"",!1):l(t,n,!0),a}function g(e){let t=(0,o.userAuth).getUser();t&&t.profile&&(t.profile.profile_pic=t.profile.profile_pic||{url:""},t.profile.profile_pic.url=e,(0,o.userAuth).setUser(t),localStorage.setItem("auth_user",JSON.stringify(t)))}function f(e,t,n,a){let o=new s.WFImage("#profilePictureImage"),d=new i.WFComponent("#uploadAnimation"),c=new i.WFComponent(".drop-zone"),p=0;return new Promise(i=>{let s=s=>{if(!["image/jpeg","image/jpg"].includes(s.type)&&!/\.(jpg|jpeg)$/i.test(s.name)){l(t,"Only JPEG images are allowed.",!0),e.getElement().value="";return}if(s.size>2097152){l(t,"File size must be less than 2 MB.",!0),e.getElement().value="";return}d.setStyle({display:"flex"}),t.setStyle({display:"none"}),n.setStyle({display:"none"});let u=new FileReader;u.onload=e=>{let t=e.target?.result;o.setImage(t),c.setStyle({display:"none"})},u.readAsDataURL(s);let m=new FormData;m.append("profile_picture",s);let f=localStorage.getItem("current_student");if(f){let e=JSON.parse(f);m.append("student_profile_id",e.id.toString())}let h=(0,r.apiClient).post(a,{data:m});h.onData(a=>{if("success"===a.status){let e=a.url.profile_pic.url;g(e),o.setImage(e),localStorage.setItem("image_upload",e),n.setStyle({display:"flex"}),d.setStyle({display:"none"}),i(e)}else l(t,"Failed to upload profile picture.",!0),d.setStyle({display:"none"}),c.setStyle({display:"none"}),p=0,e.getElement().value=""}),h.onError(n=>{let a="An error occurred during image upload.";n.response&&n.response.data?a=n.response.data.message||a:n.message&&(a=n.message),l(t,a,!0),d.setStyle({display:"none"}),c.setStyle({display:"none"}),p=0,e.getElement().value=""}),h.fetch()};e.on("change",()=>{let t=e.getElement().files?.[0];t&&s(t)});let u=document.body;u.addEventListener("dragenter",e=>{e.preventDefault(),1==++p&&c.setStyle({display:"flex"})}),u.addEventListener("dragleave",()=>{--p<=0&&(c.setStyle({display:"none"}),p=0)}),u.addEventListener("dragover",e=>{e.preventDefault()}),u.addEventListener("drop",e=>{e.preventDefault();let t=e.dataTransfer?.files;t?.length&&s(t[0]),c.setStyle({display:"none"}),p=0})})}let h=e=>{let t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:t.length<=10?`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`}},{"@xatom/core":"65YBq","@xatom/image":"bavwf","../api/apiConfig":"dUmIV","../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],bavwf:[function(e,t,n){var a,i=e("d023971cccd819e3"),s={};Object.defineProperty(s,"WFImage",{get:()=>r,set:void 0,enumerable:!0,configurable:!0});class r extends i.WFComponent{constructor(e){super(e)}getImageConfig(){return this._config}getSrc(){return this.getAttribute("src")}getSizes(){return this.getAttribute("sizes")}getSrcSet(){return this.getAttribute("srcset")}getLoading(){return this.getAttribute("loading")}onLoad(e){return this.on("load",e),()=>{this.off("load",e)}}onLoadError(e){return this.on("error",e),()=>{this.off("error",e)}}setImage(e){if("string"==typeof e)this.setAttribute("src",e),this.removeAttribute("srcset"),this.removeAttribute("sizes");else{if(this.setAttribute("src",e.src),"object"==typeof e&&e.srcSet&&e.srcSet.length&&e.sizes&&e.sizes.length){let t=e.srcSet.map(e=>`${e.url} ${e.size}`).join(", ");this.setAttribute("srcset",t)}else this.removeAttribute("srcset"),this.removeAttribute("sizes");e.loading&&this.setAttribute("loading",e.loading)}}}a=t.exports,Object.keys(s).forEach(function(e){"default"===e||"__esModule"===e||a.hasOwnProperty(e)||Object.defineProperty(a,e,{enumerable:!0,get:function(){return s[e]}})})},{d023971cccd819e3:"65YBq"}],aB2QU:[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"initializeSidebarIndicators",()=>r),a.export(n,"setActiveStep",()=>o),a.export(n,"unsetActiveStep",()=>l),a.export(n,"markStepAsCompleted",()=>d),a.export(n,"unmarkStepAsCompleted",()=>c);var i=e("@xatom/core"),s=e("../../../auth/authConfig");let r=()=>{let e=new i.WFComponent("#firstNameText"),t=(0,s.userAuth).getUser();t&&t.profile&&t.profile.first_name?e.setText(t.profile.first_name):e.setText("Friend"),[{id:"sidebarStepOne",index:1},{id:"sidebarStepTwo",index:2},{id:"sidebarStepThree",index:3}].forEach(e=>{let t=new i.WFComponent(`#${e.id}`),n=!1;t.on("click",()=>{n=!n})})},o=e=>{let t=p(e);new i.WFComponent(`#${t}`).addCssClass("is-active")},l=e=>{let t=p(e);new i.WFComponent(`#${t}`).removeCssClass("is-active")},d=e=>{let t=p(e);new i.WFComponent(`#${t}`).getElement().click()},c=e=>{let t=p(e);new i.WFComponent(`#${t}`).getElement().click()},p=e=>({1:"sidebarStepOne",2:"sidebarStepTwo",3:"sidebarStepThree"})[e]||`sidebarStep${e}`},{"@xatom/core":"65YBq","../../../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],"4SgF0":[function(e,t,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(n),a.export(n,"initializeStateFromUrlParams",()=>g);var i=e("../state/donationState"),s=e("../campaignList"),r=e("../campaignProductList"),o=e("../components/sidebarIndicators"),l=e("@xatom/core"),d=e("../components/selectedCampaignDisplay"),c=e("../../../api/apiConfig");let p=()=>{let e=new URLSearchParams(window.location.search);return{campaignId:e.get("campaign"),cancelId:e.get("cancel")}},u=e=>{},m=e=>{},g=async e=>{let{campaignId:t,cancelId:n}=p();(0,o.initializeSidebarIndicators)();let a=new l.WFComponent(".loading_wall");if(t||n){a.setStyle({display:"flex"});try{if(n){let e=(0,c.apiClient).delete(`/donate/cancel_donation/${n}`);await new Promise((t,a)=>{e.onData(()=>{console.log(`Donation ${n} canceled successfully`);let e=new URLSearchParams(window.location.search);e.delete("cancel");let a=`${window.location.pathname}${e.toString()?`?${e.toString()}`:""}`;window.history.replaceState({},document.title,a),m("Your donation has been successfully canceled."),t()}),e.onError(e=>{console.error(`Failed to cancel donation ${n}:`,e),u("Failed to cancel your donation. Please try again later."),a(e)}),e.fetch()})}if(t){(0,i.clearDonationState)();let n=(await (0,s.initializeCampaignList)("#selectCampaignList")).find(e=>e.id===t);if(n){(0,i.saveSelectedCampaign)({id:n.id,name:n.fieldData.name,imageUrl:n.fieldData["main-image"].url,description:n.fieldData["short-description"],subheading:n.fieldData.subheading}),(0,o.markStepAsCompleted)(1),(0,o.setActiveStep)(2),(0,d.updateSelectedCampaignDisplay)();let a=document.querySelector(`input[value="${t}"]`);a&&(a.checked=!0,a.dispatchEvent(new Event("change"))),await (0,r.initializeDynamicProductList)("#selectProductList",t),e.goToIndex(1)}else console.error(`Campaign with ID ${t} not found`),u("Selected campaign not found. Please choose a valid campaign."),e.goToIndex(0)}}catch(t){console.error("Error initializing state from URL parameters:",t),u("An error occurred while initializing. Please try again."),e.goToIndex(0)}finally{a.addCssClass("hidden"),setTimeout(()=>a.setStyle({display:"none"}),500)}}}},{"../state/donationState":"apIbX","../campaignList":"cyN3Q","../campaignProductList":"dw1Mn","../components/sidebarIndicators":"aB2QU","@xatom/core":"65YBq","../components/selectedCampaignDisplay":"iv1HY","../../../api/apiConfig":"dUmIV","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}]},[],0,"parcelRequired346");
//# sourceMappingURL=makeDonation.780ae657.js.map
