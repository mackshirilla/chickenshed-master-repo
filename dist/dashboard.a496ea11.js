!function(e,t,i,n,r){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o="function"==typeof a[n]&&a[n],s=o.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function c(t,i){if(!s[t]){if(!e[t]){var r="function"==typeof a[n]&&a[n];if(!i&&r)return r(t,!0);if(o)return o(t,!0);if(l&&"string"==typeof t)return l(t);var d=Error("Cannot find module '"+t+"'");throw d.code="MODULE_NOT_FOUND",d}u.resolve=function(i){var n=e[t][1][i];return null!=n?n:i},u.cache={};var p=s[t]=new c.Module(t);e[t][0].call(p.exports,u,p,p.exports,this)}return s[t].exports;function u(e){var t=u.resolve(e);return!1===t?{}:c(t)}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=e,c.cache=s,c.parent=o,c.register=function(t,i){e[t]=[function(e,t){t.exports=i},{}]},Object.defineProperty(c,"root",{get:function(){return a[n]}}),a[n]=c;for(var d=0;d<t.length;d++)c(t[d])}({dgsaz:[function(e,t,i){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(i),n.export(i,"dashboard",()=>m);var r=e("./listStudents"),a=e("./listAdditionalStudents"),o=e("./listCaregivers"),s=e("./listRegistration"),l=e("./listTicketOrders"),c=e("./listDonations"),d=e("./listCaregiverNotifications"),p=e("./listFiles"),u=e("@xatom/core"),g=e("../../auth/authConfig"),f=e("./listAddOnRegistrations");let m=async()=>{new u.WFComponent("#firstNameText").setText((0,g.userAuth).getUser().profile.first_name);try{await (0,r.initializeDynamicStudentList)("#listStudentProfiles"),await (0,a.initializeDynamicAdditionalStudentList)("#listAdditionalStudentProfiles"),await (0,p.initializeDynamicFileList)("#filesList"),await (0,o.initializeDynamicCaregiverList)("#caregiversList"),(0,s.initializeDynamicSubscriptionList)("#listRegistration"),(0,f.initializeDynamicAddOnRegistrationList)("#listAddOnRegistration"),await (0,l.initializeDynamicTicketOrderList)("#listTickets"),await (0,c.initializeDynamicDonationList)("#listDonations"),(0,d.initializeCaregiverNotifications)("caregiverNotificationList"),h(".success_trigger")}catch(e){console.error("Dashboard init error:",e)}},h=e=>{let t=document.querySelector(e);t instanceof HTMLElement&&t.click()}},{"./listStudents":"5D5Dr","./listAdditionalStudents":"3njZO","./listCaregivers":"A7Qq7","./listRegistration":"fmeF7","./listTicketOrders":"klDdo","./listDonations":"gXsgU","./listCaregiverNotifications":"eueXt","./listFiles":"d21gs","@xatom/core":"65YBq","../../auth/authConfig":"dHwPR","./listAddOnRegistrations":"4kKtJ","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],eueXt:[function(e,t,i){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(i),n.export(i,"initializeCaregiverNotifications",()=>o);var r=e("@xatom/core"),a=e("../../api/apiConfig");async function o(e){let t=document.getElementById(e);if(!t){console.error("Caregiver notifications container not found:",e);return}t.style.display="none";let i=new r.WFDynamicList(`#${e}`,{rowSelector:"#caregiverNotificationRow"}),n=[];async function o(){try{console.log("Fetching caregiver invites...");let e=await (0,a.apiClient).get("/caregivers/invites").fetch();console.log("Fetched caregiver invites:",e),e.caregivers&&Array.isArray(e.caregivers)?(n=e.caregivers.sort((e,t)=>t.created_at-e.created_at),i.setData(n),n.length>0?t.style.display="flex":t.style.display="none"):(console.error("Invalid response structure for caregiver invites:",e),n=[],i.setData(n),t.style.display="none")}catch(e){console.error("Error fetching caregiver invites:",e),n=[],i.setData(n),t.style.display="none"}}i.rowRenderer(({rowData:e,rowElement:t})=>{let i=new r.WFComponent(t);return i.getChildAsComponent("#caregiverNotificationName").setText(e.user_one_name),i.getChildAsComponent("#acceptCaregiver").on("click",async()=>{try{console.log(`Accepting caregiver invite with ID: ${e.id}`);let t=i.getChildAsComponent("#requestingAnimationAccept");t?t.setStyle({display:"block"}):console.warn("Loading animation element not found: #requestingAnimationAccept");let n=await (0,a.apiClient).post(`/caregivers/invites/${e.id}/accept`).fetch();console.log("API response:",n),"success"===n.status?(console.log("Caregiver invite accepted successfully."),console.log("Refreshing the page to reflect changes."),location.reload()):(console.warn("API response unsuccessful:",n),alert(n.message||"Failed to accept caregiver invite."))}catch(e){console.error("Error accepting caregiver invite:",e),alert("An error occurred while accepting the invite.")}finally{let e=i.getChildAsComponent("#requestingAnimationAccept");e?e.setStyle({display:"none"}):console.warn("Loading animation element not found: #requestingAnimationAccept")}}),i.getChildAsComponent("#declineCaregiver").on("click",async()=>{try{console.log(`Declining caregiver invite with ID: ${e.id}`);let t=i.getChildAsComponent("#requestingAnimationDecline");t?t.setStyle({display:"block"}):console.warn("Loading animation element not found: #requestingAnimationDecline");let n=await (0,a.apiClient).post(`/caregivers/invites/${e.id}/decline`).fetch();console.log("API response:",n),"success"===n.status?(console.log("Caregiver invite declined successfully."),console.log("Refreshing the page to reflect changes."),location.reload()):(console.warn("API response unsuccessful:",n),alert(n.message||"Failed to decline caregiver invite."))}catch(e){console.error("Error declining caregiver invite:",e),alert("An error occurred while declining the invite.")}finally{let e=i.getChildAsComponent("#requestingAnimationDecline");e?e.setStyle({display:"none"}):console.warn("Loading animation element not found: #requestingAnimationDecline")}}),t}),await o()}},{"@xatom/core":"65YBq","../../api/apiConfig":"dUmIV","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],d21gs:[function(e,t,i){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(i),n.export(i,"fetchFiles",()=>o),n.export(i,"initializeDynamicFileList",()=>s);var r=e("@xatom/core"),a=e("../../api/apiConfig");async function o(){try{let e=(0,a.apiClient).get("/student_files");return await e.fetch()}catch(e){throw console.error("Error fetching files:",e),e}}async function s(e){let t=new r.WFDynamicList(e,{rowSelector:"#fileCard",loaderSelector:"#filesloading",emptySelector:"#filesEmpty"});t.loaderRenderer(e=>(e.setStyle({display:"flex"}),e)),t.emptyRenderer(e=>(e.setStyle({display:"flex"}),e)),t.rowRenderer(({rowData:e,rowElement:t})=>{let i=new r.WFComponent(t);return i.setAttribute("href",e.file_url),i.getChildAsComponent("#fileName").setText(e.file_name),t.setStyle({display:"block"}),t});try{t.changeLoadingStatus(!0);let e=await o();e.sort((e,t)=>e.file_name.localeCompare(t.file_name)),t.setData(e),t.changeLoadingStatus(!1)}catch(e){console.error("Error loading files:",e),t.setData([]),t.changeLoadingStatus(!1)}}},{"@xatom/core":"65YBq","../../api/apiConfig":"dUmIV","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],gepHz:[function(e,t,i){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(i),n.export(i,"toggleError",()=>l),n.export(i,"setupValidation",()=>c),n.export(i,"createValidationFunction",()=>d),n.export(i,"createCheckboxValidationFunction",()=>p),n.export(i,"setupCheckboxValidation",()=>u),n.export(i,"validateSelectedSessions",()=>g),n.export(i,"setProfilePicUrl",()=>f),n.export(i,"setupFileUpload",()=>m),n.export(i,"formatPhoneNumber",()=>h);var r=e("@xatom/core"),a=e("@xatom/image"),o=e("../api/apiConfig"),s=e("../auth/authConfig");function l(e,t,i){e.updateTextViaAttrVar({text:i?t:""}),e.setStyle({display:i?"flex":"none"})}function c(e,t,i,n){let r=()=>{let e=i();l(t,e,!!e),n&&""===e&&l(n,"",!1)};e.on("input",r),e.on("blur",r),e.on("change",r)}function d(e,t,i){return()=>t(e.getElement().value)?"":i}function p(e,t){return()=>e.getElement().checked?"":t}function u(e,t,i){let n=p(e,i);c(e,t,n)}function g(e,t,i){let n=e.length>0&&e.some(e=>e.studentIds.length>0);return n?l(t,"",!1):l(t,i,!0),n}function f(e){let t=(0,s.userAuth).getUser();t&&t.profile&&(t.profile.profile_pic=t.profile.profile_pic||{url:""},t.profile.profile_pic.url=e,(0,s.userAuth).setUser(t),localStorage.setItem("auth_user",JSON.stringify(t)))}function m(e,t,i,n){let s=new a.WFImage("#profilePictureImage"),c=new r.WFComponent("#uploadAnimation"),d=new r.WFComponent(".drop-zone"),p=0;return new Promise(r=>{let a=a=>{if(!["image/jpeg","image/jpg"].includes(a.type)&&!/\.(jpg|jpeg)$/i.test(a.name)){l(t,"Only JPEG images are allowed.",!0),e.getElement().value="";return}if(a.size>2097152){l(t,"File size must be less than 2 MB.",!0),e.getElement().value="";return}c.setStyle({display:"flex"}),t.setStyle({display:"none"}),i.setStyle({display:"none"});let u=new FileReader;u.onload=e=>{let t=e.target?.result;s.setImage(t),d.setStyle({display:"none"})},u.readAsDataURL(a);let g=new FormData;g.append("profile_picture",a);let m=localStorage.getItem("current_student");if(m){let e=JSON.parse(m);g.append("student_profile_id",e.id.toString())}let h=(0,o.apiClient).post(n,{data:g});h.onData(n=>{if("success"===n.status){let e=n.url.profile_pic.url;f(e),s.setImage(e),localStorage.setItem("image_upload",e),i.setStyle({display:"flex"}),c.setStyle({display:"none"}),r(e)}else l(t,"Failed to upload profile picture.",!0),c.setStyle({display:"none"}),d.setStyle({display:"none"}),p=0,e.getElement().value=""}),h.onError(i=>{let n="An error occurred during image upload.";i.response&&i.response.data?n=i.response.data.message||n:i.message&&(n=i.message),l(t,n,!0),c.setStyle({display:"none"}),d.setStyle({display:"none"}),p=0,e.getElement().value=""}),h.fetch()};e.on("change",()=>{let t=e.getElement().files?.[0];t&&a(t)});let u=document.body;u.addEventListener("dragenter",e=>{e.preventDefault(),1==++p&&d.setStyle({display:"flex"})}),u.addEventListener("dragleave",()=>{--p<=0&&(d.setStyle({display:"none"}),p=0)}),u.addEventListener("dragover",e=>{e.preventDefault()}),u.addEventListener("drop",e=>{e.preventDefault();let t=e.dataTransfer?.files;t?.length&&a(t[0]),d.setStyle({display:"none"}),p=0})})}let h=e=>{let t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:t.length<=10?`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`}},{"@xatom/core":"65YBq","@xatom/image":"bavwf","../api/apiConfig":"dUmIV","../auth/authConfig":"dHwPR","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],gu2z7:[function(e,t,i){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");function r(e){return void 0!==e&&""!==e.trim()}function a(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}n.defineInteropFlag(i),n.export(i,"validateNotEmpty",()=>r),n.export(i,"validateEmail",()=>a),n.export(i,"validateEmailOptional",()=>o),n.export(i,"validatePasswordRequirements",()=>s),n.export(i,"validateCheckbox",()=>l),n.export(i,"validatePasswordsMatch",()=>c),n.export(i,"validateSelectField",()=>d),n.export(i,"validatePhoneNumber",()=>p),n.export(i,"validatePhoneNumberOptional",()=>u);let o=e=>""===e.trim()||a(e);function s(e){let t=/[a-z]/.test(e),i=/[A-Z]/.test(e),n=/\d/.test(e),r=/[!@#$%^&*(),.?":{}|<>]/.test(e),a=e.length>=8;return t&&i&&n&&r&&a}function l(e){return e}function c(e,t){return e===t}function d(e){return void 0!==e&&"N/A"!==e}function p(e){return/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)}let u=e=>""===e.trim()||p(e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],Jsdel:[function(e,t,i){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(i),n.export(i,"getRecaptchaToken",()=>a),n.export(i,"validateRecaptchaToken",()=>o),n.export(i,"handleRecaptcha",()=>s);var r=e("../api/apiConfig");async function a(e){return new Promise((t,i)=>{grecaptcha.ready(()=>{grecaptcha.execute("6Lekaa8pAAAAAN6qiq0LSP5Akckql4Blg6K5ToUq",{action:e}).then(e=>{t(e)},i)})})}async function o(e){try{return await (0,r.apiClient).post("/recaptcha/validate",{data:{"g-recaptcha-response":e}}).fetch()}catch(e){throw Error(`ReCAPTCHA validation failed: ${e}`)}}async function s(e){try{let t=await a(e),i=await o(t);return"success"===i.status}catch(e){return console.error("ReCAPTCHA handling failed:",e),e.response&&console.error("Error response:",e.response),!1}}},{"../api/apiConfig":"dUmIV","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}]},[],0,"parcelRequired346");
//# sourceMappingURL=dashboard.a496ea11.js.map
